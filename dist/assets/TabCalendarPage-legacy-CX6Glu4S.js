System.register(["./swiper-vue-legacy-CdiX261u.js","./UserData-legacy-BM4P7K-z.js","./index-legacy-BFzeqLXr.js","./ImgMgr-legacy-CopGGf8z.js"],(function(e,t){"use strict";var a,l,s,o,i,n,d,r,u,c,v,p,h,f,m,g,y,b,w,x,k,_,D,S,M,I,T,O,C,$,E,j,q,P,z,U,Y,N,A,F,H,J,R,V;return{setters:[e=>{a=e.g,l=e.c,s=e.d,o=e.S,i=e.a,n=e.I,d=e.K,r=e.b},e=>{u=e.U,c=e.I,v=e.b,p=e.g,h=e.a,f=e.S,m=e._,g=e.c},e=>{y=e.d,b=e.i,w=e.C,x=e.w,k=e.c,_=e.a,D=e.f,S=e.o,M=e.b,I=e.j,T=e.t,O=e.u,C=e.h,$=e.k,E=e.e,j=e.r,q=e.F,P=e.R,z=e.q,U=e.n,Y=e.N,N=e.S,A=e.Q,F=e.D,H=e.E,J=e.I,R=e.g,V=e.l},null],execute:function(){var t=document.createElement("style");function W(e,t){const l=a(t);return l!==t&&(l.style.backfaceVisibility="hidden",l.style["-webkit-backface-visibility"]="hidden"),l}function G(e,t,s){const o=`swiper-slide-shadow${s?`-${s}`:""} swiper-slide-shadow-${e}`,i=a(t);let n=i.querySelector(`.${o.split(" ").join(".")}`);return n||(n=l("div",o.split(" ")),i.append(n)),n}function K(e){let{swiper:t,extendParams:l,on:o}=e;l({coverflowEffect:{rotate:50,stretch:0,depth:100,scale:1,modifier:1,slideShadows:!0}}),function(e){const{effect:t,swiper:a,on:l,setTranslate:s,setTransition:o,overwriteParams:i,perspective:n,recreateShadows:d,getEffectParams:r}=e;let u;l("beforeInit",(()=>{if(a.params.effect!==t)return;a.classNames.push(`${a.params.containerModifierClass}${t}`),n&&n()&&a.classNames.push(`${a.params.containerModifierClass}3d`);const e=i?i():{};Object.assign(a.params,e),Object.assign(a.originalParams,e)})),l("setTranslate",(()=>{a.params.effect===t&&s()})),l("setTransition",((e,l)=>{a.params.effect===t&&o(l)})),l("transitionEnd",(()=>{if(a.params.effect===t&&d){if(!r||!r().slideShadows)return;a.slides.forEach((e=>{e.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach((e=>e.remove()))})),d()}})),l("virtualUpdate",(()=>{a.params.effect===t&&(a.slides.length||(u=!0),requestAnimationFrame((()=>{u&&a.slides&&a.slides.length&&(s(),u=!1)})))}))}({effect:"coverflow",swiper:t,on:o,setTranslate:()=>{const{width:e,height:a,slides:l,slidesSizesGrid:o}=t,i=t.params.coverflowEffect,n=t.isHorizontal(),d=t.translate,r=n?e/2-d:a/2-d,u=n?i.rotate:-i.rotate,c=i.depth,v=s(t);for(let t=0,s=l.length;t<s;t+=1){const e=l[t],a=o[t],s=(r-e.swiperSlideOffset-a/2)/a,d="function"==typeof i.modifier?i.modifier(s):s*i.modifier;let p=n?u*d:0,h=n?0:u*d,f=-c*Math.abs(d),m=i.stretch;"string"==typeof m&&-1!==m.indexOf("%")&&(m=parseFloat(i.stretch)/100*a);let g=n?0:m*d,y=n?m*d:0,b=1-(1-i.scale)*Math.abs(d);Math.abs(y)<.001&&(y=0),Math.abs(g)<.001&&(g=0),Math.abs(f)<.001&&(f=0),Math.abs(p)<.001&&(p=0),Math.abs(h)<.001&&(h=0),Math.abs(b)<.001&&(b=0);const w=`translate3d(${y}px,${g}px,${f}px)  rotateX(${v(h)}deg) rotateY(${v(p)}deg) scale(${b})`;if(W(0,e).style.transform=w,e.style.zIndex=1-Math.abs(Math.round(d)),i.slideShadows){let t=n?e.querySelector(".swiper-slide-shadow-left"):e.querySelector(".swiper-slide-shadow-top"),a=n?e.querySelector(".swiper-slide-shadow-right"):e.querySelector(".swiper-slide-shadow-bottom");t||(t=G("coverflow",e,n?"left":"top")),a||(a=G("coverflow",e,n?"right":"bottom")),t&&(t.style.opacity=d>0?d:0),a&&(a.style.opacity=-d>0?-d:0)}}},setTransition:e=>{t.slides.map((e=>a(e))).forEach((t=>{t.style.transitionDuration=`${e}ms`,t.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach((t=>{t.style.transitionDuration=`${e}ms`}))}))},perspective:()=>!0,overwriteParams:()=>({watchSlidesProgress:!0})})}t.textContent=".main_content[data-v-d952788b]::part(scroll){height:100%;margin-top:20%}.main_content[data-v-d952788b]::part(background){display:none}ion-modal[data-v-d952788b]::part(backdrop){background-color:var(--ion-color-dark)!important;opacity:.3!important}ion-modal[data-v-d952788b]::part(content){background-color:transparent!important;align-items:center}ion-modal[data-v-d952788b]{--height: 100%;--width: 100%;align-items:center}.data-content[data-v-d952788b]{height:100%;width:80vw}.data-content ion-content[data-v-d952788b]::part(scroll){height:100%;border:1px solid #e2d0d0;border-radius:10px}.data-content ion-content[data-v-d952788b]::part(background){border-radius:10px}.scheduleItem[data-v-d952788b]{position:relative;display:flex;box-sizing:border-box;align-items:center;width:100%;justify-content:space-between}.scheduleItem ion-label[data-v-d952788b]{margin:0;padding:10px;flex:1}.scheduleItem h2[data-v-d952788b]{white-space:nowrap}.day-item[data-v-7ce697fa]{min-height:120px;width:13vw;border:1px solid #f1eded;padding:0}.day-item span[data-v-7ce697fa]{display:block;font-size:14px;text-align:left;background-color:#f1eded}.day-item div[data-v-7ce697fa]{font-size:12px;text-align:left;height:auto;align-items:top;white-space:nowrap;overflow:hidden;text-overflow:space;padding:1px;margin-top:1px;background-color:rgba(233,188,188,.714)}.day-item ion-chip[data-v-7ce697fa]{padding:1px 3px;height:auto;min-height:auto}\n",document.head.appendChild(t);const Q={style:{"font-size":"20px",color:"white"}},X=["onClick"],B={class:"flex"},L={class:"schedule-lb-sub"},Z={class:"schedule-lb-group"},ee=y({__name:"CalendarCover",props:{dt:{type:Object,default:b()},userData:{type:Object,required:!0}},emits:["update:data"],setup(e,{emit:t}){const a=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],l=e,s=t,m=w([{},{},{}]),g=w(),y=w(b(l.dt)),F=w(),H=w(),J=w(),R=w(),V=w(!1);x((()=>l.dt),(e=>{y.value=e,W()}),{deep:!0});const W=()=>{m.value=[u.createDayData(y.value.subtract(1,"day"),l.userData),u.createDayData(y.value,l.userData),u.createDayData(y.value.add(1,"day"),l.userData)]};function G(e){if(1===e.activeIndex)return;const t=e.activeIndex,a=e.previousIndex;t<a?(y.value=y.value.subtract(1,"day"),W(),e.slideTo(1,0,!1)):t>a&&(y.value=y.value.add(1,"day"),W(),e.slideTo(1,0,!1))}const ee=e=>{g.value=e,e.slideTo(1,0,!1)},te=(e,t)=>{try{var a;return null==t||null===(a=t.subtasks)||void 0===a?void 0:a.filter((a=>{var l,s;return 1===((null===(l=e.save[t.id])||void 0===l?void 0:l.subtasks)&&(null===(s=e.save[t.id])||void 0===s?void 0:s.subtasks[a.id])||0)})).length}catch(l){return console.log("countFinishedSubtask",l),0}},ae=e=>{if(V.value=!1,"backdrop"===e.detail.role)return;const[t,a]=e.detail.data,o=y.value;u.updateSchedularData(l.userData,t,a,o,e.detail.role)&&(W(),le(),s("update:data",y.value))};function le(){P(l.userData.id,l.userData.name,JSON.stringify(l.userData)).then((e=>{console.log("doSaveUserData",e)})).catch((e=>{console.log("doSaveUserData",e)}))}function se(){var e;y.value=b(),W(),null==g||null===(e=g.value)||void 0===e||e.slideTo(1,0,!1)}return(e,t)=>{const l=D("ion-button"),u=D("ion-item"),g=D("ion-icon"),b=D("ion-label"),w=D("ion-content"),x=D("ion-modal");return S(),k(x,{mode:"ios","aria-hidden":"false",ref_key:"selfRef",ref:F},{default:_((()=>[M(w,{class:"main_content"},{default:_((()=>[M(u,{class:"transparent"},{default:_((()=>[I("h2",Q,T(y.value.format("YYYY-MM-DD")+" "+a[y.value.day()]),1),y.value.isToday()?$("",!0):(S(),k(l,{key:0,slot:"end",color:"danger",onClick:se},{default:_((()=>[M(O(c),{icon:"mdi:calendar-today-outline",height:"16"}),t[1]||(t[1]=C(" 今天 "))])),_:1}))])),_:1}),M(O(i),{onTransitionEnd:G,onSwiper:ee,"centered-slides":!0,modules:[O(n),O(d),O(K)],effect:"coverflow",slidesPerView:"auto",freeMode:!1,coverflowEffect:{rotate:10,stretch:0,depth:100,modifier:1,slideShadows:!1},keyboard:!0,style:{height:"90%"}},{default:_((()=>[(S(!0),E(q,null,j(m.value,((e,t)=>(S(),k(O(r),{key:t,class:"data-content"},{default:_((()=>[M(w,null,{default:_((()=>[M(u,null,{default:_((()=>[C("日程 "+T(null==e?void 0:e.dt.format("MM-DD")),1)])),_:2},1024),(S(!0),E(q,null,j(e.events,((t,a)=>(S(),k(u,{key:a},{default:_((()=>{var a,l;return[M(O(z),{style:{"--size":"26px","padding-right":"5px"},slot:"start",checked:1===(null===(a=e.save[t.id])||void 0===a?void 0:a.state),onIonChange:a=>((e,t,a)=>{if(t){const l=t.save[a]||new f;l.state=e.detail.checked?1:0,t.save[a]=l,A((()=>{t.events.sort(((e,a)=>{var l,s;const o=(null===(l=t.save[e.id])||void 0===l?void 0:l.state)||0,i=(null===(s=t.save[a.id])||void 0===s?void 0:s.state)||0;var n,d;return o===i?(null!==(n=e.id)&&void 0!==n?n:0)-(null!==(d=a.id)&&void 0!==d?d:0):o-i}))})),le(),s("update:data",y.value)}})(a,e,t.id)},null,8,["checked","onIonChange"]),I("div",{onClick:a=>((e,t,a)=>{V.value=!0,J.value=t,R.value=a.save[t.id]})(0,t,e),class:"scheduleItem"},[M(b,{class:U({"text-line-through":1===(null===(l=e.save[t.id])||void 0===l?void 0:l.state)})},{default:_((()=>{var a;return[I("h2",null,T(t.title),1),I("div",B,[I("p",L,[M(g,{icon:O(Y),style:{position:"relative",top:"3px"}},null,8,["icon"]),C(" "+T(te(e,t))+" / "+T(null==t||null===(a=t.subtasks)||void 0===a?void 0:a.length),1)]),I("p",Z,T(O(v)(t.groupId).label),1)])]})),_:2},1032,["class"]),I("span",{class:"v-dot",style:N({"background-color":O(p)(t.color).tag,"margin-left":"10px"})},null,4),M(O(c),{icon:O(h)(t.priority).icon,height:"36",color:O(h)(t.priority).color},null,8,["icon","color"])],8,X)]})),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["modules"])])),_:1}),I("div",{style:{width:"100%",height:"20%"},onClick:t[0]||(t[0]=e=>F.value.$el.dismiss())}),M(o,{id:"pop-modal",ref_key:"scheduleModal",ref:H,"is-open":V.value,modal:H.value,schedule:J.value,save:R.value,onWillDismiss:ae},null,8,["is-open","modal","schedule","save"])])),_:1},512)}}}),te=m(ee,[["__scopeId","data-v-d952788b"]]),ae={key:0},le={key:1};e("default",m(y({__name:"TabCalendarPage",setup(e){const t=["日","一","二","三","四","五","六"],a=w({isOpen:!1,duration:3e3,text:""}),l=w([{},{},{}]),s=w(new g),o=w(),c=w(),v=w(b().startOf("day")),p=w(!1);F((()=>{H(1).then((e=>{s.value=u.parseUserData(e),console.log("getSave",s.value),h(),setTimeout((()=>{var e;null==o||null===(e=o.value)||void 0===e||e.update()}),100)})).catch((e=>{console.log("getSave",e),a.value.isOpen=!0,a.value.text=JSON.stringify(e)}))}));const h=()=>{l.value=[u.createMonthData(v.value.subtract(1,"months"),s.value),u.createMonthData(v.value,s.value),u.createMonthData(v.value.add(1,"months"),s.value)]},f=e=>{h(),e.slideTo(1,0,!1),e.update(),c.value&&c.value.dt.month()!==v.value.month()&&(c.value=void 0)},m=e=>{v.value=v.value.add(1,"months").startOf("month"),f(e)},y=e=>{v.value=v.value.subtract(1,"months").startOf("month"),f(e)},x=e=>{o.value=e,e.slideTo(1,0,!1)};function $(){p.value=!1}function P(){h()}return(e,o)=>{const u=D("ion-title"),h=D("ion-toolbar"),f=D("ion-header"),g=D("ion-chip"),w=D("ion-content"),z=D("ion-toast"),Y=D("ion-page");return S(),k(Y,null,{default:_((()=>{var e;return[M(f,null,{default:_((()=>[M(h,null,{default:_((()=>[M(u,null,{default:_((()=>[v.value?(S(),E("h3",ae,T(v.value.format("YY年MM月")),1)):(S(),E("h3",le,"日历"))])),_:1})])),_:1})])),_:1}),M(O(J),{style:{"background-color":"antiquewhite",color:"blue"}},{default:_((()=>[(S(),E(q,null,j(t,(e=>M(O(R),{class:"ion-text-center",key:e},{default:_((()=>[C(T(e),1)])),_:2},1024))),64))])),_:1}),M(w,null,{default:_((()=>[M(O(i),{onSlideNextTransitionEnd:m,onSlidePrevTransitionEnd:y,onSwiper:x,"centered-slides":!0,autoHeight:!0,modules:[O(n),O(d)]},{default:_((()=>[(S(!0),E(q,null,j(l.value,((e,t)=>(S(),k(O(r),{key:t},{default:_((()=>[M(O(V),{style:{height:"auto"},fixed:""},{default:_((()=>[(S(!0),E(q,null,j(e.weekArr,(t=>(S(),k(O(J),{key:t},{default:_((()=>[(S(!0),E(q,null,j(t,(t=>(S(),k(O(R),{class:"day-item",onClick:e=>((e,t)=>{c.value=t,p.value=!0})(0,t),key:t},{default:_((()=>[I("span",null,[M(g,{class:U({transparent:t.dt.unix()!==O(b)().startOf("day").unix(),today:t.dt.unix()===O(b)().startOf("day").unix(),gray:t.dt.month()!==e.month})},{default:_((()=>[C(T(t.dt.date()),1)])),_:2},1032,["class"])]),(S(!0),E(q,null,j(t.events,((e,a)=>{var l,s;return S(),E("div",{key:a,class:U({"text-line-through":1===(null===(l=t.save[e.id])||void 0===l?void 0:l.state),gray:1===(null===(s=t.save[e.id])||void 0===s?void 0:s.state)})},T(e.title),3)})),128))])),_:2},1032,["onClick"])))),128))])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["modules"])])),_:1}),M(z,{"is-open":a.value.isOpen,message:a.value.text,duration:a.value.duration,onDidDismiss:o[0]||(o[0]=()=>a.value.isOpen=!1)},null,8,["is-open","message","duration"]),M(te,{ref:"scheduleModal","is-open":p.value,dt:null===(e=c.value)||void 0===e?void 0:e.dt,userData:s.value,"onUpdate:data":P,onWillDismiss:$},null,8,["is-open","dt","userData"])]})),_:1})}}}),[["__scopeId","data-v-7ce697fa"]]))}}}));
