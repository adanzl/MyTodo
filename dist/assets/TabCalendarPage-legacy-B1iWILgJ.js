System.register(["./swiper-vue-legacy-CsjZuyOc.js","./UserData-legacy-BI-0steO.js","./index-legacy-DwxWt7OM.js","./ImgMgr-legacy-vtla9_37.js"],(function(e,t){"use strict";var a,l,s,o,i,n,d,r,u,c,v,f,p,h,m,g,y,w,b,x,k,_,D,S,M,O,T,C,I,$,E,j,q,z,P,U,Y,N,A,F,G,H,J,R,V,W,K,L,Q;return{setters:[e=>{a=e.g,l=e.c,s=e.d,o=e.S,i=e.a,n=e.I,d=e.K,r=e.b},e=>{u=e.c,c=e.I,v=e.b,f=e.g,p=e.a,h=e.S,m=e._,g=e.U},e=>{y=e.d,w=e.i,b=e.C,x=e.w,k=e.c,_=e.a,D=e.f,S=e.o,M=e.b,O=e.j,T=e.t,C=e.u,I=e.h,$=e.k,E=e.e,j=e.r,q=e.F,z=e.T,P=e.q,U=e.n,Y=e.N,N=e.U,A=e.s,F=e.v,G=e.G,H=e.S,J=e.D,R=e.E,V=e.Q,W=e.R,K=e.I,L=e.g,Q=e.l},null],execute:function(){var t=document.createElement("style");function X(e,t){const l=a(t);return l!==t&&(l.style.backfaceVisibility="hidden",l.style["-webkit-backface-visibility"]="hidden"),l}function B(e,t,s){const o=`swiper-slide-shadow${s?`-${s}`:""} swiper-slide-shadow-${e}`,i=a(t);let n=i.querySelector(`.${o.split(" ").join(".")}`);return n||(n=l("div",o.split(" ")),i.append(n)),n}function Z(e){let{swiper:t,extendParams:l,on:o}=e;l({coverflowEffect:{rotate:50,stretch:0,depth:100,scale:1,modifier:1,slideShadows:!0}}),function(e){const{effect:t,swiper:a,on:l,setTranslate:s,setTransition:o,overwriteParams:i,perspective:n,recreateShadows:d,getEffectParams:r}=e;let u;l("beforeInit",(()=>{if(a.params.effect!==t)return;a.classNames.push(`${a.params.containerModifierClass}${t}`),n&&n()&&a.classNames.push(`${a.params.containerModifierClass}3d`);const e=i?i():{};Object.assign(a.params,e),Object.assign(a.originalParams,e)})),l("setTranslate",(()=>{a.params.effect===t&&s()})),l("setTransition",((e,l)=>{a.params.effect===t&&o(l)})),l("transitionEnd",(()=>{if(a.params.effect===t&&d){if(!r||!r().slideShadows)return;a.slides.forEach((e=>{e.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach((e=>e.remove()))})),d()}})),l("virtualUpdate",(()=>{a.params.effect===t&&(a.slides.length||(u=!0),requestAnimationFrame((()=>{u&&a.slides&&a.slides.length&&(s(),u=!1)})))}))}({effect:"coverflow",swiper:t,on:o,setTranslate:()=>{const{width:e,height:a,slides:l,slidesSizesGrid:o}=t,i=t.params.coverflowEffect,n=t.isHorizontal(),d=t.translate,r=n?e/2-d:a/2-d,u=n?i.rotate:-i.rotate,c=i.depth,v=s(t);for(let t=0,s=l.length;t<s;t+=1){const e=l[t],a=o[t],s=(r-e.swiperSlideOffset-a/2)/a,d="function"==typeof i.modifier?i.modifier(s):s*i.modifier;let f=n?u*d:0,p=n?0:u*d,h=-c*Math.abs(d),m=i.stretch;"string"==typeof m&&-1!==m.indexOf("%")&&(m=parseFloat(i.stretch)/100*a);let g=n?0:m*d,y=n?m*d:0,w=1-(1-i.scale)*Math.abs(d);Math.abs(y)<.001&&(y=0),Math.abs(g)<.001&&(g=0),Math.abs(h)<.001&&(h=0),Math.abs(f)<.001&&(f=0),Math.abs(p)<.001&&(p=0),Math.abs(w)<.001&&(w=0);const b=`translate3d(${y}px,${g}px,${h}px)  rotateX(${v(p)}deg) rotateY(${v(f)}deg) scale(${w})`;if(X(0,e).style.transform=b,e.style.zIndex=1-Math.abs(Math.round(d)),i.slideShadows){let t=n?e.querySelector(".swiper-slide-shadow-left"):e.querySelector(".swiper-slide-shadow-top"),a=n?e.querySelector(".swiper-slide-shadow-right"):e.querySelector(".swiper-slide-shadow-bottom");t||(t=B("coverflow",e,n?"left":"top")),a||(a=B("coverflow",e,n?"right":"bottom")),t&&(t.style.opacity=d>0?d:0),a&&(a.style.opacity=-d>0?-d:0)}}},setTransition:e=>{t.slides.map((e=>a(e))).forEach((t=>{t.style.transitionDuration=`${e}ms`,t.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach((t=>{t.style.transitionDuration=`${e}ms`}))}))},perspective:()=>!0,overwriteParams:()=>({watchSlidesProgress:!0})})}t.textContent=".main_content[data-v-0910cf82]::part(scroll){height:90%;margin-top:20%}.main_content[data-v-0910cf82]::part(background){display:none}ion-modal[data-v-0910cf82]::part(backdrop){background-color:var(--ion-color-dark)!important;opacity:.3!important}ion-modal[data-v-0910cf82]::part(content){background-color:transparent!important;align-items:center}ion-modal[data-v-0910cf82]{--height: 100%;--width: 100%;align-items:center}.data-content[data-v-0910cf82]{height:100%;width:80vw}.data-content ion-content[data-v-0910cf82]::part(scroll){height:100%;border:1px solid #e2d0d0;border-radius:10px}.data-content ion-content[data-v-0910cf82]::part(background){border-radius:10px}.scheduleItem[data-v-0910cf82]{position:relative;display:flex;box-sizing:border-box;align-items:center;width:100%;justify-content:space-between}.scheduleItem ion-label[data-v-0910cf82]{margin:0;padding:10px;flex:1}.scheduleItem h2[data-v-0910cf82]{white-space:nowrap}.day-item[data-v-fd605a90]{min-height:120px;width:13vw;border:1px solid #f1eded;padding:0}.day-item span[data-v-fd605a90]{display:block;font-size:14px;text-align:left;background-color:#f1eded}.day-item div[data-v-fd605a90]{font-size:12px;text-align:left;height:auto;align-items:top;white-space:nowrap;overflow:hidden;text-overflow:space;padding:1px 4px;margin-top:1px;border-radius:2px}.day-item ion-chip[data-v-fd605a90]{padding:1px 3px;height:auto;min-height:auto}\n",document.head.appendChild(t);const ee={style:{"font-size":"20px",color:"white"}},te=["onClick"],ae={class:"flex"},le={class:"schedule-lb-sub"},se={class:"schedule-lb-group"},oe=y({__name:"CalendarCover",props:{dt:{type:Object,default:w()},userData:{type:Object,required:!0}},emits:["update:data"],setup(e,{emit:t}){const a=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],l=e,s=t,m=b([{},{},{}]),g=b(),y=b(w(l.dt)),J=b(),R=b(),V=b(),W=b(),K=b(!1);x((()=>l.dt),(e=>{y.value=e,L()}),{deep:!0});const L=()=>{m.value=[u.createDayData(y.value.subtract(1,"day"),l.userData),u.createDayData(y.value,l.userData),u.createDayData(y.value.add(1,"day"),l.userData)]};function Q(e){if(1===e.activeIndex)return;const t=e.activeIndex,a=e.previousIndex;t<a?(y.value=y.value.subtract(1,"day"),L(),e.slideTo(1,0,!1)):t>a&&(y.value=y.value.add(1,"day"),L(),e.slideTo(1,0,!1))}const X=e=>{g.value=e,e.slideTo(1,0,!1)},B=(e,t)=>{try{var a;return null==t||null===(a=t.subtasks)||void 0===a?void 0:a.filter((a=>{var l,s;return 1===((null===(l=e.save[t.id])||void 0===l?void 0:l.subtasks)&&(null===(s=e.save[t.id])||void 0===s?void 0:s.subtasks[a.id])||0)})).length}catch(l){return console.log("countFinishedSubtask",l),0}},oe=e=>{if(K.value=!1,"backdrop"===e.detail.role)return;const[t,a]=e.detail.data,o=y.value;u.updateSchedularData(l.userData,t,a,o,e.detail.role)&&(L(),ie(),s("update:data",y.value))};function ie(){z(l.userData.id,l.userData.name,JSON.stringify(l.userData)).then((e=>{console.log("doSaveUserData",e)})).catch((e=>{console.log("doSaveUserData",e)}))}function ne(){var e;y.value=w(),L(),null==g||null===(e=g.value)||void 0===e||e.slideTo(1,0,!1)}const de=()=>{V.value=void 0,W.value=void 0,K.value=!0};return(e,t)=>{const l=D("ion-button"),u=D("ion-item"),g=D("ion-icon"),w=D("ion-label"),b=D("ion-content"),x=D("ion-modal");return S(),k(x,{mode:"ios","aria-hidden":"false",ref_key:"selfRef",ref:J},{default:_((()=>[M(b,{class:"main_content"},{default:_((()=>[M(u,{class:"transparent"},{default:_((()=>[O("h2",ee,T(y.value.format("YYYY-MM-DD")+" "+a[y.value.day()]),1),y.value.isToday()?$("",!0):(S(),k(l,{key:0,slot:"end",color:"danger",onClick:ne,size:"medium"},{default:_((()=>[M(C(c),{icon:"mdi:calendar-today-outline",height:"16"}),t[1]||(t[1]=I(" 今天 "))])),_:1}))])),_:1}),M(C(i),{onTransitionEnd:Q,onSwiper:X,"centered-slides":!0,modules:[C(n),C(d),C(Z)],effect:"coverflow",slidesPerView:"auto",freeMode:!1,coverflowEffect:{rotate:10,stretch:0,depth:100,modifier:1,slideShadows:!1},keyboard:!0,style:{height:"90%"}},{default:_((()=>[(S(!0),E(q,null,j(m.value,((e,t)=>(S(),k(C(r),{key:t,class:"data-content"},{default:_((()=>[M(b,null,{default:_((()=>[M(u,null,{default:_((()=>[I("日程 "+T(null==e?void 0:e.dt.format("MM-DD")),1)])),_:2},1024),(S(!0),E(q,null,j(e.events,((t,a)=>(S(),k(u,{key:a},{default:_((()=>{var a,l;return[M(C(P),{style:{"--size":"26px","padding-right":"5px"},slot:"start",checked:1===(null===(a=e.save[t.id])||void 0===a?void 0:a.state),onIonChange:a=>((e,t,a)=>{if(t){const l=t.save[a]||new h;l.state=e.detail.checked?1:0,t.save[a]=l,H((()=>{t.events.sort(((e,a)=>{var l,s;const o=(null===(l=t.save[e.id])||void 0===l?void 0:l.state)||0,i=(null===(s=t.save[a.id])||void 0===s?void 0:s.state)||0;var n,d;return o===i?(null!==(n=e.id)&&void 0!==n?n:0)-(null!==(d=a.id)&&void 0!==d?d:0):o-i}))})),ie(),s("update:data",y.value)}})(a,e,t.id)},null,8,["checked","onIonChange"]),O("div",{onClick:a=>((e,t,a)=>{K.value=!0,V.value=t,W.value=a.save[t.id]})(0,t,e),class:"scheduleItem"},[M(w,{class:U({"text-line-through":1===(null===(l=e.save[t.id])||void 0===l?void 0:l.state)})},{default:_((()=>{var a;return[O("h2",null,T(t.title),1),O("div",ae,[O("p",le,[M(g,{icon:C(Y),style:{position:"relative",top:"3px"}},null,8,["icon"]),I(" "+T(B(e,t))+" / "+T(null==t||null===(a=t.subtasks)||void 0===a?void 0:a.length),1)]),O("p",se,T(C(v)(t.groupId).label),1)])]})),_:2},1032,["class"]),O("span",{class:"v-dot",style:N({"background-color":C(f)(t.color).tag,"margin-left":"10px"})},null,4),M(C(c),{icon:C(p)(t.priority).icon,height:"36",color:C(p)(t.priority).color},null,8,["icon","color"])],8,te)]})),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["modules"]),M(C(A),{slot:"fixed",vertical:"bottom",horizontal:"end"},{default:_((()=>[M(C(F),{onClick:de},{default:_((()=>[M(g,{icon:C(G),size:"large"},null,8,["icon"])])),_:1})])),_:1})])),_:1}),O("div",{style:{width:"100%",height:"10%"},onClick:t[0]||(t[0]=e=>J.value.$el.dismiss())}),M(o,{id:"pop-modal",ref_key:"scheduleModal",ref:R,"is-open":K.value,modal:R.value,schedule:V.value,save:W.value,onWillDismiss:oe},null,8,["is-open","modal","schedule","save"])])),_:1},512)}}}),ie=m(oe,[["__scopeId","data-v-0910cf82"]]),ne={key:0},de={key:1};e("default",m(y({__name:"TabCalendarPage",setup(e){const t=["日","一","二","三","四","五","六"],a=b({isOpen:!1,duration:3e3,text:""}),l=b([{},{},{}]),s=b(new g),o=b(),c=b(),v=b(w().startOf("day")),p=b(!1),h=async()=>{const e=await V.create({message:"Loading..."});e.present(),W(1).then((e=>{s.value=u.parseUserData(e),m(),setTimeout((()=>{var e;null==o||null===(e=o.value)||void 0===e||e.update()}),100)})).catch((e=>{console.log("getSave",e),a.value.isOpen=!0,a.value.text=JSON.stringify(e)})).finally((()=>{e.dismiss()}))};J((async()=>{h(),R((()=>{h()}))}));const m=()=>{l.value=[u.createMonthData(v.value.subtract(1,"months"),s.value),u.createMonthData(v.value,s.value),u.createMonthData(v.value.add(1,"months"),s.value)]},y=e=>{m(),e.slideTo(1,0,!1),e.update(),c.value&&c.value.dt.month()!==v.value.month()&&(c.value=void 0)},x=e=>{v.value=v.value.add(1,"months").startOf("month"),y(e)},z=e=>{v.value=v.value.subtract(1,"months").startOf("month"),y(e)},P=e=>{o.value=e,e.slideTo(1,0,!1)};function Y(){p.value=!1}function A(){v.value=w().startOf("day"),m()}function F(){const e=w().startOf("day");return e.month()===v.value.month()&&e.year()===v.value.year()}function G(){m(),y(o.value)}return(e,o)=>{const u=D("ion-title"),h=D("ion-button"),m=D("ion-buttons"),g=D("ion-toolbar"),y=D("ion-header"),b=D("ion-chip"),H=D("ion-content"),J=D("ion-toast"),R=D("ion-page");return S(),k(R,null,{default:_((()=>{var e;return[M(y,null,{default:_((()=>[M(g,null,{default:_((()=>[M(u,{class:"ion-text-center"},{default:_((()=>[v.value?(S(),E("div",ne,T(v.value.format("YY年MM月")),1)):(S(),E("div",de,"日历"))])),_:1}),M(m,{slot:"end"},{default:_((()=>[F()?$("",!0):(S(),k(h,{key:0,style:{position:"absolute",right:"50px"},onClick:A},{default:_((()=>o[1]||(o[1]=[I(" 今 ")]))),_:1}))])),_:1})])),_:1})])),_:1}),M(C(K),{style:{"background-color":"antiquewhite",color:"blue"}},{default:_((()=>[(S(),E(q,null,j(t,(e=>M(C(L),{class:"ion-text-center",key:e},{default:_((()=>[I(T(e),1)])),_:2},1024))),64))])),_:1}),M(H,null,{default:_((()=>[M(C(i),{onSlideNextTransitionEnd:x,onSlidePrevTransitionEnd:z,onSwiper:P,"centered-slides":!0,autoHeight:!0,modules:[C(n),C(d)]},{default:_((()=>[(S(!0),E(q,null,j(l.value,((e,t)=>(S(),k(C(r),{key:t},{default:_((()=>[M(C(Q),{style:{height:"auto"},fixed:""},{default:_((()=>[(S(!0),E(q,null,j(e.weekArr,(t=>(S(),k(C(K),{key:t},{default:_((()=>[(S(!0),E(q,null,j(t,(t=>(S(),k(C(L),{class:"day-item",onClick:e=>((e,t)=>{c.value=t,p.value=!0})(0,t),key:t},{default:_((()=>[O("span",null,[M(b,{class:U({transparent:t.dt.unix()!==C(w)().startOf("day").unix(),today:t.dt.unix()===C(w)().startOf("day").unix(),gray:t.dt.month()!==e.month})},{default:_((()=>[I(T(t.dt.date()),1)])),_:2},1032,["class"])]),(S(!0),E(q,null,j(t.events,((e,a)=>{var l,s;return S(),E("div",{key:a,class:U({"text-line-through":1===(null===(l=t.save[e.id])||void 0===l?void 0:l.state),gray:1===(null===(s=t.save[e.id])||void 0===s?void 0:s.state)}),style:N({"background-color":C(f)(e.color).tag})},T(e.title),7)})),128))])),_:2},1032,["onClick"])))),128))])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["modules"])])),_:1}),M(J,{"is-open":a.value.isOpen,message:a.value.text,duration:a.value.duration,onDidDismiss:o[0]||(o[0]=()=>a.value.isOpen=!1)},null,8,["is-open","message","duration"]),M(ie,{ref:"scheduleModal","is-open":p.value,dt:null===(e=c.value)||void 0===e?void 0:e.dt,userData:s.value,"onUpdate:data":G,onWillDismiss:Y},null,8,["is-open","dt","userData"])]})),_:1})}}}),[["__scopeId","data-v-fd605a90"]]))}}}));
