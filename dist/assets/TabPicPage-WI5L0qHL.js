import{d as W,C as v,D as z,ao as g,o as k,c as x,a as e,b as n,u as l,h as p,j as P,e as D,r as F,F as H,f as s,$ as w,z as M,t as j,y as q,x as y,ap as A,P as E,aq as K,W as $}from"./index-DxqavktZ.js";import{l as O,a as G,d as J}from"./ImgMgr-GqnYifhv.js";const Q=["width","height"],U=["src"],ee=W({__name:"TabPicPage",setup(X){const h=v(),d=v(400),u=v(300),c=v([]);z(()=>{g().then(i=>{c.value=i,console.log("picList",c.value)})});const R=async()=>{O(void 0,u.value,d.value).then(i=>{console.log("setPic id: ",i),i!==null&&g().then(t=>{c.value=t})})},T=(i,t)=>{const o=new Image;o.src=t.data,o.onload=()=>{if(h.value){const a=h.value.getContext("2d");if(a){const{dx:_,dy:C,drawWidth:m,drawHeight:b}=G(o,d.value,u.value);a.clearRect(0,0,d.value,u.value),a.drawImage(o,_,C,m,b)}}}},B=async(i,t)=>{await(await $.create({header:"Confirm",message:"确认删除这张图片么 ["+t.id+"]",buttons:[{text:"OK",handler:()=>{console.log("btnRemoveClk",t.id),J(t.id).then(a=>{console.log("delPic",a),g().then(_=>{c.value=_})})}},"Cancel"]})).present()},L=(i,t)=>{O(t.id,u.value,d.value).then(o=>{console.log("setPic id: ",o),o!==null&&g().then(a=>{c.value=a})})};return(i,t)=>{const o=s("ion-title"),a=s("ion-header"),_=s("ion-button"),C=s("ion-buttons"),m=s("ion-item"),b=s("ion-label"),I=s("ion-icon"),N=s("ion-list"),S=s("ion-content");return k(),x(l(K),{class:"main-bg"},{default:e(()=>[n(a,null,{default:e(()=>[n(l(w),null,{default:e(()=>[n(o,null,{default:e(()=>t[0]||(t[0]=[p("Tab Pic")])),_:1})]),_:1})]),_:1}),n(m,{collapse:"condense"},{default:e(()=>[n(l(w),null,{default:e(()=>[n(o,{size:"large"},{default:e(()=>t[1]||(t[1]=[p("Tab 2")])),_:1}),n(C,{slot:"end"},{default:e(()=>[n(_,{onClick:R},{default:e(()=>t[2]||(t[2]=[p("选择图片")])),_:1})]),_:1})]),_:1})]),_:1}),P("canvas",{ref_key:"canvasRef",ref:h,width:d.value,height:u.value},null,8,Q),n(S,null,{default:e(()=>[n(N,null,{default:e(()=>[(k(!0),D(H,null,F(c.value,(r,V)=>(k(),x(l(M),{key:V},{default:e(()=>[n(m,{onClick:f=>T(f,r)},{default:e(()=>[n(b,null,{default:e(()=>[p(j(r.id),1)]),_:2},1024),P("img",{src:r.data,style:{height:"60px"}},null,8,U)]),_:2},1032,["onClick"]),n(l(q),{side:"end"},{default:e(()=>[n(l(y),{onClick:f=>L(f,r)},{default:e(()=>[n(I,{icon:l(A)},null,8,["icon"])]),_:2},1032,["onClick"]),n(l(y),{color:"danger",onClick:f=>B(f,r)},{default:e(()=>[n(I,{icon:l(E)},null,8,["icon"])]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})}}});export{ee as default};
