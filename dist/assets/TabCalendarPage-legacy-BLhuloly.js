System.register(["./swiper-vue-legacy-CnhSdGdm.js","./index-legacy-tIfFDtL-.js","./UserData-legacy-CuqL_Qjj.js","./ImgMgr-legacy-BG_w87Oo.js"],(function(e,t){"use strict";var a,l,o,s,i,n,d,r,u,c,v,p,f,h,m,g,y,w,b,x,k,_,D,S,M,C,I,O,T,$,E,j,q,z,P,U,Y,N,A,F,H,J,V,W,K,L,R,X,B,G;return{setters:[e=>{a=e.g,l=e.c,o=e.d,s=e.S,i=e.a,n=e.I,d=e.K,r=e.b},e=>{u=e.d,c=e.i,v=e.C,p=e.w,f=e.c,h=e.a,m=e.r,g=e.o,y=e.b,w=e.j,b=e.t,x=e.Z,k=e.h,_=e.u,D=e.e,S=e.f,M=e.F,C=e.X,I=e.q,O=e.n,T=e.R,$=e.K,E=e.H,j=e.J,q=e.s,z=e.v,P=e.L,U=e.W,Y=e.Y,N=e.$,A=e.D,F=e.E,H=e.k,J=e.U,V=e.V,W=e.a0,K=e.I,L=e.g,R=e.l},e=>{X=e.a,B=e.S,G=e.U},null],execute:function(){var t=document.createElement("style");function Z(e,t){const l=a(t);return l!==t&&(l.style.backfaceVisibility="hidden",l.style["-webkit-backface-visibility"]="hidden"),l}function Q(e,t,o){const s=`swiper-slide-shadow${o?`-${o}`:""} swiper-slide-shadow-${e}`,i=a(t);let n=i.querySelector(`.${s.split(" ").join(".")}`);return n||(n=l("div",s.split(" ")),i.append(n)),n}function ee(e){let{swiper:t,extendParams:l,on:s}=e;l({coverflowEffect:{rotate:50,stretch:0,depth:100,scale:1,modifier:1,slideShadows:!0}}),function(e){const{effect:t,swiper:a,on:l,setTranslate:o,setTransition:s,overwriteParams:i,perspective:n,recreateShadows:d,getEffectParams:r}=e;let u;l("beforeInit",(()=>{if(a.params.effect!==t)return;a.classNames.push(`${a.params.containerModifierClass}${t}`),n&&n()&&a.classNames.push(`${a.params.containerModifierClass}3d`);const e=i?i():{};Object.assign(a.params,e),Object.assign(a.originalParams,e)})),l("setTranslate",(()=>{a.params.effect===t&&o()})),l("setTransition",((e,l)=>{a.params.effect===t&&s(l)})),l("transitionEnd",(()=>{if(a.params.effect===t&&d){if(!r||!r().slideShadows)return;a.slides.forEach((e=>{e.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach((e=>e.remove()))})),d()}})),l("virtualUpdate",(()=>{a.params.effect===t&&(a.slides.length||(u=!0),requestAnimationFrame((()=>{u&&a.slides&&a.slides.length&&(o(),u=!1)})))}))}({effect:"coverflow",swiper:t,on:s,setTranslate:()=>{const{width:e,height:a,slides:l,slidesSizesGrid:s}=t,i=t.params.coverflowEffect,n=t.isHorizontal(),d=t.translate,r=n?e/2-d:a/2-d,u=n?i.rotate:-i.rotate,c=i.depth,v=o(t);for(let t=0,o=l.length;t<o;t+=1){const e=l[t],a=s[t],o=(r-e.swiperSlideOffset-a/2)/a,d="function"==typeof i.modifier?i.modifier(o):o*i.modifier;let p=n?u*d:0,f=n?0:u*d,h=-c*Math.abs(d),m=i.stretch;"string"==typeof m&&-1!==m.indexOf("%")&&(m=parseFloat(i.stretch)/100*a);let g=n?0:m*d,y=n?m*d:0,w=1-(1-i.scale)*Math.abs(d);Math.abs(y)<.001&&(y=0),Math.abs(g)<.001&&(g=0),Math.abs(h)<.001&&(h=0),Math.abs(p)<.001&&(p=0),Math.abs(f)<.001&&(f=0),Math.abs(w)<.001&&(w=0);const b=`translate3d(${y}px,${g}px,${h}px)  rotateX(${v(f)}deg) rotateY(${v(p)}deg) scale(${w})`;if(Z(0,e).style.transform=b,e.style.zIndex=1-Math.abs(Math.round(d)),i.slideShadows){let t=n?e.querySelector(".swiper-slide-shadow-left"):e.querySelector(".swiper-slide-shadow-top"),a=n?e.querySelector(".swiper-slide-shadow-right"):e.querySelector(".swiper-slide-shadow-bottom");t||(t=Q("coverflow",e,n?"left":"top")),a||(a=Q("coverflow",e,n?"right":"bottom")),t&&(t.style.opacity=d>0?d:0),a&&(a.style.opacity=-d>0?-d:0)}}},setTransition:e=>{t.slides.map((e=>a(e))).forEach((t=>{t.style.transitionDuration=`${e}ms`,t.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach((t=>{t.style.transitionDuration=`${e}ms`}))}))},perspective:()=>!0,overwriteParams:()=>({watchSlidesProgress:!0})})}t.textContent=".main_content[data-v-2049650d]::part(scroll){height:90%;margin-top:20%}.main_content[data-v-2049650d]::part(background){display:none}ion-modal[data-v-2049650d]::part(backdrop){background-color:var(--ion-color-dark)!important;opacity:.3!important}ion-modal[data-v-2049650d]::part(content){background-color:transparent!important;align-items:center}ion-modal[data-v-2049650d]{--height: 100%;--width: 100%;align-items:center}.data-content[data-v-2049650d]{height:100%;width:80vw}.data-content ion-content[data-v-2049650d]::part(scroll){height:100%;border:1px solid #e2d0d0;border-radius:10px}.data-content ion-content[data-v-2049650d]::part(background){border-radius:10px}.scheduleItem[data-v-2049650d]{position:relative;display:flex;box-sizing:border-box;align-items:center;width:100%;justify-content:space-between}.scheduleItem ion-label[data-v-2049650d]{margin:0;padding:10px;flex:1}.scheduleItem h2[data-v-2049650d]{white-space:nowrap}.day-item[data-v-1697f356]{min-height:120px;width:13vw;border:1px solid #f1eded;padding:0}.day-item span[data-v-1697f356]{display:block;font-size:14px;text-align:left;background-color:#f1eded}.day-item div[data-v-1697f356]{font-size:12px;text-align:left;height:auto;align-items:top;white-space:nowrap;overflow:hidden;text-overflow:space;padding:1px 4px;margin-top:1px;border-radius:2px}.day-item ion-chip[data-v-1697f356]{padding:1px 3px;height:auto;min-height:auto}\n",document.head.appendChild(t);const te={style:{"font-size":"20px",color:"white"}},ae=["onClick"],le={class:"flex"},oe={class:"schedule-lb-sub"},se={class:"schedule-lb-group"},ie=u({__name:"CalendarCover",props:{dt:{type:Object,default:c()},userData:{type:Object,required:!0}},emits:["update:data"],setup(e,{emit:t}){const a=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],l=e,o=t,u=v([{},{},{}]),Y=v(),N=v(c(l.dt)),A=v(),F=v(),H=v(),J=v(),V=v(!1);p((()=>l.dt),(e=>{N.value=e,W()}),{deep:!0});const W=()=>{u.value=[X.createDayData(N.value.subtract(1,"day"),l.userData),X.createDayData(N.value,l.userData),X.createDayData(N.value.add(1,"day"),l.userData)]};function K(e){if(1===e.activeIndex)return;const t=e.activeIndex,a=e.previousIndex;t<a?(N.value=N.value.subtract(1,"day"),W(),e.slideTo(1,0,!1)):t>a&&(N.value=N.value.add(1,"day"),W(),e.slideTo(1,0,!1))}const L=e=>{Y.value=e,e.slideTo(1,0,!1)},R=(e,t)=>{try{var a;return null==t||null===(a=t.subtasks)||void 0===a?void 0:a.filter((a=>{var l,o;return 1===((null===(l=e.save[t.id])||void 0===l?void 0:l.subtasks)&&(null===(o=e.save[t.id])||void 0===o?void 0:o.subtasks[a.id])||0)})).length}catch(l){return console.log("countFinishedSubtask",l),0}},G=e=>{if(V.value=!1,"backdrop"===e.detail.role)return;const[t,a]=e.detail.data,s=N.value;X.updateSchedularData(l.userData,t,a,s,e.detail.role)&&(W(),Z(),o("update:data",N.value))};function Z(){C(l.userData.id,l.userData.name,JSON.stringify(l.userData)).then((e=>{console.log("doSaveUserData",e)})).catch((e=>{console.log("doSaveUserData",e)}))}function Q(){var e;N.value=c(),W(),null==Y||null===(e=Y.value)||void 0===e||e.slideTo(1,0,!1)}const ie=()=>{H.value=void 0,J.value=void 0,V.value=!0};return(e,t)=>{const l=m("Icon"),c=m("ion-button"),v=m("ion-item"),p=m("ion-icon"),C=m("ion-label"),Y=m("ion-content"),W=m("ion-modal");return g(),f(W,{mode:"ios","aria-hidden":"false",ref_key:"selfRef",ref:A},{default:h((()=>[y(Y,{class:"main_content"},{default:h((()=>[y(v,{class:"transparent"},{default:h((()=>[w("h2",te,b(N.value.format("YYYY-MM-DD")+" "+a[N.value.day()]),1),y(c,{slot:"end",color:"danger",onClick:Q,size:"default",style:x({padding:"0px 10px",opacity:N.value.isToday()?"0":"1"})},{default:h((()=>[y(l,{icon:"mdi:calendar-today-outline",height:"16",slot:"start"}),t[1]||(t[1]=k(" 今天 "))])),_:1},8,["style"])])),_:1}),y(_(i),{onTransitionEnd:K,onSwiper:L,"centered-slides":!0,modules:[_(n),_(d),_(ee)],effect:"coverflow",slidesPerView:"auto",freeMode:!1,coverflowEffect:{rotate:10,stretch:0,depth:100,modifier:1,slideShadows:!1},keyboard:!0,style:{height:"90%"}},{default:h((()=>[(g(!0),D(M,null,S(u.value,((e,a)=>(g(),f(_(r),{key:a,class:"data-content"},{default:h((()=>[y(Y,null,{default:h((()=>[y(v,{color:"light"},{default:h((()=>[y(l,{icon:"mdi:list-status",style:{color:"var(--ion-color-tertiary)"},height:"40",slot:"start"}),t[2]||(t[2]=w("div",{style:{height:"50px"}},null,-1))])),_:1}),(g(!0),D(M,null,S(e.events,((t,a)=>(g(),f(v,{key:a},{default:h((()=>{var a,s;return[y(_(I),{style:{"--size":"26px","padding-right":"5px"},slot:"start",checked:1===(null===(a=e.save[t.id])||void 0===a?void 0:a.state),onIonChange:a=>((e,t,a)=>{if(t){const l=t.save[a]||new B;l.state=e.detail.checked?1:0,t.save[a]=l,U((()=>{t.events.sort(((e,a)=>{var l,o;const s=(null===(l=t.save[e.id])||void 0===l?void 0:l.state)||0,i=(null===(o=t.save[a.id])||void 0===o?void 0:o.state)||0;var n,d;return s===i?(null!==(n=e.id)&&void 0!==n?n:0)-(null!==(d=a.id)&&void 0!==d?d:0):s-i}))})),Z(),o("update:data",N.value)}})(a,e,t.id)},null,8,["checked","onIonChange"]),w("div",{onClick:a=>((e,t,a)=>{V.value=!0,H.value=t,J.value=a.save[t.id]})(0,t,e),class:"scheduleItem"},[y(C,{class:O({"text-line-through":1===(null===(s=e.save[t.id])||void 0===s?void 0:s.state)})},{default:h((()=>{var a;return[w("h2",null,b(t.title),1),w("div",le,[w("p",oe,[y(p,{icon:_(T),style:{position:"relative",top:"3px"}},null,8,["icon"]),k(" "+b(R(e,t))+" / "+b(null==t||null===(a=t.subtasks)||void 0===a?void 0:a.length),1)]),w("p",se,b(_($)(t.groupId).label),1)])]})),_:2},1032,["class"]),w("span",{class:"v-dot",style:x({"background-color":_(E)(t.color).tag,"margin-left":"10px"})},null,4),y(l,{icon:_(j)(t.priority).icon,height:"36",color:_(j)(t.priority).color},null,8,["icon","color"])],8,ae)]})),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["modules"]),y(_(q),{slot:"fixed",vertical:"bottom",horizontal:"end"},{default:h((()=>[y(_(z),{onClick:ie},{default:h((()=>[y(p,{icon:_(P),size:"large"},null,8,["icon"])])),_:1})])),_:1})])),_:1}),w("div",{style:{width:"100%",height:"10%"},onClick:t[0]||(t[0]=e=>A.value.$el.dismiss())}),y(s,{id:"pop-modal",ref_key:"scheduleModal",ref:F,"is-open":V.value,modal:F.value,schedule:H.value,save:J.value,onWillDismiss:G},null,8,["is-open","modal","schedule","save"])])),_:1},512)}}}),ne=Y(ie,[["__scopeId","data-v-2049650d"]]),de={key:0},re={key:1};e("default",Y(u({__name:"TabCalendarPage",setup(e){const t=["日","一","二","三","四","五","六"],a=v({isOpen:!1,duration:3e3,text:""}),l=v([{},{},{}]),o=v(new G),s=v(),u=v(),p=v(c().startOf("day")),C=v(!1),I=v({}),T=N("eventBus"),$=async()=>{const e=await J.create({message:"Loading..."});e.present(),V(1).then((e=>{o.value=X.parseUserData(e),q(),setTimeout((()=>{var e;null==s||null===(e=s.value)||void 0===e||e.update()}),100)})).catch((e=>{console.log("getSave",e),a.value.isOpen=!0,a.value.text=JSON.stringify(e)})).finally((()=>{e.dismiss()}))};function j(e){const[t,a,l]=[I.value.group,I.value.color,I.value.priority];return!(t&&!1===t.get(e.groupId)||a&&!1===a.get(e.color)||l&&!1===l.get(e.priority))}A((async()=>{$(),F((()=>{$()})),T.$on("menuClose",(e=>{console.log("menuClose",e),I.value=e}))}));const q=()=>{l.value=[X.createMonthData(p.value.subtract(1,"months"),o.value),X.createMonthData(p.value,o.value),X.createMonthData(p.value.add(1,"months"),o.value)]},z=e=>{q(),e.slideTo(1,0,!1),e.update(),u.value&&u.value.dt.month()!==p.value.month()&&(u.value=void 0)},P=e=>{p.value=p.value.add(1,"months").startOf("month"),z(e)},U=e=>{p.value=p.value.subtract(1,"months").startOf("month"),z(e)},Y=e=>{s.value=e,e.slideTo(1,0,!1)};function B(){C.value=!1}function Z(){p.value=c().startOf("day"),q()}function Q(){const e=c().startOf("day");return e.month()===p.value.month()&&e.year()===p.value.year()}function ee(){q(),z(s.value)}return(e,s)=>{const v=m("ion-buttons"),I=m("ion-title"),T=m("ion-button"),$=m("ion-toolbar"),q=m("ion-header"),z=m("ion-chip"),N=m("ion-content"),A=m("ion-toast"),F=m("ion-page");return g(),f(F,{id:"main-content",main:""},{default:h((()=>{var e;return[y(q,null,{default:h((()=>[y($,null,{default:h((()=>[y(v,{slot:"start"},{default:h((()=>[y(_(W))])),_:1}),y(I,{class:"ion-text-center"},{default:h((()=>[p.value?(g(),D("div",de,b(p.value.format("YY年MM月")),1)):(g(),D("div",re,"日历"))])),_:1}),y(v,{slot:"end"},{default:h((()=>[Q()?H("",!0):(g(),f(T,{key:0,style:{position:"absolute",right:"50px"},onClick:Z},{default:h((()=>s[1]||(s[1]=[k(" 今 ")]))),_:1}))])),_:1})])),_:1})])),_:1}),y(_(K),{style:{"background-color":"antiquewhite",color:"blue"}},{default:h((()=>[(g(),D(M,null,S(t,(e=>y(_(L),{class:"ion-text-center",key:e},{default:h((()=>[k(b(e),1)])),_:2},1024))),64))])),_:1}),y(N,null,{default:h((()=>[y(_(i),{onSlideNextTransitionEnd:P,onSlidePrevTransitionEnd:U,onSwiper:Y,"centered-slides":!0,autoHeight:!0,modules:[_(n),_(d)]},{default:h((()=>[(g(!0),D(M,null,S(l.value,((e,t)=>(g(),f(_(r),{key:t},{default:h((()=>[y(_(R),{style:{height:"auto"},fixed:""},{default:h((()=>[(g(!0),D(M,null,S(e.weekArr,(t=>(g(),f(_(K),{key:t},{default:h((()=>[(g(!0),D(M,null,S(t,(t=>(g(),f(_(L),{class:"day-item",onClick:e=>((e,t)=>{u.value=t,C.value=!0})(0,t),key:t},{default:h((()=>[w("span",null,[y(z,{class:O({transparent:t.dt.unix()!==_(c)().startOf("day").unix(),today:t.dt.unix()===_(c)().startOf("day").unix(),gray:t.dt.month()!==e.month})},{default:h((()=>[k(b(t.dt.date()),1)])),_:2},1032,["class"])]),(g(!0),D(M,null,S(t.events.filter(j),((e,a)=>{var l,o;return g(),D("div",{key:a,class:O({"text-line-through":1===(null===(l=t.save[e.id])||void 0===l?void 0:l.state),gray:1===(null===(o=t.save[e.id])||void 0===o?void 0:o.state)}),style:x({"background-color":_(E)(e.color).tag})},b(e.title),7)})),128))])),_:2},1032,["onClick"])))),128))])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["modules"])])),_:1}),y(A,{"is-open":a.value.isOpen,message:a.value.text,duration:a.value.duration,onDidDismiss:s[0]||(s[0]=()=>a.value.isOpen=!1)},null,8,["is-open","message","duration"]),y(ne,{ref:"scheduleModal","is-open":C.value,dt:null===(e=u.value)||void 0===e?void 0:e.dt,userData:o.value,"onUpdate:data":ee,onWillDismiss:B},null,8,["is-open","dt","userData"])]})),_:1})}}}),[["__scopeId","data-v-1697f356"]]))}}}));
