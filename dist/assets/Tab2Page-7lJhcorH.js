import{d as D,r as m,p as F,an as v,o as k,c as w,a as e,b as n,u as l,i as g,j as x,e as H,f as M,F as W,g as s,C as y,ab as j,t as z,aa as A,a9 as P,ao as E,D as K,ap as q,y as G}from"./index-BANWcAi0.js";import{l as O,a as J,d as Q}from"./ImgMgr-DRFrF7ip.js";const U=["width","height"],X=["src"],ee=D({__name:"Tab2Page",setup(Y){const p=m(),u=m(400),d=m(300),c=m([]);F(()=>{v().then(i=>{c.value=i,console.log("picList",c.value)})});const R=async()=>{O(void 0,d.value,u.value).then(i=>{console.log("setPic id: ",i),i!==null&&v().then(t=>{c.value=t})})},T=(i,t)=>{const o=new Image;o.src=t.data,o.onload=()=>{if(p.value){const a=p.value.getContext("2d");if(a){const{dx:r,dy:h,drawWidth:C,drawHeight:b}=J(o,u.value,d.value);a.clearRect(0,0,u.value,d.value),a.drawImage(o,r,h,C,b)}}}},B=async(i,t)=>{await(await G.create({header:"Confirm",message:"确认删除这张图片么 ["+t.id+"]",buttons:[{text:"OK",handler:()=>{console.log("btnRemoveClk",t.id),Q(t.id).then(a=>{console.log("delPic",a),v().then(r=>{c.value=r})})}},"Cancel"]})).present()},L=(i,t)=>{O(t.id,d.value,u.value).then(o=>{console.log("setPic id: ",o),o!==null&&v().then(a=>{c.value=a})})};return(i,t)=>{const o=s("ion-title"),a=s("ion-header"),r=s("ion-button"),h=s("ion-buttons"),C=s("ion-label"),b=s("ion-item"),I=s("ion-icon"),N=s("ion-list"),S=s("ion-content");return k(),w(l(q),null,{default:e(()=>[n(a,null,{default:e(()=>[n(l(y),null,{default:e(()=>[n(o,null,{default:e(()=>t[0]||(t[0]=[g("Tab 2")])),_:1})]),_:1})]),_:1}),n(S,{fullscreen:!0},{default:e(()=>[n(a,{collapse:"condense"},{default:e(()=>[n(l(y),null,{default:e(()=>[n(o,{size:"large"},{default:e(()=>t[1]||(t[1]=[g("Tab 2")])),_:1}),n(h,{slot:"end"},{default:e(()=>[n(r,{onClick:R},{default:e(()=>t[2]||(t[2]=[g("选择图片")])),_:1})]),_:1})]),_:1})]),_:1}),x("canvas",{ref_key:"canvasRef",ref:p,width:u.value,height:d.value},null,8,U),n(N,null,{default:e(()=>[(k(!0),H(W,null,M(c.value,(_,V)=>(k(),w(l(j),{key:V},{default:e(()=>[n(b,{onClick:f=>T(f,_)},{default:e(()=>[n(C,null,{default:e(()=>[g(z(_.id),1)]),_:2},1024),x("img",{src:_.data,style:{height:"60px"}},null,8,X)]),_:2},1032,["onClick"]),n(l(A),{side:"end"},{default:e(()=>[n(l(P),{onClick:f=>L(f,_)},{default:e(()=>[n(I,{icon:l(E)},null,8,["icon"])]),_:2},1032,["onClick"]),n(l(P),{color:"danger",onClick:f=>B(f,_)},{default:e(()=>[n(I,{icon:l(K)},null,8,["icon"])]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})}}});export{ee as default};
