import{d as N,D as v,G as S,aF as g,r as l,o as b,c as x,a as e,b as t,u as s,h as k,j as I,e as z,f as A,F as D,a7 as P,A as G,t as M,z as W,y,aG as j,V as E,aH as K,a4 as q}from"./index-BCutpD3H.js";import{l as O,a as J,d as Q}from"./ImgMgr-DVm5uqdS.js";const U=["width","height"],X=["src"],nn=N({__name:"TabPicPage",setup(Y){const p=v(),d=v(400),u=v(300),c=v([]);S(()=>{g().then(i=>{c.value=i,console.log("picList",c.value)})});const R=async()=>{O(void 0,u.value,d.value).then(i=>{console.log("setPic id: ",i),i!==null&&g().then(n=>{c.value=n})})},T=(i,n)=>{const o=new Image;o.src=n.data,o.onload=()=>{if(p.value){const a=p.value.getContext("2d");if(a){const{dx:r,dy:h,drawWidth:f,drawHeight:C}=J(o,d.value,u.value);a.clearRect(0,0,d.value,u.value),a.drawImage(o,r,h,f,C)}}}},B=async(i,n)=>{await(await q.create({header:"Confirm",message:"确认删除这张图片么 ["+n.id+"]",buttons:[{text:"OK",handler:()=>{console.log("btnRemoveClk",n.id),Q(n.id).then(a=>{console.log("delPic",a),g().then(r=>{c.value=r})})}},"Cancel"]})).present()},L=(i,n)=>{O(n.id,u.value,d.value).then(o=>{console.log("setPic id: ",o),o!==null&&g().then(a=>{c.value=a})})};return(i,n)=>{const o=l("ion-title"),a=l("ion-header"),r=l("ion-button"),h=l("ion-buttons"),f=l("ion-item"),C=l("ion-label"),w=l("ion-icon"),V=l("ion-list"),F=l("ion-content");return b(),x(s(K),{class:"main-bg",id:"main-content"},{default:e(()=>[t(a,null,{default:e(()=>[t(s(P),null,{default:e(()=>[t(o,null,{default:e(()=>n[0]||(n[0]=[k("Tab Pic")])),_:1})]),_:1})]),_:1}),t(f,{collapse:"condense"},{default:e(()=>[t(s(P),null,{default:e(()=>[n[2]||(n[2]=I("h2",{size:"large"},"Tab",-1)),t(h,{slot:"end"},{default:e(()=>[t(r,{onClick:R},{default:e(()=>n[1]||(n[1]=[k("选择图片")])),_:1})]),_:1})]),_:1})]),_:1}),I("canvas",{ref_key:"canvasRef",ref:p,width:d.value,height:u.value},null,8,U),t(F,null,{default:e(()=>[t(V,null,{default:e(()=>[(b(!0),z(D,null,A(c.value,(_,H)=>(b(),x(s(G),{key:H},{default:e(()=>[t(f,{onClick:m=>T(m,_)},{default:e(()=>[t(C,null,{default:e(()=>[k(M(_.id),1)]),_:2},1024),I("img",{src:_.data,class:"max-w-16 max-h-16"},null,8,X)]),_:2},1032,["onClick"]),t(s(W),{side:"end"},{default:e(()=>[t(s(y),{onClick:m=>L(m,_)},{default:e(()=>[t(w,{icon:s(j)},null,8,["icon"])]),_:2},1032,["onClick"]),t(s(y),{color:"danger",onClick:m=>B(m,_)},{default:e(()=>[t(w,{icon:s(E)},null,8,["icon"])]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})}}});export{nn as default};
