const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/Home-NVvpFHKr.js","assets/js/api-shared-BuUHHa7w.js","assets/js/utils-BjcahYMR.js","assets/js/types-shared-Xm3z_OLP.js","assets/js/utils-shared-BnZFpz44.js","assets/js/element-plus-BRbs8quR.js","assets/js/vue-vendor-C-hNZ0TW.js","assets/js/vendor-4xlYshH7.js","assets/css/element-plus-CD3B3G1X.css","assets/js/vant-7Cqjo8an.js","assets/css/vant-DzKo5b93.css","assets/js/Lottery-DYQ-t89n.js","assets/js/Info-C4ZL00mT.js","assets/js/Chat-D30bRugO.js","assets/js/socket-DEWE7BO1.js","assets/css/Chat-CFJ2rmy2.css","assets/js/Score-RKKNQq2Y.js","assets/js/Timetable-BTD2_brS.js","assets/js/index-BYQH-7hP.js","assets/js/useInterval-C1dfxN8L.js","assets/css/useInterval-BJh958RX.css","assets/js/constants-shared-BwcKRbUv.js","assets/js/index-X7pN0qRX.js"])))=>i.map(i=>d[i]);
import{av as H,r as x,c as I,j as P,aw as q,ax as z,l as C,o as b,G as e,Q as t,s as S,D as J,u as v,$ as y,t as $,n as K,a6 as W,J as N,F as G,L as Q,ae as Y,ay as X,az as Z,ar as ee,aA as te}from"./vue-vendor-C-hNZ0TW.js";import{E as A,a as oe,b as B,c as j,d as se,e as ne,f as F,h as le,g as ae,p as re,m as ie,i as ue,s as ce,j as de,k as _e,l as fe,n as me,o as pe,q as ve,r as ge,t as ye,u as he,v as we,w as Le,x as V,y as Ee,z as be}from"./element-plus-BRbs8quR.js";import{b as Se,L as R,c as D,d as xe,e as Ce,i as k,f as Ie}from"./api-shared-BuUHHa7w.js";import{v as Ue,C as Ae}from"./utils-BjcahYMR.js";import{s as Pe}from"./vant-7Cqjo8an.js";import"./vendor-4xlYshH7.js";import"./types-shared-Xm3z_OLP.js";import"./utils-shared-BnZFpz44.js";(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))u(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&u(l)}).observe(document,{childList:!0,subtree:!0});function a(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function u(n){if(n.ep)return;n.ep=!0;const r=a(n);fetch(n.href,r)}})();const O=H("user",()=>{const p=x([]),c=x(!1),a=x(null),u=x({bLogin:!1,id:null,name:null,ico:null}),n=300*1e3,r="user_id",l=m=>p.value.find(g=>String(g.id)===String(m)),f=I(()=>a.value?Date.now()-a.value<n:!1),s=I(()=>u.value.bLogin),o=async(m=!1)=>{if(!(!m&&f.value&&p.value.length>0)){c.value=!0;try{const g=await Se("t_user");g&&g.data?(p.value=g.data.data||[],a.value=Date.now()):p.value=[]}catch(g){console.error("èŽ·å–ç”¨æˆ·åˆ—è¡¨å¤±è´¥:",g),A.error("èŽ·å–ç”¨æˆ·åˆ—è¡¨å¤±è´¥"),p.value=[]}finally{c.value=!1}}},i=()=>{a.value=null},d=m=>{u.value={bLogin:!0,id:m.id,name:m.name,ico:m.icon||null},localStorage.setItem(r,String(m.id))};return{userList:p,loading:c,lastFetchTime:a,curUser:u,getUserById:l,isDataFresh:f,isLoggedIn:s,refreshUserList:o,clearCache:i,setCurUser:d,clearCurUser:()=>{u.value={bLogin:!1,id:null,name:null,ico:null},localStorage.removeItem(r)},restoreCurUser:async()=>{const m=localStorage.getItem(r);if(m){p.value.length===0&&await o();const g=l(m);g&&d(g)}},getCurUserFullInfo:()=>u.value.id&&l(u.value.id)||null}}),Oe={class:"flex justify-between items-center p-5"},Te=P({__name:"Sidebar",setup(p){const c=q(),a=z(),u=O(),n=x(!1),r=()=>{},l=()=>{u.clearCurUser(),c.push("/")};return(f,s)=>{const o=B,i=j,d=F,_=ne,L=ae,h=se,m=pe,g=oe;return b(),C(g,{width:"200px",class:"w-48"},{default:e(()=>[t(m,null,{default:e(()=>[S("div",Oe,[t(o,{src:v(u).curUser.ico},null,8,["src"]),v(u).curUser.bLogin?(b(),C(i,{key:0,onClick:l,size:"small"},{default:e(()=>[...s[0]||(s[0]=[y(" æ³¨é”€ ",-1)])]),_:1})):J("",!0)]),t(h,{"default-active":v(a).path,collapse:n.value,"unique-opened":"",router:""},{default:e(()=>[t(_,{index:"/home",onClick:r},{title:e(()=>[...s[1]||(s[1]=[y("Home",-1)])]),default:e(()=>[t(d,null,{default:e(()=>[t(v(le))]),_:1})]),_:1}),t(L,{index:"mytodo"},{title:e(()=>[t(d,null,{default:e(()=>[t(v(de))]),_:1}),s[2]||(s[2]=S("span",null,"MyTodo",-1))]),default:e(()=>[t(_,{index:"/lottery",onClick:r},{title:e(()=>[...s[3]||(s[3]=[y("æŠ½å¥–è®¾ç½®",-1)])]),default:e(()=>[t(d,null,{default:e(()=>[t(v(re))]),_:1})]),_:1}),t(_,{index:"/chat"},{title:e(()=>[...s[4]||(s[4]=[y("Chat",-1)])]),default:e(()=>[t(d,null,{default:e(()=>[t(v(ie))]),_:1})]),_:1}),t(_,{index:"/info"},{title:e(()=>[...s[5]||(s[5]=[y("Info",-1)])]),default:e(()=>[t(d,null,{default:e(()=>[t(v(ue))]),_:1})]),_:1}),t(_,{index:"/score"},{title:e(()=>[...s[6]||(s[6]=[y("Score",-1)])]),default:e(()=>[t(d,null,{default:e(()=>[t(v(ce))]),_:1})]),_:1})]),_:1}),t(_,{index:"/timetable"},{title:e(()=>[...s[7]||(s[7]=[y("è¯¾ç¨‹è¡¨",-1)])]),default:e(()=>[t(d,null,{default:e(()=>[t(v(_e))]),_:1})]),_:1}),t(_,{index:"/media"},{title:e(()=>[...s[8]||(s[8]=[y("åª’ä½“",-1)])]),default:e(()=>[t(d,null,{default:e(()=>[t(v(fe))]),_:1})]),_:1}),t(_,{index:"/tools"},{title:e(()=>[...s[9]||(s[9]=[y("å·¥å…·",-1)])]),default:e(()=>[t(d,null,{default:e(()=>[t(v(me))]),_:1})]),_:1})]),_:1},8,["default-active","collapse"])]),_:1})]),_:1})}}}),T=(p,c)=>{const a=p.__vccOpts||p;for(const[u,n]of c)a[u]=n;return a},Ve=T(Te,[["__scopeId","data-v-828d8ef1"]]),Re={class:"flex flex-col gap-2 items-center"},De={class:"flex items-center border-b-1 border-gray-200"},ke={class:"pl-4 text-base text-gray-500"},Me=P({__name:"Login",emits:["login-success"],setup(p,{emit:c}){const a=c,u=O(),n=I(()=>u.userList),r=I(()=>u.loading),l=x({id:null,password:""}),f=async()=>{await u.refreshUserList(),n.value.length===0&&A.warning("ç”¨æˆ·åˆ—è¡¨ä¸ºç©ºï¼Œè¯·æ£€æŸ¥æ•°æ®åº“")},s=async()=>{if(!l.value.id)return;const o=Ue(n.value,{id:l.value.id});o&&(o.pwd===null||o.pwd===Ae.MD5(l.value.password).toString())?(u.setCurUser(o),a("login-success",{id:o.id,name:o.name,icon:o.icon})):A.error("ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯")};return $(async()=>{await f()}),(o,i)=>{const d=B,_=ge,L=ye,h=he,m=j,g=ve;return b(),C(g,{class:"w-[480px]",shadow:"always"},{header:e(()=>[...i[2]||(i[2]=[y("ç”¨æˆ·ç™»å½•",-1)])]),default:e(()=>[S("div",Re,[t(L,{modelValue:l.value.id,"onUpdate:modelValue":i[0]||(i[0]=w=>l.value.id=w),placeholder:"è¯·é€‰æ‹©ç”¨æˆ·",class:"!w-60",loading:r.value,"loading-text":"åŠ è½½ç”¨æˆ·åˆ—è¡¨ä¸­...",disabled:r.value},{default:e(()=>[(b(!0),K(G,null,W(n.value,w=>(b(),C(_,{class:"!h-13",key:w.id,label:w.name,value:w.id},{default:e(()=>[S("div",De,[t(d,{class:"!h-10 !w-10",src:w.icon},null,8,["src"]),S("div",ke,N(w.name),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","loading","disabled"]),t(h,{modelValue:l.value.password,"onUpdate:modelValue":i[1]||(i[1]=w=>l.value.password=w),style:{width:"240px"},type:"password",placeholder:"Password","show-password":""},null,8,["modelValue"]),t(m,{type:"primary",size:"large",class:"w-24 h-24 mt-4",disabled:!l.value.id,onClick:s},{default:e(()=>[...i[3]||(i[3]=[y(" Login ",-1)])]),_:1},8,["disabled"])])]),_:1})}}}),$e=T(Me,[["__scopeId","data-v-d12c731f"]]),Ne={class:"flex items-center gap-2"},Be={class:"flex items-center gap-2 text-sm"},je=P({__name:"App",setup(p){const c=O(),a=x(null),u=async()=>{const s=await xe(),o=k();if(s&&o!==!0){Ce();const i=k();a.value=i,console.log(i===!0?`[Server Switch] âœ… åˆ‡æ¢åˆ°æœ¬åœ°æœåŠ¡å™¨: ${R}:${D}`:"[Server Switch] âš ï¸ æ£€æµ‹åˆ°æœ¬åœ°æœåŠ¡å™¨å¯ç”¨ï¼Œä½†å› åè®®ä¸åŒ¹é…æ— æ³•åˆ‡æ¢")}else!s&&o!==!1?(Ie(),a.value=!1,console.log("[Server Switch] ðŸ”„ åˆ‡æ¢åˆ°è¿œç¨‹æœåŠ¡å™¨")):a.value=o},n=I(()=>a.value===!0?`æœ¬åœ° (${R}:${D})`:a.value===!1?"è¿œç¨‹":"æ£€æµ‹ä¸­..."),r=I(()=>a.value===!0?"success":a.value===!1?"warning":"info"),l=s=>{const o=c.getUserById(s.id);o?c.setCurUser(o):(console.warn("ç”¨æˆ·ä¿¡æ¯æœªæ‰¾åˆ°ï¼Œä½¿ç”¨ä¼ å…¥çš„ä¿¡æ¯"),c.setCurUser({id:s.id,name:s.name,icon:s.icon}))};let f=null;return $(async()=>{await c.refreshUserList(),await c.restoreCurUser(),await u(),f=setInterval(async()=>{await u()},5e3),console.log("[Server Monitor] æœåŠ¡å™¨ç›‘æŽ§å·²å¯åŠ¨ï¼Œæ¯ 5 ç§’æ£€æµ‹ä¸€æ¬¡")}),Q(()=>{f&&(clearInterval(f),console.log("[Server Monitor] æœåŠ¡å™¨ç›‘æŽ§å·²åœæ­¢"))}),(s,o)=>{const i=F,d=Ee,_=Le,L=Y("router-view"),h=be,m=we;return b(),C(m,{loading:v(c).loading,class:"h-screen"},{default:e(()=>[t(Ve),v(c).curUser.bLogin?(b(),C(m,{key:0},{default:e(()=>[t(_,{class:"flex justify-between items-center bg-blue-50 px-6"},{default:e(()=>[S("div",Ne,[t(i,null,{default:e(()=>[t(v(V))]),_:1}),o[0]||(o[0]=y(" å“ˆå“ˆå“ˆ ",-1)),t(i,null,{default:e(()=>[t(v(V))]),_:1})]),S("div",Be,[o[1]||(o[1]=S("span",{class:"text-gray-500"},"æœåŠ¡å™¨:",-1)),t(d,{type:r.value,size:"small"},{default:e(()=>[y(N(n.value),1)]),_:1},8,["type"])])]),_:1}),t(h,null,{default:e(()=>[t(L)]),_:1})]),_:1})):(b(),C(m,{key:1},{default:e(()=>[t(h,{class:"bg-blue-100 !flex justify-center items-center"},{default:e(()=>[t($e,{onLoginSuccess:l})]),_:1})]),_:1}))]),_:1},8,["loading"])}}}),Fe=T(je,[["__scopeId","data-v-fd67697e"]]),He="modulepreload",qe=function(p){return"/web/"+p},M={},E=function(c,a,u){let n=Promise.resolve();if(a&&a.length>0){let s=function(o){return Promise.all(o.map(i=>Promise.resolve(i).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),f=l?.nonce||l?.getAttribute("nonce");n=s(a.map(o=>{if(o=qe(o),o in M)return;M[o]=!0;const i=o.endsWith(".css"),d=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${d}`))return;const _=document.createElement("link");if(_.rel=i?"stylesheet":He,i||(_.as="script"),_.crossOrigin="",_.href=o,f&&_.setAttribute("nonce",f),document.head.appendChild(_),i)return new Promise((L,h)=>{_.addEventListener("load",L),_.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${o}`)))})}))}function r(l){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=l,window.dispatchEvent(f),!f.defaultPrevented)throw l}return n.then(l=>{for(const f of l||[])f.status==="rejected"&&r(f.reason);return c().catch(r)})},ze=[{path:"/",redirect:"/home"},{path:"/home",name:"Home",component:()=>E(()=>import("./Home-NVvpFHKr.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))},{path:"/lottery",name:"Lottery",component:()=>E(()=>import("./Lottery-DYQ-t89n.js"),__vite__mapDeps([11,5,6,2,7,8,1,3,4]))},{path:"/info",name:"Info",component:()=>E(()=>import("./Info-C4ZL00mT.js"),__vite__mapDeps([12,1,2,3,4,5,6,7,8]))},{path:"/chat",name:"Chat",component:()=>E(()=>import("./Chat-D30bRugO.js"),__vite__mapDeps([13,6,5,2,7,8,14,1,3,4,9,10,15]))},{path:"/score",name:"Score",component:()=>E(()=>import("./Score-RKKNQq2Y.js"),__vite__mapDeps([16,5,6,2,7,8,1,3,4,9,10]))},{path:"/timetable",name:"Timetable",component:()=>E(()=>import("./Timetable-BTD2_brS.js"),__vite__mapDeps([17,6,5,2,7,8,1,3,4]))},{path:"/media",name:"Media",component:()=>E(()=>import("./index-BYQH-7hP.js"),__vite__mapDeps([18,6,4,5,2,7,8,1,3,19,20,21,9,10]))},{path:"/tools",name:"Tools",component:()=>E(()=>import("./index-X7pN0qRX.js"),__vite__mapDeps([22,6,5,2,7,8,4,1,3,19,20,21,9,10]))}],Je=X({history:Z(),routes:ze}),U=ee(Fe),Ke=te();U.use(Ke);U.use(Je);U.use(Pe);U.mount("#app");export{T as _,O as u};
