import{j as Ke,r as b,t as Ge,L as kt,n as v,o as i,s as l,Q as a,G as s,$ as w,D as U,E as je,J as T,M as wt,l as R,u as B,aa as Ie,ai as Tt,c as W,y as tt,q as K,F as Se,a6 as Oe,I as ce}from"./vue-vendor-C-hNZ0TW.js";import{c as qe,L as Ct,F as ct,q as $t,A as St,D as Mt,y as He,u as lt,B as Pt,a1 as We,f as Je,E as d,ak as pe,M as at,i as Dt,a9 as st,al as nt,a8 as ft,ab as Vt,K as vt,am as pt,ae as Ft,an as Ut,a0 as Rt,X as Et,C as mt,ao as gt,ap as _t,aq as At,t as Bt,r as Lt,Y as zt,aj as jt,ai as Ot}from"./element-plus-CTY_Yuy8.js";import{m as xt,a as M,k as Xe}from"./utils-shared-Ti8AKJ8R.js";import{D as Nt,E as It,F as Kt,G as Yt,H as Gt,I as qt,J as Ht,K as Wt,M as Jt,N as Qt,O as Xt,P as Zt,Q as el,R as tl,S as ll,T as al,U as sl,V as nl,W as Ye,X as ol,Y as rl,Z as il,_ as ul,$ as dl,a0 as cl,a1 as ut,a2 as fl,a3 as vl,a4 as dt,a5 as pl,a6 as ml}from"./api-shared-DaBUc0l3.js";import{u as yt,b as ot,M as Ze,_ as et}from"./useInterval-6udtbbrf.js";import{c as ht,C as gl}from"./constants-shared-BwcKRbUv.js";import"./utils-Dtqx8Ray.js";import"./vendor-CJeEfH0b.js";import"./types-shared-DXrozTcA.js";import"./index-DD0rwcBX.js";import"./vant-Bv_herco.js";const _l={class:"p-4 flex flex-col h-[calc(100vh-200px)]"},xl={class:"mb-4 flex-shrink-0 border rounded p-3 bg-gray-50"},yl={class:"flex flex-col gap-3"},hl={class:"flex items-center gap-3"},bl={class:"flex-1 min-w-0"},kl={class:"flex items-center gap-2"},wl=["title"],Tl={key:0,class:"text-xs text-gray-500 flex-shrink-0"},Cl={class:"flex items-center gap-2"},$l={class:"flex items-center justify-between"},Sl={class:"flex-1 overflow-auto"},Ml=["onClick","title"],Pl={key:1,class:"text-gray-400"},Dl={key:0,class:"flex flex-col gap-1"},Vl={class:"text-sm"},Fl={class:"text-xs text-gray-500"},Ul={key:1,class:"text-gray-400"},Rl={key:0,class:"flex flex-col gap-1"},El={class:"text-sm"},Al={class:"text-xs text-gray-500"},Bl={key:1,class:"text-gray-400"},Ll={class:"flex flex-col gap-1 items-center"},zl=["onClick"],jl=["title"],Ol={class:"flex items-center gap-2"},Nl=Ke({__name:"PdfTool",setup(Ne){const c=b(!1),P=b([]),e=b(null),N=b(""),S=b(0),V=b(""),E=b(null),C=b(null);let $=null;const j=async()=>{try{c.value=!0;const m=await Nt();if(m.code===0){const p=m.data||[];P.value=p.map(h=>({...h,_decrypting:h.status==="processing"||!1,_password:""}))}else d.error(m.msg||"获取任务列表失败")}catch(m){M(m,"获取任务列表失败")}finally{c.value=!1}},Q=m=>{m.raw&&(e.value=m.raw,N.value=m.raw.name,S.value=0,V.value="",E.value&&te())},X=m=>{if(m<60)return`${m}秒`;if(m<3600){const p=Math.floor(m/60),h=m%60;return`${p}分${h}秒`}else{const p=Math.floor(m/3600),h=Math.floor(m%3600/60),H=m%60;return`${p}小时${h}分${H}秒`}},Y=()=>{if(C.value!==null&&S.value>0&&S.value<100){const m=Math.floor((Date.now()-C.value)/1e3);V.value=X(m)}},te=()=>{E.value&&c.value?(E.value.abort(),E.value=null,$&&(clearInterval($),$=null),S.value=0,V.value="",C.value=null,c.value=!1,d.info("上传已取消")):(e.value=null,N.value="",S.value=0,V.value="",C.value=null,d.info("已清除选中文件"))},O=async()=>{if(!e.value){d.warning("请选择要上传的文件");return}const m=e.value;if(!m.name.toLowerCase().endsWith(".pdf")){d.error("只支持 PDF 文件");return}E.value&&te();try{c.value=!0,S.value=0,V.value="",C.value=Date.now();const p=new AbortController;E.value=p,$=setInterval(()=>{Y()},1e3);const h=await It(m,H=>{S.value=H,Y()},p.signal);$&&(clearInterval($),$=null),E.value=null,h.code===0?(S.value=100,Y(),d.success("文件上传成功"),setTimeout(()=>{e.value=null,N.value="",S.value=0,V.value="",C.value=null},500),await j()):(d.error(h.msg||"文件上传失败"),S.value=0,V.value="",C.value=null)}catch(p){if(p.name==="CanceledError"||p.code==="ECONNABORTED"||p.message?.includes("canceled")||p.message?.includes("aborted")){$&&(clearInterval($),$=null),E.value||(c.value=!1);return}const h=p.message||"文件上传失败",H=S.value;p.code==="ERR_NETWORK"||p.message?.includes("Network Error")?d.error(`网络错误：上传中断。当前进度：${H}%`):p.response?.status===413?(d.error("文件太大，超过服务器限制（最大 1000MB）"),S.value=0,V.value=""):d.error(`上传失败：${h}`),$&&(clearInterval($),$=null),E.value=null,C.value=null,c.value=!1}},A=async m=>{if(!m.uploaded_info){d.warning("请先上传文件");return}if(!(m._decrypting||m.status==="processing")&&!(m.status==="success"&&!await pe.confirm("已解密的文件已存在，是否重新解密？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>!1)))try{m._decrypting=!0;const p=m._password?.trim()||void 0,h=await Kt(m.task_id,p);h.code===0?(d.success(h.data?.message||"解密任务已提交，正在后台处理"),m._password="",await me(m)):d.error(h.msg||"提交解密任务失败")}catch(p){M(p,"提交解密任务失败")}finally{m._decrypting=!1}},me=async(m,p=30)=>{let h=0;const H=async()=>{if(h>=p){d.warning("任务处理超时，请手动刷新查看状态"),await j();return}try{const re=await qt(m.task_id);if(re.code===0){const ae=re.data;m.status=ae.status,m.unlocked_info=ae.unlocked_info,m.error_message=ae.error_message,ae.status==="success"?(d.success("文件解密成功"),m._decrypting=!1,await j()):ae.status==="failed"?(d.error(ae.error_message||"文件解密失败"),m._decrypting=!1):ae.status==="processing"?(h++,setTimeout(H,1e3)):m._decrypting=!1}}catch(re){M(re,"查询任务状态失败"),m._decrypting=!1}};H()},q=async(m,p)=>{const h=p==="uploaded"?m.uploaded_info:m.unlocked_info;if(!h){d.warning("文件不存在");return}try{const H=Yt(h.name,p);window.open(H,"_blank")}catch(H){M(H,"下载文件失败")}},L=async m=>{if(!m.uploaded_info){d.warning("请先上传文件");return}if(m.status==="processing"){d.warning("任务正在处理中，无法删除");return}if(await pe.confirm("确定要删除该任务吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>!1))try{c.value=!0;const h=await Gt(m.task_id);h.code===0?(d.success(h.data?.message||"任务删除成功"),await j()):d.error(h.msg||"任务删除失败")}catch(h){M(h,"删除任务失败")}finally{c.value=!1}},le=xt,J=m=>m?new Date(m*1e3).toLocaleString():"-";return Ge(()=>{j()}),kt(()=>{$&&(clearInterval($),$=null),E.value&&(E.value.abort(),E.value=null)}),(m,p)=>{const h=qe,H=Ct,re=ct,ae=Je,G=Mt,Z=He,ye=lt,he=Pt,fe=$t,ge=St;return i(),v("div",_l,[p[12]||(p[12]=l("h2",{class:"text-xl font-semibold mb-4"},"PDF 解密工具",-1)),l("div",xl,[l("div",yl,[l("div",hl,[l("div",null,[a(h,{type:"success",size:"small",onClick:O,loading:c.value,disabled:!e.value},{default:s(()=>[...p[0]||(p[0]=[w(" 上传 ",-1)])]),_:1},8,["loading","disabled"])]),a(H,{"auto-upload":!1,"on-change":Q,"show-file-list":!1,accept:".pdf"},{trigger:s(()=>[a(h,{type:"primary",size:"small",class:"!m-0"},{default:s(()=>[...p[1]||(p[1]=[w("选择文件",-1)])]),_:1})]),_:1}),l("div",bl,[l("div",kl,[l("div",{class:je(["text-sm truncate flex-1 min-w-0",e.value?"text-gray-600":"text-gray-400"]),title:N.value||e.value?.name},T(N.value||e.value?.name||"未选择文件"),11,wl),V.value?(i(),v("div",Tl," 已用时间: "+T(V.value),1)):U("",!0)])])]),l("div",Cl,[a(re,{percentage:S.value,status:S.value===100?"success":void 0,class:"flex-1"},null,8,["percentage","status"]),a(h,{type:"danger",size:"small",plain:"",onClick:te,disabled:!e.value},{default:s(()=>[...p[2]||(p[2]=[w(" 取消 ",-1)])]),_:1},8,["disabled"])])])]),a(fe,{class:"flex-1 flex flex-col overflow-hidden",shadow:"hover"},{header:s(()=>[l("div",$l,[p[4]||(p[4]=l("span",null,"文件列表",-1)),a(h,{type:"info",size:"small",plain:"",onClick:j,loading:c.value},{default:s(()=>[c.value?U("",!0):(i(),R(ae,{key:0},{default:s(()=>[a(B(We))]),_:1})),p[3]||(p[3]=w(" 刷新 ",-1))]),_:1},8,["loading"])])]),default:s(()=>[l("div",Sl,[wt((i(),R(he,{data:P.value,stripe:"",class:"w-full"},{empty:s(()=>[...p[11]||(p[11]=[l("div",{class:"text-center text-gray-400 py-8"},"暂无文件，请上传 PDF 文件",-1)])]),default:s(()=>[a(G,{prop:"filename",label:"文件名","min-width":"200"},{default:s(({row:_})=>[_.uploaded_info?(i(),v("span",{key:0,class:"text-blue-600 cursor-pointer hover:underline",onClick:se=>q(_,"uploaded"),title:_.uploaded_info.name},T(_.uploaded_info.name||_.name||_.filename||_.task_id),9,Ml)):(i(),v("span",Pl,"-"))]),_:1}),a(G,{label:"上传文件","min-width":"150"},{default:s(({row:_})=>[_.uploaded_info?(i(),v("div",Dl,[l("span",Vl,T(B(le)(_.uploaded_info.size)),1),l("span",Fl,T(J(_.uploaded_info.modified)),1)])):(i(),v("span",Ul,"-"))]),_:1}),a(G,{label:"已解密文件","min-width":"150"},{default:s(({row:_})=>[_.unlocked_info?(i(),v("div",Rl,[l("span",El,T(B(le)(_.unlocked_info.size)),1),l("span",Al,T(J(_.unlocked_info.modified)),1)])):(i(),v("span",Bl,"未解密"))]),_:1}),a(G,{label:"状态",width:"140",align:"center"},{default:s(({row:_})=>[l("div",Ll,[_.status==="success"?(i(),R(Z,{key:0,type:"success",size:"small"},{default:s(()=>[...p[5]||(p[5]=[w("已解密",-1)])]),_:1})):_.status==="processing"?(i(),R(Z,{key:1,type:"warning",size:"small"},{default:s(()=>[...p[6]||(p[6]=[w("处理中",-1)])]),_:1})):_.status==="pending"?(i(),R(Z,{key:2,type:"info",size:"small"},{default:s(()=>[...p[7]||(p[7]=[w("等待中",-1)])]),_:1})):_.status==="failed"?(i(),R(Z,{key:3,type:"danger",size:"small"},{default:s(()=>[...p[8]||(p[8]=[w("失败",-1)])]),_:1})):(i(),R(Z,{key:4,type:"info",size:"small"},{default:s(()=>[...p[9]||(p[9]=[w("已上传",-1)])]),_:1})),_.unlocked_info?(i(),v("span",{key:5,class:"text-xs text-blue-600 cursor-pointer hover:underline",onClick:se=>q(_,"unlocked")}," 下载 ",8,zl)):U("",!0),_.error_message?(i(),v("span",{key:6,class:"text-xs text-red-500",title:_.error_message}," 错误 ",8,jl)):U("",!0)])]),_:1}),a(G,{label:"操作",width:"280",fixed:"right"},{default:s(({row:_})=>[l("div",Ol,[_.uploaded_info?(i(),R(ye,{key:0,modelValue:_._password,"onUpdate:modelValue":se=>_._password=se,type:"password",size:"small",placeholder:"密码（可选）","show-password":"",clearable:"",class:"w-30",disabled:_._decrypting||_.status==="processing",onKeyup:Ie(se=>A(_),["enter"])},null,8,["modelValue","onUpdate:modelValue","disabled","onKeyup"])):U("",!0),_.uploaded_info&&_.status!=="processing"?(i(),R(h,{key:1,type:"primary",size:"small",onClick:se=>A(_),loading:_._decrypting,disabled:_._decrypting||_.status==="processing"},{default:s(()=>[w(T(_.status==="success"?"重新解密":"解密"),1)]),_:2},1032,["onClick","loading","disabled"])):U("",!0),_.uploaded_info?(i(),R(h,{key:2,type:"danger",size:"small",plain:"",onClick:se=>L(_),disabled:_.status==="processing"},{default:s(()=>[...p[10]||(p[10]=[w(" 删除 ",-1)])]),_:1},8,["onClick","disabled"])):U("",!0)])]),_:1})]),_:1},8,["data"])),[[ge,c.value]])])]),_:1})])}}}),Il={viewBox:"0 0 512 512",width:"1.2em",height:"1.2em"};function Kl(Ne,c){return i(),v("svg",Il,[...c[0]||(c[0]=[l("path",{fill:"none",stroke:"currentColor","stroke-linecap":"square","stroke-width":"48",d:"m136 208l120-104l120 104m-240 96l120 104l120-104"},null,-1)])])}const Yl=Tt({name:"ion-chevron-expand-sharp",render:Kl}),Gl={class:"flex gap-4 h-[calc(100vh-220px)]"},ql={class:"w-64 border rounded p-3 flex flex-col"},Hl={class:"flex items-center justify-between mb-3"},Wl={class:"flex items-center gap-1"},Jl={key:0,class:"flex-1 overflow-y-auto space-y-2 pr-1 min-h-[400px]"},Ql=["onClick"],Xl={class:"flex items-center justify-between gap-2"},Zl={class:"text-sm font-medium truncate flex-1 min-w-0"},ea={class:"text-xs text-gray-500 whitespace-nowrap flex items-center gap-1 flex-shrink-0"},ta={class:"whitespace-nowrap w-5 flex items-center justify-center"},la={class:"flex items-center justify-between gap-2 min-h-[20px]"},aa={class:"flex items-center gap-1 flex-shrink-0"},sa={key:1,class:"flex-1 flex items-center justify-center text-sm text-gray-400"},na={key:0,class:"flex-1 border rounded p-3 flex flex-col max-w-2xl"},oa={class:"flex items-center justify-between mb-3 flex-shrink-0"},ra={class:"text-base font-semibold"},ia={class:"text-sm text-gray-500"},ua={class:"flex-1 overflow-auto flex flex-col gap-3"},da={class:"flex items-center justify-between gap-4 flex-shrink-0"},ca={class:"flex items-center gap-4"},fa={class:"text-red-500 text-xs truncate max-w-xs inline-block cursor-help"},va={class:"flex items-center gap-2"},pa={class:"border rounded p-2 flex-1 flex flex-col overflow-hidden"},ma={class:"flex items-center justify-between mb-2 flex-shrink-0"},ga={class:"flex items-center gap-1 pr-1"},_a={class:"flex-1 overflow-auto"},xa={key:0},ya=["draggable","onDragstart","onDrop"],ha={class:"text-xs text-gray-500 w-8"},ba=["title"],ka={key:0,class:"text-xs text-gray-500 whitespace-nowrap w-20 text-right"},wa={key:1,class:"w-20"},Ta={key:1,class:"text-sm text-gray-400 text-center py-1"},Ca={key:1,class:"flex-1 border rounded p-3 flex flex-col max-w-2xl"},$a=Ke({__name:"AudioMerge",setup(Ne){const c=b(!1),P=b([]),e=b(null),N=b(!1),S=b(!1),V=b(!1),E=b(null),C=yt({callbacks:{onPlay:()=>{d.success("开始播放")},onError:()=>{M(new Error("音频播放失败"),"播放失败"),Z()},onEnded:()=>{Z()}}}),$={size:"small",plain:!0,class:"!w-8 !h-6 !p-0"},j={size:"small",plain:!0,class:"!h-5 !text-xs !px-2"},Q={size:"small",plain:!0,class:"!h-7 !text-xs"},X=["bg-gray-100","border-t-2","border-b-2","border-blue-500"],Y=o=>{o&&o.classList.remove(...X)},te=o=>{if(!o)return;o.querySelectorAll('[draggable="true"]').forEach(g=>Y(g))},O=async o=>{if(e.value&&o.length!==0)try{c.value=!0;for(const u of o){const g=await Ht(e.value.task_id,u);if(g.code!==0){d.error(`添加文件失败: ${g.msg||"未知错误"}`);break}}d.success(`成功添加 ${o.length} 个文件`),await q(e.value.task_id)}catch(u){M(u,"添加文件失败")}finally{c.value=!1}},A=async()=>{try{c.value=!0;const o=await Wt();o.code===0?(P.value=o.data.tasks||[],P.value.length>0&&!e.value&&await q(P.value[0].task_id)):d.error(o.msg||"获取任务列表失败")}catch(o){M(o,"获取任务列表失败")}finally{c.value=!1}},me=async()=>{try{c.value=!0;const o=await Jt();o.code===0?(d.success("任务创建成功"),await A(),q(o.data.task_id)):d.error(o.msg||"创建任务失败")}catch(o){M(o,"创建任务失败")}finally{c.value=!1}},q=async o=>{e.value&&e.value.task_id!==o&&ge();try{c.value=!0;const u=await Qt(o);u.code===0?e.value=u.data:d.error(u.msg||"获取任务信息失败")}catch(u){M(u,"获取任务信息失败")}finally{c.value=!1}},L=async o=>{if(await pe.confirm("确定要删除该任务吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>!1))try{c.value=!0;const g=await tl(o);g.code===0?(d.success("任务删除成功"),await A(),e.value&&e.value.task_id===o&&(P.value&&P.value.length>0?await q(P.value[0].task_id):e.value=null)):d.error(g.msg||"删除任务失败")}catch(g){M(g,"删除任务失败")}finally{c.value=!1}},le=()=>{if(!e.value){d.warning("请先创建或选择任务");return}N.value=!0},J=async o=>{if(!(!e.value||!await pe.confirm("确定要删除该文件吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>!1)))try{c.value=!0;const g=await ll(e.value.task_id,o);g.code===0?(C.playingFileIndex.value===o?ge():C.playingFileIndex.value!==null&&C.playingFileIndex.value>o&&(C.playingFileIndex.value=C.playingFileIndex.value-1),d.success("文件删除成功"),await q(e.value.task_id)):d.error(g.msg||"删除文件失败")}catch(g){M(g,"删除文件失败")}finally{c.value=!1}},m=async()=>{if(!(!e.value||!await pe.confirm(`确定要开始合成吗？将合并 ${ue.value} 个音频文件。`,"确认合成",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>!1)))try{c.value=!0;const u=await Xt(e.value.task_id);u.code===0?(d.success("合成任务已启动"),await A(),await q(e.value.task_id),H()):d.error(u.msg||"启动任务失败")}catch(u){M(u,"启动任务失败")}finally{c.value=!1}},{start:p,stop:h}=ot(async()=>{if(!e.value||e.value.status!=="processing"){h();return}await A(),await q(e.value.task_id)},ht,{immediate:!1}),H=()=>{p()},re=o=>{if(!o)return;const u=al(o);window.open(u,"_blank")},ae=()=>{e.value?.result_file&&re(e.value.task_id)},G=o=>{o?.result_file&&re(o.task_id)},Z=()=>{C.clear()},ye=(o,u)=>{if(!o)return;const g=o?.path||o?.name||"";C.seekFile(g,u)},he=(o,u)=>{e.value?.result_file&&ye({path:e.value.result_file},u)},fe=o=>{if(!e.value||!e.value.files||o<0||o>=e.value.files.length)return;const u=e.value.files[o],g=u.path||u.name||"";if(!g){d.warning("文件路径不存在");return}if(C.playingFilePath.value===g&&C.audio&&!C.audio.paused){Z(),d.info("已停止播放");return}const I=Xe(g);if(!I){d.error("无法生成媒体文件URL");return}C.load(I,{playingFilePath:g,playingFileIndex:o}),C.play().catch(ne=>{M(ne,"播放失败"),Z()})},ge=()=>{Z()},_=()=>{if(!e.value||!e.value.result_file){d.warning("结果文件不存在");return}const o=e.value.result_file;if(C.playingFilePath.value===o&&C.audio&&!C.audio.paused){Z(),d.info("已停止播放");return}const u=Xe(o);if(!u){d.error("无法生成媒体文件URL");return}C.load(u,{playingFilePath:o}),C.play().catch(g=>{M(g,"播放失败"),Z()})},se=()=>{if(!e.value||!e.value.result_file){d.warning("结果文件不存在");return}S.value=!0},Fe=async o=>{if(!e.value||!e.value.result_file)return;if(o.length===0){d.warning("请选择转存目录");return}const u=o[0];try{c.value=!0;const g=await Zt(e.value.task_id,u);g.code===0?(d.success("转存成功"),S.value=!1):d.error(g.msg||"转存失败")}catch(g){M(g,"转存失败")}finally{c.value=!1}},Me=xt,Ue={pending:{tag:"info",text:"等待中"},processing:{tag:"warning",text:"处理中"},success:{tag:"success",text:"成功"},failed:{tag:"danger",text:"失败"}},de=o=>Ue[o]?.tag||"info",be=o=>Ue[o]?.text||"未知",ke=W(()=>e.value?.status==="processing"),ie=W(()=>(e.value?.files||[]).length>0),ue=W(()=>(e.value?.files||[]).length),Pe=W(()=>e.value?.result_file),Re=W(()=>!Pe.value||e.value?.status!=="success"||V.value),f=W(()=>!ie.value||ke.value||V.value),r=W(()=>ke.value||V.value),F=W(()=>!e.value||!ie.value||ke.value),z=W(()=>V.value?"点击退出拖拽排序模式":"点击进入拖拽排序模式"),_e=W(()=>({path:Pe.value||""})),we=(o,u)=>!o||!u||o.length!==u.length?!0:o.some((g,I)=>{const ne=g?.path||g?.name,Ce=u[I]?.path||u[I]?.name;return ne!==Ce}),De=async()=>{if(V.value){if(e.value&&e.value.files&&e.value.files.length>0){if(we(E.value||[],e.value.files))try{c.value=!0;const u=e.value.files.map((I,ne)=>ne),g=await el(e.value.task_id,u);g.code===0?(d.success("排序已保存"),await q(e.value.task_id)):d.error(g.msg||"保存排序失败")}catch(u){M(u,"保存排序失败")}finally{c.value=!1}E.value=null}}else e.value&&e.value.files&&e.value.files.length>0&&(E.value=[...e.value.files||[]]);V.value=!V.value},Te=(o,u)=>{if(!V.value)return o.preventDefault(),!1;try{o.dataTransfer&&(o.dataTransfer.effectAllowed="move",o.dataTransfer.setData("text/plain",u.toString()))}catch(g){console.error("拖拽开始失败:",g)}},Ee=o=>{o.currentTarget&&Y(o.currentTarget)},Ae=o=>{o.currentTarget&&Y(o.currentTarget)},Be=o=>{if(V.value&&(o.preventDefault(),o.dataTransfer&&(o.dataTransfer.dropEffect="move"),o.currentTarget)){const u=o.currentTarget.getBoundingClientRect(),g=o.clientY,I=u.top+u.height/2;Y(o.currentTarget),g<I?o.currentTarget.classList.add("border-t-2","border-blue-500"):o.currentTarget.classList.add("border-b-2","border-blue-500")}},Le=(o,u)=>{if(!V.value||(o.preventDefault(),o.currentTarget&&(Y(o.currentTarget),te(o.currentTarget.parentElement)),!o.dataTransfer))return;const g=parseInt(o.dataTransfer.getData("text/plain"),10);if(g===u||isNaN(g)||!e.value||!e.value.files||g<0||g>=e.value.files.length||u<0||u>=e.value.files.length)return;const I=o.currentTarget?.getBoundingClientRect(),ne=o.clientY,Ce=I?I.top+I.height/2:0,n=ne<Ce?u:u+1,t=[...e.value.files||[]],[k]=t.splice(g,1),x=g<n?n-1:n;t.splice(x,0,k),e.value={...e.value,files:t}},y=()=>{N.value=!1};return Ge(()=>{A()}),tt(()=>{ge(),h()}),(o,u)=>{const g=Je,I=qe,ne=He,Ce=nt,n=Yl;return i(),v("div",Gl,[l("div",ql,[l("div",Hl,[u[7]||(u[7]=l("h3",{class:"text-base font-semibold"},"任务列表",-1)),l("div",Wl,[a(I,K({type:"info"},$,{onClick:A,loading:c.value}),{default:s(()=>[c.value?U("",!0):(i(),R(g,{key:0},{default:s(()=>[a(B(We))]),_:1}))]),_:1},16,["loading"]),a(I,K({type:"success"},$,{onClick:me,loading:c.value}),{default:s(()=>[a(g,null,{default:s(()=>[a(B(at))]),_:1})]),_:1},16,["loading"])])]),P.value&&P.value.length>0?(i(),v("div",Jl,[(i(!0),v(Se,null,Oe(P.value,t=>(i(),v("div",{key:t.task_id,class:je(["border rounded px-3 py-2 cursor-pointer hover:bg-gray-50 group min-h-[60px] flex flex-col justify-between",{"border-blue-500 bg-blue-50":e.value&&t.task_id===e.value.task_id}]),onClick:k=>q(t.task_id)},[l("div",Xl,[l("div",Zl,T(t.name),1),l("span",ea,[a(g,null,{default:s(()=>[a(B(Dt),{class:"!w-3 !h-3"})]),_:1}),l("span",ta,T(t.files?t.files.length:0),1)])]),l("div",la,[a(ne,{type:de(t.status),size:"small",class:"!h-5 !text-xs w-16 text-center"},{default:s(()=>[w(T(be(t.status)),1)]),_:2},1032,["type"]),l("div",aa,[t.status==="success"&&t.result_file?(i(),R(I,K({key:0,type:"primary"},{ref_for:!0},j,{onClick:ce(k=>G(t),["stop"])}),{default:s(()=>[...u[8]||(u[8]=[w(" 下载 ",-1)])]),_:1},16,["onClick"])):U("",!0),a(I,K({type:"danger"},{ref_for:!0},j,{onClick:ce(k=>L(t.task_id),["stop"]),disabled:t.status==="processing"}),{default:s(()=>[a(g,null,{default:s(()=>[a(B(st))]),_:1})]),_:1},16,["onClick","disabled"])])])],10,Ql))),128))])):(i(),v("div",sa,' 暂无任务，请点击"新建"创建 '))]),e.value?(i(),v("div",na,[l("div",oa,[l("h3",ra,"任务详情: "+T(e.value.name),1),l("span",ia," 共 "+T(ue.value)+" 个文件 ",1)]),l("div",ua,[l("div",da,[l("div",ca,[a(ne,{type:de(e.value.status),size:"small",class:"w-16 text-center"},{default:s(()=>[w(T(be(e.value.status)),1)]),_:1},8,["type"]),Pe.value?(i(),R(Ze,{key:0,file:_e.value,player:B(C),disabled:V.value,onPlay:_,onSeek:he},null,8,["file","player","disabled"])):U("",!0),a(I,K({type:"primary"},Q,{onClick:ae,disabled:Re.value}),{default:s(()=>[...u[9]||(u[9]=[w(" 下载 ",-1)])]),_:1},16,["disabled"]),a(I,K({type:"success"},Q,{onClick:se,disabled:Re.value}),{default:s(()=>[...u[10]||(u[10]=[w(" 转存 ",-1)])]),_:1},16,["disabled"]),e.value.error_message?(i(),R(Ce,{key:1,content:`错误: ${e.value.error_message}`,placement:"top"},{default:s(()=>[l("span",fa," 错误: "+T(e.value.error_message),1)]),_:1},8,["content"])):U("",!0)]),l("div",va,[a(I,K({type:"success"},Q,{onClick:m,disabled:f.value,loading:ke.value}),{default:s(()=>[...u[11]||(u[11]=[w(" 开始合成 ",-1)])]),_:1},16,["disabled","loading"])])]),l("div",pa,[l("div",ma,[u[13]||(u[13]=l("h4",{class:"text-sm font-semibold"},"文件列表",-1)),l("div",ga,[a(I,K({type:"primary"},j,{disabled:r.value,onClick:le}),{default:s(()=>[...u[12]||(u[12]=[w(" + ",-1)])]),_:1},16,["disabled"]),a(I,K({type:V.value?"success":"default"},$,{onClick:De,disabled:F.value,title:z.value}),{default:s(()=>[V.value?(i(),R(g,{key:0},{default:s(()=>[a(B(ft))]),_:1})):(i(),R(n,{key:1,class:"!w-3.5 !h-3.5"}))]),_:1},16,["type","disabled","title"])])]),l("div",_a,[ie.value?(i(),v("div",xa,[(i(!0),v(Se,null,Oe(e.value.files,(t,k)=>(i(),v("div",{key:k,class:je(["flex items-center gap-2 p-1 hover:bg-gray-100 rounded",{"cursor-move":V.value,"cursor-default":!V.value,"select-none":!0}]),draggable:V.value,onDragstart:x=>Te(x,Number(k)),onDragend:u[2]||(u[2]=x=>Ee(x)),onDragover:u[3]||(u[3]=ce(x=>Be(x),["prevent"])),onDragleave:Ae,onDrop:ce(x=>Le(x,Number(k)),["prevent"])},[l("span",ha,T(Number(k)+1),1),l("span",{class:"flex-1 text-sm truncate",title:t.path||t.name},T(t.name),9,ba),t.size?(i(),v("span",ka,T(B(Me)(t.size)),1)):(i(),v("div",wa)),l("div",{class:"flex items-center gap-1 flex-shrink-0",onMousedown:u[0]||(u[0]=ce(()=>{},["stop"])),onClick:u[1]||(u[1]=ce(()=>{},["stop"]))},[a(Ze,{file:t,player:B(C),disabled:r.value,onPlay:()=>fe(Number(k)),onSeek:ye},null,8,["file","player","disabled","onPlay"]),a(I,{type:"info",size:"small",plain:"",circle:"",onClick:ce(x=>J(Number(k)),["stop"]),disabled:r.value,class:"!h-6 !text-xs"},{default:s(()=>[a(g,null,{default:s(()=>[a(B(Vt))]),_:1})]),_:1},8,["onClick","disabled"])],32)],42,ya))),128))])):(i(),v("div",Ta,"文件列表为空"))])])])])):(i(),v("div",Ca,[...u[14]||(u[14]=[l("div",{class:"flex items-center justify-between mb-3 flex-shrink-0"},[l("h3",{class:"text-base font-semibold"},"任务详情")],-1),l("div",{class:"flex-1 flex items-center justify-center text-sm text-gray-400"}," 请从左侧选择一个任务查看详情 ",-1)])])),a(et,{visible:N.value,"onUpdate:visible":u[4]||(u[4]=t=>N.value=t),title:"选择文件添加到任务","confirm-button-text":"添加","confirm-loading":c.value,onConfirm:O,onClose:y},null,8,["visible","confirm-loading"]),a(et,{visible:S.value,"onUpdate:visible":u[5]||(u[5]=t=>S.value=t),title:"选择转存目录","confirm-button-text":"转存",mode:"directory","confirm-loading":c.value,onConfirm:Fe,onClose:u[6]||(u[6]=t=>S.value=!1)},null,8,["visible","confirm-loading"])])}}}),Sa={class:"flex gap-4 h-[calc(100vh-220px)]"},Ma={class:"w-64 border rounded p-3 flex flex-col"},Pa={class:"flex items-center justify-between mb-3"},Da={class:"flex items-center gap-1"},Va={key:0,class:"flex-1 overflow-y-auto space-y-2 pr-1 min-h-[400px]"},Fa=["onClick"],Ua={class:"flex items-center justify-between gap-2"},Ra=["title"],Ea={class:"flex items-center justify-between gap-2 min-h-[20px]"},Aa={class:"flex items-center gap-1 flex-shrink-0"},Ba={key:1,class:"flex-1 flex items-center justify-center text-sm text-gray-400 min-h-[400px]"},La={key:0,class:"flex-1 border rounded p-3 flex flex-col min-h-0"},za={class:"flex items-center justify-between mb-3 flex-shrink-0"},ja={class:"flex items-center gap-2 flex-1"},Oa={class:"text-base font-semibold"},Na={class:"flex-1 flex flex-col gap-3 min-h-0"},Ia={class:"flex items-center gap-4 flex-shrink-0"},Ka={class:"text-red-500 text-xs truncate block max-w-md cursor-help"},Ya={class:"border rounded p-3 flex flex-col gap-2"},Ga={class:"flex items-center justify-between"},qa={class:"flex items-center gap-2"},Ha={key:0,class:"text-xs text-gray-500"},Wa={key:0,class:"text-sm text-gray-600"},Ja=["title"],Qa={key:1,class:"text-sm text-gray-400"},Xa={class:"border rounded p-3 flex flex-col gap-2 flex-1 min-h-0 overflow-hidden"},Za={key:0,class:"flex-1 overflow-y-scroll scrollbar-overlay space-y-1 min-h-0"},es={class:"flex-1 min-w-0 flex items-center gap-3 text-sm"},ts=["title"],ls={class:"flex items-center gap-2 text-xs text-gray-500 flex-shrink-0"},as={key:0},ss={key:1},ns=["title"],os={key:1,class:"flex-1 flex items-center justify-center text-sm text-gray-400 min-h-0"},rs={key:1,class:"flex-1 border rounded p-3 flex flex-col"},is={key:2,class:"w-80 border rounded p-3 flex flex-col"},us={class:"flex-1 overflow-auto flex flex-col gap-3"},ds={class:"border rounded p-3 flex flex-col gap-2"},cs={class:"flex items-center gap-2"},fs={class:"border rounded p-3 flex flex-col gap-2"},vs={class:"flex items-center gap-2"},ps={class:"text-xs text-gray-400 flex items-center gap-1"},ms={key:0,class:"border rounded p-3 flex flex-col gap-2"},gs={key:0,class:"space-y-2"},_s={class:"text-sm text-gray-600"},xs=["title"],ys={key:1,class:"text-sm text-gray-400"},hs={key:1,class:"border rounded p-3 flex flex-col gap-2"},bs={class:"text-sm text-gray-600"},ks={key:0,class:"mt-2"},ws={key:3,class:"w-80 border rounded p-3 flex flex-col"},Ts=Ke({__name:"AudioConvert",setup(Ne){const c=b(!1),P=b([]),e=b(null),N=b(!1),S=b("mp3"),V=b(!1),E=b(!0),C=b(!1),$=b(!1),j=b(""),Q=b(!1),X=b(""),Y={size:"small",plain:!0,class:"!w-8 !h-6 !p-0"},te={size:"small",plain:!0,class:"!h-5 !text-xs !px-2"},O={size:"small",plain:!0,class:"!h-7 !text-xs"},A=async()=>{try{c.value=!0;const f=await sl();f.code===0?(P.value=f.data.tasks||[],P.value.length>0&&!e.value&&await J(P.value[0].task_id)):d.error(f.msg||"获取任务列表失败")}catch(f){M(f,"获取任务列表失败")}finally{c.value=!1}},me=()=>{const f=new Date,r=f.getFullYear(),F=String(f.getMonth()+1).padStart(2,"0"),z=String(f.getDate()).padStart(2,"0"),_e=String(f.getHours()).padStart(2,"0"),we=String(f.getMinutes()).padStart(2,"0"),De=String(f.getSeconds()).padStart(2,"0");j.value=`${r}-${F}-${z} ${_e}:${we}:${De}`,$.value=!0},q=async()=>{if(!j.value.trim()){d.warning("请输入任务名称");return}try{c.value=!0;const f=await nl({name:j.value.trim()});f.code===0?(d.success("任务创建成功"),$.value=!1,j.value="",await A(),J(f.data.task_id)):d.error(f.msg||"创建任务失败")}catch(f){M(f,"创建任务失败")}finally{c.value=!1}},L=()=>{e.value&&(X.value=e.value.name,Q.value=!0)},le=async()=>{if(e.value){if(!X.value.trim()){d.warning("请输入任务名称");return}try{c.value=!0;const f=await Ye(e.value.task_id,{name:X.value.trim()});f.code===0?(d.success("任务名称修改成功"),Q.value=!1,X.value="",await J(e.value.task_id)):d.error(f.msg||"修改任务名称失败")}catch(f){M(f,"修改任务名称失败")}finally{c.value=!1}}},J=async f=>{try{c.value=!0;const r=await ol(f);if(r.code===0){e.value=r.data;const F=P.value.findIndex(z=>z.task_id===f);F!==-1&&(P.value[F]={...r.data}),S.value=r.data.output_dir||"mp3",V.value=!1,E.value=r.data.overwrite!==!1,C.value=!1}else d.error(r.msg||"获取任务信息失败")}catch(r){M(r,"获取任务信息失败")}finally{c.value=!1}},m=async f=>{if(await pe.confirm("确定要删除该任务吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>!1))try{c.value=!0;const F=await il(f);F.code===0?(d.success("任务删除成功"),await A(),e.value&&e.value.task_id===f&&(P.value&&P.value.length>0?await J(P.value[0].task_id):e.value=null)):d.error(F.msg||"删除任务失败")}catch(F){M(F,"删除任务失败")}finally{c.value=!1}},p=()=>{if(!e.value){d.warning("请先创建或选择任务");return}N.value=!0},h=async f=>{if(!e.value||f.length===0)return;const r=f[0];try{c.value=!0;const F=await Ye(e.value.task_id,{directory:r});F.code===0?(d.success("目录设置成功"),await J(e.value.task_id),N.value=!1):d.error(F.msg||"设置目录失败")}catch(F){M(F,"设置目录失败")}finally{c.value=!1}},H=()=>{N.value=!1},re=()=>{if(!e.value)return;const f=e.value.output_dir||"mp3";V.value=S.value!==f},ae=async()=>{if(e.value){if(!S.value.trim()){d.error("输出目录名称不能为空");return}try{c.value=!0;const f=await Ye(e.value.task_id,{output_dir:S.value.trim()});f.code===0?(d.success("输出目录名称保存成功"),await J(e.value.task_id)):d.error(f.msg||"保存输出目录名称失败")}catch(f){M(f,"保存输出目录名称失败")}finally{c.value=!1}}},G=()=>{if(!e.value)return;const f=e.value.overwrite!==!1;C.value=E.value!==f,C.value&&Z()},Z=async()=>{if(e.value)try{c.value=!0;const f=await Ye(e.value.task_id,{overwrite:E.value});f.code===0?(d.success("覆盖选项保存成功"),await J(e.value.task_id)):d.error(f.msg||"保存覆盖选项失败")}catch(f){M(f,"保存覆盖选项失败")}finally{c.value=!1}},ye=async()=>{if(!e.value)return;if(!e.value.directory){d.warning("请先选择转码目录");return}if(await pe.confirm(`确定要开始转码吗？将转换 "${e.value.name}" 。`,"确认转码",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>!1))try{c.value=!0;const r=await rl(e.value.task_id);r.code===0?(d.success("转码任务已启动"),await A(),await J(e.value.task_id),ge()):d.error(r.msg||"启动任务失败")}catch(r){M(r,"启动任务失败")}finally{c.value=!1}},{start:he,stop:fe}=ot(async()=>{if(!e.value){fe();return}if(await A(),e.value.status!=="processing"){await J(e.value.task_id),fe();return}await J(e.value.task_id)},gl,{immediate:!1}),ge=()=>{he()},_={pending:{tag:"info",text:"等待中"},processing:{tag:"warning",text:"处理中"},success:{tag:"success",text:"成功"},failed:{tag:"danger",text:"失败"}},se=f=>_[f]?.tag||"info",Fe=f=>_[f]?.text||"未知",Me=W(()=>e.value?.status==="processing"),Ue=W(()=>!e.value?.directory||Me.value),de=W(()=>Me.value),be=W(()=>e.value?.file_status?Object.keys(e.value.file_status).map(f=>{const r=e.value.file_status[f];return{path:f,status:r.status||"pending",error:r.error,size:r.size,duration:r.duration}}):[]),ke=f=>f.path.split("/").pop()||f.path,ie=f=>f.status,ue=f=>f.error,Pe=f=>{if(!f)return"";const r=["B","KB","MB","GB"];let F=f,z=0;for(;F>=1024&&z<r.length-1;)F/=1024,z++;return`${F.toFixed(1)} ${r[z]}`},Re=f=>{if(!f)return"";const r=Math.floor(f/3600),F=Math.floor(f%3600/60),z=f%60;return r>0?`${r}:${F.toString().padStart(2,"0")}:${z.toString().padStart(2,"0")}`:`${F}:${z.toString().padStart(2,"0")}`};return Ge(()=>{A()}),tt(()=>{fe()}),(f,r)=>{const F=Je,z=qe,_e=He,we=nt,De=Rt,Te=lt,Ee=ct,Ae=_t,Be=gt,Le=mt;return i(),v("div",Sa,[l("div",Ma,[l("div",Pa,[r[11]||(r[11]=l("h3",{class:"text-base font-semibold"},"任务列表",-1)),l("div",Da,[a(z,K({type:"info"},Y,{onClick:A,loading:c.value}),{default:s(()=>[c.value?U("",!0):(i(),R(F,{key:0},{default:s(()=>[a(B(We))]),_:1}))]),_:1},16,["loading"]),a(z,K({type:"success"},Y,{onClick:me,loading:c.value}),{default:s(()=>[c.value?U("",!0):(i(),R(F,{key:0},{default:s(()=>[a(B(at))]),_:1}))]),_:1},16,["loading"])])]),P.value&&P.value.length>0?(i(),v("div",Va,[(i(!0),v(Se,null,Oe(P.value,y=>(i(),v("div",{key:y.task_id,class:je(["border rounded px-3 py-2 cursor-pointer hover:bg-gray-50 group min-h-[60px] flex flex-col justify-between",{"border-blue-500 bg-blue-50":e.value&&y.task_id===e.value.task_id}]),onClick:o=>J(y.task_id)},[l("div",Ua,[l("div",{class:"text-sm font-medium truncate flex-1 min-w-0",title:y.name},T(y.name),9,Ra)]),l("div",Ea,[a(_e,{type:se(y.status),size:"small",class:"!h-5 !text-xs w-16 text-center"},{default:s(()=>[w(T(Fe(y.status)),1)]),_:2},1032,["type"]),l("div",Aa,[a(z,K({type:"danger"},{ref_for:!0},te,{onClick:ce(o=>m(y.task_id),["stop"]),disabled:y.status==="processing"}),{default:s(()=>[a(F,null,{default:s(()=>[a(B(st))]),_:1})]),_:1},16,["onClick","disabled"])])])],10,Fa))),128))])):(i(),v("div",Ba,' 暂无任务，请点击"新建"创建 '))]),e.value?(i(),v("div",La,[l("div",za,[l("div",ja,[l("h3",Oa,"文件列表: "+T(e.value.name),1),a(z,{type:"default",size:"small",plain:"",circle:"",disabled:de.value,onClick:L,title:"编辑名称"},{default:s(()=>[a(F,null,{default:s(()=>[a(B(vt))]),_:1})]),_:1},8,["disabled"])])]),l("div",Na,[l("div",Ia,[a(_e,{type:se(e.value.status),size:"small",class:"w-16 text-center flex-shrink-0"},{default:s(()=>[w(T(Fe(e.value.status)),1)]),_:1},8,["type"]),e.value.error_message?(i(),R(we,{key:0,content:`错误: ${e.value.error_message}`,placement:"top",class:"flex-1 min-w-0 max-w-md"},{default:s(()=>[l("span",Ka," 错误: "+T(e.value.error_message),1)]),_:1},8,["content"])):U("",!0)]),l("div",Ya,[l("div",Ga,[l("div",qa,[r[12]||(r[12]=l("h4",{class:"text-sm font-semibold"},"转码目录",-1)),e.value.total_files!==null&&e.value.total_files!==void 0?(i(),v("span",Ha," 可处理文件数: "+T(e.value.total_files),1)):U("",!0)]),a(z,K({type:"primary"},te,{disabled:de.value,onClick:p}),{default:s(()=>[...r[13]||(r[13]=[w(" 选择目录 ",-1)])]),_:1},16,["disabled"])]),e.value.directory?(i(),v("div",Wa,[l("div",{class:"truncate",title:e.value.directory},T(e.value.directory),9,Ja)])):(i(),v("div",Qa," 请选择一个目录，该目录下的所有媒体文件将被转换为 MP3 格式 "))]),l("div",Xa,[r[14]||(r[14]=l("h4",{class:"text-sm font-semibold flex-shrink-0"},"文件列表",-1)),be.value&&be.value.length>0?(i(),v("div",Za,[(i(!0),v(Se,null,Oe(be.value,(y,o)=>(i(),v("div",{key:o,class:"flex items-center gap-2 p-2 rounded hover:bg-gray-50 border-b border-gray-100"},[a(F,{class:je(["flex-shrink-0",{"text-green-500":ie(y)==="success","text-red-500":ie(y)==="failed","text-yellow-500":ie(y)==="processing","text-gray-400":ie(y)==="pending"}])},{default:s(()=>[ie(y)==="success"?(i(),R(B(ft),{key:0})):ie(y)==="failed"?(i(),R(B(pt),{key:1})):ie(y)==="processing"?(i(),R(B(Ft),{key:2})):(i(),R(B(Ut),{key:3}))]),_:2},1032,["class"]),l("div",es,[l("div",{class:"flex-1 min-w-0 truncate",title:y.path},T(ke(y)),9,ts),l("div",ls,[y.size?(i(),v("span",as,T(Pe(y.size)),1)):U("",!0),y.duration?(i(),v("span",ss,T(Re(y.duration)),1)):U("",!0)]),ue(y)?(i(),v("div",{key:0,class:"text-xs text-red-500 truncate max-w-xs",title:ue(y)},T(ue(y)),9,ns)):U("",!0)])]))),128))])):(i(),v("div",os," 暂无文件，请先选择转码目录 "))])])])):(i(),v("div",rs,[...r[15]||(r[15]=[l("div",{class:"flex items-center justify-between mb-3 flex-shrink-0"},[l("h3",{class:"text-base font-semibold"},"文件列表")],-1),l("div",{class:"flex-1 flex items-center justify-center text-sm text-gray-400"}," 请从左侧选择一个任务查看文件列表 ",-1)])])),e.value?(i(),v("div",is,[r[24]||(r[24]=l("div",{class:"flex items-center justify-between mb-3"},[l("h3",{class:"text-base font-semibold"},"输出信息")],-1)),l("div",us,[l("div",ds,[l("div",cs,[r[16]||(r[16]=l("span",{class:"text-sm text-gray-600"},"覆盖同名文件",-1)),a(De,{modelValue:E.value,"onUpdate:modelValue":r[0]||(r[0]=y=>E.value=y),disabled:de.value,onChange:G},null,8,["modelValue","disabled"])]),a(z,K({type:"success"},O,{onClick:ye,disabled:Ue.value,loading:Me.value,class:"w-full"}),{default:s(()=>[...r[17]||(r[17]=[w(" 开始转码 ",-1)])]),_:1},16,["disabled","loading"])]),l("div",fs,[r[20]||(r[20]=l("div",{class:"flex items-center justify-between"},[l("h4",{class:"text-sm font-semibold"},"输出目录名称")],-1)),l("div",vs,[a(Te,{modelValue:S.value,"onUpdate:modelValue":r[1]||(r[1]=y=>S.value=y),placeholder:"输出目录名称",size:"small",disabled:de.value,onBlur:re},null,8,["modelValue","disabled"]),a(z,K({type:"primary"},te,{disabled:de.value||!V.value,onClick:ae}),{default:s(()=>[...r[18]||(r[18]=[w(" 保存 ",-1)])]),_:1},16,["disabled"])]),l("div",ps,[r[19]||(r[19]=l("span",null,"文件将保存在转码目录下的此文件夹中",-1)),e.value?.directory&&e.value?.output_dir?(i(),R(we,{key:0,content:`${e.value.directory}/${e.value.output_dir}`,placement:"top"},{default:s(()=>[a(F,{class:"cursor-help text-gray-400 hover:text-gray-600"},{default:s(()=>[a(B(Et))]),_:1})]),_:1},8,["content"])):U("",!0)])]),e.value.status==="processing"||e.value.progress?(i(),v("div",ms,[r[21]||(r[21]=l("h4",{class:"text-sm font-semibold"},"转码进度",-1)),e.value.progress?(i(),v("div",gs,[l("div",_s," 已处理: "+T(e.value.progress.processed??0)+" / "+T(e.value.total_files??e.value.progress.total??0),1),a(Ee,{percentage:(e.value.total_files??e.value.progress.total??0)>0?Math.round((e.value.progress.processed??0)/(e.value.total_files??e.value.progress.total??1)*100):0,status:e.value.status==="processing"?void 0:"success"},null,8,["percentage","status"]),e.value.progress.current_file?(i(),v("div",{key:0,class:"text-xs text-gray-500 truncate",title:e.value.progress.current_file}," 正在处理: "+T(e.value.progress.current_file),9,xs)):U("",!0)])):(i(),v("div",ys,"等待开始转码..."))])):U("",!0),e.value.status==="success"?(i(),v("div",hs,[r[23]||(r[23]=l("h4",{class:"text-sm font-semibold"},"转码结果",-1)),l("div",bs,[r[22]||(r[22]=l("div",null,"转码完成！所有文件已保存到输出目录",-1)),e.value.progress?(i(),v("div",ks," 共转换 "+T(e.value.total_files??e.value.progress.total??0)+" 个文件 ",1)):U("",!0)])])):U("",!0)])])):(i(),v("div",ws,[...r[25]||(r[25]=[l("h3",{class:"text-base font-semibold mb-3"},"输出信息",-1),l("div",{class:"flex-1 flex items-center justify-center text-sm text-gray-400"}," 请从左侧选择一个任务查看输出信息 ",-1)])])),a(et,{visible:N.value,"onUpdate:visible":r[2]||(r[2]=y=>N.value=y),title:"选择转码目录","confirm-button-text":"确定",mode:"directory","default-path":e.value?.directory||void 0,"confirm-loading":c.value,onConfirm:h,onClose:H},null,8,["visible","default-path","confirm-loading"]),a(Le,{modelValue:$.value,"onUpdate:modelValue":r[5]||(r[5]=y=>$.value=y),title:"创建转码任务",width:"400px",onClose:r[6]||(r[6]=y=>j.value="")},{footer:s(()=>[a(z,{onClick:r[4]||(r[4]=y=>$.value=!1)},{default:s(()=>[...r[26]||(r[26]=[w("取消",-1)])]),_:1}),a(z,{type:"primary",onClick:q,loading:c.value},{default:s(()=>[...r[27]||(r[27]=[w(" 确定 ",-1)])]),_:1},8,["loading"])]),default:s(()=>[a(Be,null,{default:s(()=>[a(Ae,{label:"任务名称"},{default:s(()=>[a(Te,{modelValue:j.value,"onUpdate:modelValue":r[3]||(r[3]=y=>j.value=y),placeholder:"请输入任务名称",onKeyup:Ie(q,["enter"])},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(Le,{modelValue:Q.value,"onUpdate:modelValue":r[9]||(r[9]=y=>Q.value=y),title:"重命名任务",width:"400px",onClose:r[10]||(r[10]=y=>X.value="")},{footer:s(()=>[a(z,{onClick:r[8]||(r[8]=y=>Q.value=!1)},{default:s(()=>[...r[28]||(r[28]=[w("取消",-1)])]),_:1}),a(z,{type:"primary",onClick:le,loading:c.value},{default:s(()=>[...r[29]||(r[29]=[w(" 确定 ",-1)])]),_:1},8,["loading"])]),default:s(()=>[a(Be,null,{default:s(()=>[a(Ae,{label:"任务名称"},{default:s(()=>[a(Te,{modelValue:X.value,"onUpdate:modelValue":r[7]||(r[7]=y=>X.value=y),placeholder:"请输入任务名称",onKeyup:Ie(le,["enter"])},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),Cs={class:"flex gap-4 h-[calc(100vh-220px)]"},$s={class:"w-64 border rounded p-3 flex flex-col"},Ss={class:"flex items-center justify-between mb-3"},Ms={class:"flex items-center gap-1"},Ps={key:0,class:"flex-1 overflow-y-auto space-y-2 pr-1 min-h-[400px]"},Ds=["onClick"],Vs={class:"flex items-center justify-between gap-2"},Fs=["title"],Us={class:"flex items-center justify-between gap-2 min-h-[20px]"},Rs={class:"flex items-center gap-1 flex-shrink-0"},Es={key:1,class:"flex-1 flex items-center justify-center text-sm text-gray-400"},As={key:0,class:"flex-1 border rounded p-3 flex flex-col max-w-2xl"},Bs={class:"flex items-cente mb-3 flex-shrink-0"},Ls={class:"text-base font-semibold mr-2"},zs={class:"flex-1 overflow-auto flex flex-col gap-3"},js={class:"flex items-center gap-4 flex-shrink-0 flex-wrap"},Os={key:1,class:"text-xs text-gray-600 ml-auto"},Ns={class:"text-red-500 text-xs truncate max-w-xs inline-block cursor-help"},Is={class:"border rounded p-3 flex flex-col gap-2"},Ks={class:"flex items-center justify-between"},Ys={class:"flex items-center gap-2"},Gs={key:0,class:"flex items-center gap-2 mr-2"},qs=["onClick"],Hs=["src","alt"],Ws=["onClick"],Js={class:"border rounded p-3 flex flex-col gap-2"},Qs={class:"grid grid-cols-3 gap-3"},Xs={class:"flex flex-col gap-1"},Zs={class:"flex flex-col gap-1"},en={class:"flex flex-col gap-1"},tn={class:"border rounded p-3 flex flex-col gap-2 flex-shrink-0"},ln={key:1,class:"flex-1 border rounded p-3 flex flex-col max-w-2xl"},an={class:"flex items-center justify-center min-h-[400px]"},sn=["src","alt"],nn={class:"flex items-center justify-between w-full"},on={class:"flex items-center gap-2"},rn={class:"text-sm text-gray-600"},un=Ke({__name:"TTS",setup(Ne){const c=b(!1),P=b([]),e=b(null),N=b(!1),S=b(""),V=b(""),E=b(!1),C=b(""),$=b(""),j=b("cosyvoice-v3-plus-leo-34ba9eaebae44039a4a9426af6389dcd"),Q=b(.8),X=b(50),Y=b(!1),te=b(null),O=b([]),A=b(new Map),me=b(!1),q=b(!1),L=b(-1),le=yt({callbacks:{onPlay:()=>{d.success("开始播放")},onError:()=>{M(new Error("音频播放失败"),"播放失败"),ue()},onEnded:()=>{ue()}}}),J={size:"small",plain:!0,class:"!w-8 !h-6 !p-0"},m={size:"small",plain:!0,class:"!h-5 !text-xs !px-2"},p={size:"small",plain:!0,class:"!h-7 !text-xs"},h=async()=>{try{c.value=!0;const n=await ul();n.code===0?(P.value=n.data||[],P.value.length>0&&!e.value&&await G(P.value[0].task_id)):d.error(n.msg||"获取任务列表失败")}catch(n){M(n,"获取任务列表失败")}finally{c.value=!1}},H=()=>{const n=new Date,t=n.getFullYear(),k=String(n.getMonth()+1).padStart(2,"0"),x=String(n.getDate()).padStart(2,"0"),ee=String(n.getHours()).padStart(2,"0"),oe=String(n.getMinutes()).padStart(2,"0"),ve=String(n.getSeconds()).padStart(2,"0");S.value=`${t}-${k}-${x} ${ee}:${oe}:${ve}`,V.value="",N.value=!0},re=()=>{S.value=""},ae=async()=>{try{c.value=!0;const n=await dl({text:"",name:S.value.trim()||void 0});n.code===0?(d.success("任务创建成功"),N.value=!1,S.value="",await h(),G(n.data.task_id)):d.error(n.msg||"创建任务失败")}catch(n){M(n,"创建任务失败")}finally{c.value=!1}},G=async n=>{e.value&&e.value.task_id!==n&&Pe();try{c.value=!0;const t=await cl(n);if(t.code===0){e.value=t.data;const k=P.value.findIndex(x=>x.task_id===n);k!==-1&&(P.value[k]={...t.data}),$.value=t.data.text||"",j.value=t.data.role?t.data.role:"cosyvoice-v3-plus-leo-34ba9eaebae44039a4a9426af6389dcd",Q.value=t.data.speed??.8,X.value=t.data.vol??50,Y.value=!1}else d.error(t.msg||"获取任务信息失败")}catch(t){M(t,"获取任务信息失败")}finally{c.value=!1}},Z=async n=>{if(await pe.confirm("确定要删除该任务吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>!1))try{c.value=!0;const k=await ml(n);k.code===0?(d.success("任务删除成功"),await h(),e.value&&e.value.task_id===n&&(P.value&&P.value.length>0?await G(P.value[0].task_id):e.value=null)):d.error(k.msg||"删除任务失败")}catch(k){M(k,"删除任务失败")}finally{c.value=!1}},ye=()=>{e.value&&(C.value=e.value.name,E.value=!0)},he=async()=>{if(e.value){if(!C.value.trim()){d.warning("请输入任务名称");return}try{c.value=!0;const n=await ut(e.value.task_id,{name:C.value.trim()});n.code===0?(d.success("任务名称修改成功"),E.value=!1,C.value="",await G(e.value.task_id)):d.error(n.msg||"修改任务名称失败")}catch(n){M(n,"修改任务名称失败")}finally{c.value=!1}}},fe=()=>{if(!e.value)return;const n=e.value.text||"";Y.value=$.value!==n,Y.value&&se()},ge=n=>{j.value=n,_()},_=()=>{if(!e.value)return;const n=e.value.role||null,t=e.value.speed??1,k=e.value.vol??50;Y.value=j.value!==n||Q.value!==t||X.value!==k,Y.value&&se()},se=async()=>{if(!(!e.value||!Y.value))try{c.value=!0;const n={},t=e.value.text||"";$.value!==t&&(n.text=$.value);const k=e.value.role||null;j.value!==k&&(n.role=j.value||void 0);const x=e.value.speed??1;Q.value!==x&&(n.speed=Q.value);const ee=e.value.vol??50;X.value!==ee&&(n.vol=X.value);const oe=await ut(e.value.task_id,n);oe.code===0?(Y.value=!1,await G(e.value.task_id)):d.error(oe.msg||"保存参数失败")}catch(n){M(n,"保存参数失败")}finally{c.value=!1}},Fe=async()=>{if(!e.value)return;if(!$.value.trim()){d.warning("请输入文本内容");return}if(Y.value&&await se(),!!await pe.confirm(`确定要开始生成任务 "${e.value.name}" 吗？`,"确认生成",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>!1))try{c.value=!0;const t=await fl(e.value.task_id);t.code===0?(d.success("TTS 任务已启动"),await G(e.value.task_id),await h(),await G(e.value.task_id),be()):d.error(t.msg||"启动任务失败")}catch(t){M(t,"启动任务失败")}finally{c.value=!1}},Me=async()=>{if(!(!e.value||!await pe.confirm("确定要停止生成吗？","确认停止",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>!1)))try{c.value=!0;const t=await vl(e.value.task_id);t.code===0?(d.success("任务已停止"),await h(),await G(e.value.task_id)):d.error(t.msg||"停止任务失败")}catch(t){M(t,"停止任务失败")}finally{c.value=!1}},{start:Ue,stop:de}=ot(async()=>{if(!e.value){de();return}if(await h(),e.value.status!=="processing"){await G(e.value.task_id),de();return}await G(e.value.task_id)},ht,{immediate:!1}),be=()=>{Ue()},ke=async()=>{if(e.value?.output_file)try{const n=dt(e.value.task_id),t=await fetch(n);if(!t.ok){d.error("下载失败");return}const k=await t.blob(),x=URL.createObjectURL(k),ee=e.value.output_file,oe=ee.includes(".")?"."+ee.split(".").pop():"",ze=`${e.value.name||"tts_output"}${oe}`,xe=document.createElement("a");xe.href=x,xe.download=ze,document.body.appendChild(xe),xe.click(),document.body.removeChild(xe),URL.revokeObjectURL(x)}catch(n){M(n,"下载失败")}},ie=async n=>{if(n?.output_file)try{const t=dt(n.task_id),k=await fetch(t);if(!k.ok){d.error("下载失败");return}const x=await k.blob(),ee=URL.createObjectURL(x),oe=n.output_file,ve=oe.includes(".")?"."+oe.split(".").pop():"",xe=`${n.name||"tts_output"}${ve}`,$e=document.createElement("a");$e.href=ee,$e.download=xe,document.body.appendChild($e),$e.click(),document.body.removeChild($e),URL.revokeObjectURL(ee)}catch(t){M(t,"下载失败")}},ue=()=>{le.clear()},Pe=()=>{ue()},Re=()=>{if(!e.value||!e.value.output_file){d.warning("结果文件不存在");return}const n=e.value.output_file;if(le.playingFilePath.value===n&&le.audio&&!le.audio.paused){ue(),d.info("已停止播放");return}const t=Xe(n);if(!t){d.error("无法生成媒体文件URL");return}le.load(t,{playingFilePath:n}),le.play().catch(k=>{M(k,"播放失败"),ue()})},f=(n,t)=>{e.value?.output_file&&r({path:e.value.output_file},t)},r=(n,t)=>{if(!n)return;const k=n?.path||n?.name||"";le.seekFile(k,t)},F={pending:{tag:"info",text:"等待中"},processing:{tag:"warning",text:"处理中"},success:{tag:"success",text:"成功"},failed:{tag:"danger",text:"失败"}},z=n=>F[n]?.tag||"info",_e=n=>F[n]?.text||"未知",we=()=>{te.value?.click()},De=n=>{const k=n.target.files;if(k&&k.length>0){const x=Array.from(k);x.forEach((ee,oe)=>{const ve=O.value.length+oe,ze=URL.createObjectURL(ee);A.value.set(ve,ze)}),O.value.push(...x)}},Te=n=>{if(A.value.has(n))return A.value.get(n);if(n>=0&&n<O.value.length){const t=URL.createObjectURL(O.value[n]);return A.value.set(n,t),t}return""},Ee=n=>{if(n<0||n>=O.value.length)return;A.value.has(n)&&(URL.revokeObjectURL(A.value.get(n)),A.value.delete(n)),L.value===n?(q.value=!1,L.value=-1):L.value>n&&L.value--;const t=new Map;O.value.forEach((k,x)=>{if(x!==n){const ee=(x>n,x);A.value.has(ee)&&t.set(x>n?x-1:x,A.value.get(ee))}}),A.value=t,O.value.splice(n,1),te.value&&(te.value.value="")},Ae=n=>{L.value=n,q.value=!0},Be=()=>{L.value>0&&L.value--},Le=()=>{L.value<O.value.length-1&&L.value++},y=W(()=>L.value>=0&&O.value[L.value]?O.value[L.value].name:"图片预览"),o=async()=>{if(O.value.length===0){d.warning("请先选择图片");return}try{me.value=!0;const n=await pl(O.value);if(n.code===0&&n.data?.text){const t=n.data.text.trim();t?($.value?$.value+=`

`+t:$.value=t,fe(),d.success("OCR 识别成功，文本已追加"),O.value=[],te.value&&(te.value.value="")):d.warning("识别结果为空")}else d.error(n.msg||"OCR 识别失败")}catch(n){M(n,"OCR 识别失败")}finally{me.value=!1}},u=W(()=>e.value?.status==="processing"),g=W(()=>!$.value.trim()||u.value),I=W(()=>!e.value?.output_file||e.value.status!=="success"),ne=W(()=>e.value?.output_file?{path:e.value.output_file,name:e.value.output_file.split("/").pop()||"output.mp3"}:null),Ce=W(()=>ne.value?{path:ne.value.path,name:ne.value.name}:null);return Ge(()=>{h()}),tt(()=>{de(),ue(),A.value.forEach(n=>{URL.revokeObjectURL(n)}),A.value.clear()}),(n,t)=>{const k=Je,x=qe,ee=He,oe=nt,ve=lt,ze=Lt,xe=Bt,$e=zt,rt=_t,it=gt,Qe=mt;return i(),v("div",Cs,[l("div",$s,[l("div",Ss,[t[14]||(t[14]=l("h3",{class:"text-base font-semibold"},"任务列表",-1)),l("div",Ms,[a(x,K({type:"info"},J,{onClick:h,loading:c.value}),{default:s(()=>[c.value?U("",!0):(i(),R(k,{key:0},{default:s(()=>[a(B(We))]),_:1}))]),_:1},16,["loading"]),a(x,K({type:"success"},J,{onClick:H,loading:c.value}),{default:s(()=>[c.value?U("",!0):(i(),R(k,{key:0},{default:s(()=>[a(B(at))]),_:1}))]),_:1},16,["loading"])])]),P.value&&P.value.length>0?(i(),v("div",Ps,[(i(!0),v(Se,null,Oe(P.value,D=>(i(),v("div",{key:D.task_id,class:je(["border rounded px-3 py-2 cursor-pointer hover:bg-gray-50 group min-h-[60px] flex flex-col justify-between",{"border-blue-500 bg-blue-50":e.value&&D.task_id===e.value.task_id}]),onClick:Ve=>G(D.task_id)},[l("div",Vs,[l("div",{class:"text-sm font-medium truncate flex-1 min-w-0",title:D.name},T(D.name),9,Fs)]),l("div",Us,[a(ee,{type:z(D.status),size:"small",class:"!h-5 !text-xs w-16 text-center"},{default:s(()=>[w(T(_e(D.status)),1)]),_:2},1032,["type"]),l("div",Rs,[D.status==="success"&&D.output_file?(i(),R(x,K({key:0,type:"primary"},{ref_for:!0},m,{onClick:ce(Ve=>ie(D),["stop"])}),{default:s(()=>[...t[15]||(t[15]=[w(" 下载 ",-1)])]),_:1},16,["onClick"])):U("",!0),a(x,K({type:"danger"},{ref_for:!0},m,{onClick:ce(Ve=>Z(D.task_id),["stop"]),disabled:D.status==="processing"}),{default:s(()=>[a(k,null,{default:s(()=>[a(B(st))]),_:1})]),_:1},16,["onClick","disabled"])])])],10,Ds))),128))])):(i(),v("div",Es,' 暂无任务，请点击"新建"创建 '))]),e.value?(i(),v("div",As,[l("div",Bs,[l("h3",Ls,"任务详情: "+T(e.value.name),1),a(x,{type:"default",size:"small",plain:"",circle:"",disabled:u.value,onClick:ye,title:"编辑名称"},{default:s(()=>[a(k,null,{default:s(()=>[a(B(vt))]),_:1})]),_:1},8,["disabled"])]),l("div",zs,[l("div",js,[a(ee,{type:z(e.value.status),size:"small",class:"w-16 text-center"},{default:s(()=>[w(T(_e(e.value.status)),1)]),_:1},8,["type"]),Ce.value?(i(),R(Ze,{key:0,file:Ce.value,player:B(le),disabled:u.value,onPlay:Re,onSeek:f},null,8,["file","player","disabled"])):U("",!0),a(x,K({type:"primary"},p,{onClick:ke,disabled:I.value}),{default:s(()=>[...t[16]||(t[16]=[w(" 下载 ",-1)])]),_:1},16,["disabled"]),e.value.total_chars!==void 0?(i(),v("span",Os,[u.value&&e.value.generated_chars!==void 0?(i(),v(Se,{key:0},[w(T(e.value.generated_chars)+" / "+T(e.value.total_chars),1)],64)):(i(),v(Se,{key:1},[w(T(e.value.total_chars),1)],64))])):U("",!0),e.value.error_message?(i(),R(oe,{key:2,content:`错误: ${e.value.error_message}`,placement:"top",class:"w-full"},{default:s(()=>[l("span",Ns," 错误: "+T(e.value.error_message),1)]),_:1},8,["content"])):U("",!0)]),l("div",Is,[l("div",Ks,[t[18]||(t[18]=l("h4",{class:"h-8 text-sm font-semibold"},"文本内容",-1)),l("div",Ys,[O.value.length>0?(i(),v("div",Gs,[(i(!0),v(Se,null,Oe(O.value,(D,Ve)=>(i(),v("div",{key:Ve,class:"relative group cursor-pointer",onClick:bt=>Ae(Ve)},[l("img",{src:Te(Ve),alt:D.name,class:"w-8 h-8 object-cover rounded border border-gray-300 hover:border-blue-500 transition-colors"},null,8,Hs),l("div",{class:"absolute -right-1 -top-1 w-4 h-4 bg-red-500 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",onClick:ce(bt=>Ee(Ve),["stop"])},[a(k,{class:"text-white text-xs"},{default:s(()=>[a(B(pt))]),_:1})],8,Ws)],8,qs))),128))])):U("",!0),l("input",{ref_key:"imageInputRef",ref:te,type:"file",accept:"image/*",multiple:"",onChange:De,class:"hidden"},null,544),a(x,{type:"default",size:"small",onClick:we,disabled:u.value,class:"!p-0"},{default:s(()=>[a(k,{class:"!w-7 !h-6"},{default:s(()=>[a(B(At),{class:"!w-5 !h-5"})]),_:1})]),_:1},8,["disabled"]),a(x,{type:"primary",size:"small",onClick:o,disabled:u.value||O.value.length===0,loading:me.value},{default:s(()=>[...t[17]||(t[17]=[w(" 识别 ",-1)])]),_:1},8,["disabled","loading"])])]),a(ve,{modelValue:$.value,"onUpdate:modelValue":t[0]||(t[0]=D=>$.value=D),type:"textarea",rows:6,placeholder:"请输入要转换为语音的文本",disabled:u.value,onBlur:fe},null,8,["modelValue","disabled"])]),l("div",Js,[t[22]||(t[22]=l("h4",{class:"text-sm font-semibold"},"参数设置",-1)),l("div",Qs,[l("div",Xs,[t[19]||(t[19]=l("label",{class:"text-xs text-gray-600"},"发音人/音色",-1)),a(xe,{modelValue:j.value,"onUpdate:modelValue":t[1]||(t[1]=D=>j.value=D),size:"small",placeholder:"请选择音色（可选）",clearable:"",disabled:u.value,onChange:ge,class:"w-full"},{default:s(()=>[a(ze,{label:"灿灿",value:"cosyvoice-v3-plus-leo-34ba9eaebae44039a4a9426af6389dcd"})]),_:1},8,["modelValue","disabled"])]),l("div",Zs,[t[20]||(t[20]=l("label",{class:"text-xs text-gray-600"},"语速",-1)),a($e,{modelValue:Q.value,"onUpdate:modelValue":t[2]||(t[2]=D=>Q.value=D),size:"small",min:.5,max:2,step:.1,precision:1,disabled:u.value,onChange:_,class:"w-full"},null,8,["modelValue","disabled"])]),l("div",en,[t[21]||(t[21]=l("label",{class:"text-xs text-gray-600"},"音量",-1)),a($e,{modelValue:X.value,"onUpdate:modelValue":t[3]||(t[3]=D=>X.value=D),size:"small",min:0,max:100,step:1,disabled:u.value,onChange:_,class:"w-full"},null,8,["modelValue","disabled"])])])]),l("div",tn,[u.value?(i(),R(x,K({key:1,type:"warning"},p,{onClick:Me,class:"w-full"}),{default:s(()=>[...t[24]||(t[24]=[w(" 停止生成 ",-1)])]),_:1},16)):(i(),R(oe,{key:0,content:$.value.trim()?"":"请先输入文本内容",disabled:!!$.value.trim(),placement:"top"},{default:s(()=>[a(x,K({type:"success"},p,{onClick:Fe,disabled:g.value,class:"w-full"}),{default:s(()=>[...t[23]||(t[23]=[w(" 开始生成 ",-1)])]),_:1},16,["disabled"])]),_:1},8,["content","disabled"]))])])])):(i(),v("div",ln,[...t[25]||(t[25]=[l("div",{class:"flex items-center justify-between mb-3 flex-shrink-0"},[l("h3",{class:"text-base font-semibold"},"任务详情")],-1),l("div",{class:"flex-1 flex items-center justify-center text-sm text-gray-400"}," 请从左侧选择一个任务查看详情 ",-1)])])),a(Qe,{modelValue:N.value,"onUpdate:modelValue":t[6]||(t[6]=D=>N.value=D),title:"创建 TTS 任务",width:"500px",onClose:re},{footer:s(()=>[a(x,{onClick:t[5]||(t[5]=D=>N.value=!1)},{default:s(()=>[...t[26]||(t[26]=[w("取消",-1)])]),_:1}),a(x,{type:"primary",onClick:ae,loading:c.value},{default:s(()=>[...t[27]||(t[27]=[w(" 确定 ",-1)])]),_:1},8,["loading"])]),default:s(()=>[a(it,null,{default:s(()=>[a(rt,{label:"任务名称"},{default:s(()=>[a(ve,{modelValue:S.value,"onUpdate:modelValue":t[4]||(t[4]=D=>S.value=D),placeholder:"请输入任务名称",onKeyup:Ie(ae,["enter"])},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(Qe,{modelValue:E.value,"onUpdate:modelValue":t[9]||(t[9]=D=>E.value=D),title:"重命名任务",width:"400px",onClose:t[10]||(t[10]=D=>C.value="")},{footer:s(()=>[a(x,{onClick:t[8]||(t[8]=D=>E.value=!1)},{default:s(()=>[...t[28]||(t[28]=[w("取消",-1)])]),_:1}),a(x,{type:"primary",onClick:he,loading:c.value},{default:s(()=>[...t[29]||(t[29]=[w(" 确定 ",-1)])]),_:1},8,["loading"])]),default:s(()=>[a(it,null,{default:s(()=>[a(rt,{label:"任务名称"},{default:s(()=>[a(ve,{modelValue:C.value,"onUpdate:modelValue":t[7]||(t[7]=D=>C.value=D),placeholder:"请输入任务名称",onKeyup:Ie(he,["enter"])},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(Qe,{modelValue:q.value,"onUpdate:modelValue":t[12]||(t[12]=D=>q.value=D),title:y.value,width:"90%","align-center":"",onClose:t[13]||(t[13]=D=>L.value=-1)},{footer:s(()=>[l("div",nn,[l("div",on,[a(x,{onClick:Be,disabled:L.value<=0,size:"small"},{default:s(()=>[...t[30]||(t[30]=[w(" 上一张 ",-1)])]),_:1},8,["disabled"]),l("span",rn,T(L.value+1)+" / "+T(O.value.length),1),a(x,{onClick:Le,disabled:L.value>=O.value.length-1,size:"small"},{default:s(()=>[...t[31]||(t[31]=[w(" 下一张 ",-1)])]),_:1},8,["disabled"])]),a(x,{type:"danger",onClick:t[11]||(t[11]=D=>Ee(L.value)),size:"small"},{default:s(()=>[...t[32]||(t[32]=[w(" 删除 ",-1)])]),_:1})])]),default:s(()=>[l("div",an,[L.value>=0&&O.value[L.value]?(i(),v("img",{key:0,src:Te(L.value),alt:O.value[L.value].name,class:"max-w-full max-h-[70vh] object-contain"},null,8,sn)):U("",!0)])]),_:1},8,["modelValue","title"])])}}}),dn={class:"p-1"},kn=Ke({__name:"index",setup(Ne){const c=b("tts_tool"),P=e=>{console.log("切换到页签:",e)};return(e,N)=>{const S=Ot,V=jt;return i(),v("div",dn,[a(V,{modelValue:c.value,"onUpdate:modelValue":N[0]||(N[0]=E=>c.value=E),onTabChange:P,class:"flex-1 flex flex-col overflow-hidden h-[calc(100vh-150px)]"},{default:s(()=>[a(S,{label:"TTS",name:"tts_tool"},{default:s(()=>[a(un)]),_:1}),a(S,{label:"PDF 工具",name:"pdf_tool"},{default:s(()=>[a(Nl)]),_:1}),a(S,{label:"音频合成",name:"audio_merge"},{default:s(()=>[a($a)]),_:1}),a(S,{label:"音频转码",name:"audio_convert"},{default:s(()=>[a(Ts)]),_:1})]),_:1},8,["modelValue"])])}}});export{kn as default};
