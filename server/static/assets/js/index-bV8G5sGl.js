import{m as ne,r as S,A as he,t as m,q as c,O as n,a1 as i,M as R,Q as d,ae as C,W as w,Z as Ke,o as B,u as $,au as We,bK as xe,aJ as Ge,c as E,D as Qe,v as z,aW as Je,N as pe,ao as ve,P as _e,bh as Ze,S as N,bi as He,b9 as Xe,aU as ea}from"./vue-vendor-DxceCm8D.js";import{b as be,u as aa,d as ta,M as me,_ as ge,g as ye}from"./useInterval-_JCymJaY.js";import{b as T,e as b}from"./index-DBu4nike.js";import{d as we,z as sa,j as la,v as na,s as oa,Q as ke,m as ia,q as ra,g as Te,E as r,T as K,U as da,V as ua}from"./element-plus-BqLbxx0O.js";import"./utils-C11zrYka.js";import"./vant-DyMlv9MZ.js";import"./vendor-DiwfJ622.js";async function ca(){return(await T.get("/pdf/list")).data}async function fa(f){const s=new FormData;return s.append("file",f),(await T.post("/pdf/upload",s,{headers:{"Content-Type":"multipart/form-data"}})).data}async function pa(f,s){const g={filename:f};return s!=null&&(g.password=s),(await T.post("/pdf/decrypt",g)).data}function va(f,s){return`${T.defaults.baseURL||""}/pdf/download/${encodeURIComponent(f)}?type=${s}`}async function _a(f,s="both"){return(await T.post("/pdf/delete",{filename:f,type:s})).data}const ma={class:"p-4 flex flex-col h-full"},ga={class:"mb-4 flex-shrink-0 border rounded p-3 bg-gray-50"},ya={class:"flex items-center gap-3"},ha={key:0,class:"flex-1 min-w-0"},xa=["title"],ba={class:"flex items-center justify-between"},wa={class:"flex-1 overflow-auto"},ka=["onClick"],Ta={key:1,class:"text-gray-400"},Ma={key:0,class:"flex flex-col gap-1"},Ca={class:"text-sm"},Fa={class:"text-xs text-gray-500"},Da={key:1,class:"text-gray-400"},Pa={key:0,class:"flex flex-col gap-1"},$a={class:"text-sm"},Sa={class:"text-xs text-gray-500"},Ba={key:1,class:"text-gray-400"},La={class:"flex flex-col gap-1 items-center"},Ua=["onClick"],Ea={class:"flex items-center gap-2"},Ra=ne({__name:"PdfTool",setup(f){const s=S(!1),g=S([]),a=S(null),D=S(""),M=async()=>{try{s.value=!0;const u=await ca();if(u.code===0){const o=u.data.files||[];g.value=o.map(_=>({..._,_decrypting:_._decrypting||!1,_password:_._password!==void 0?_._password:""}))}else r.error(u.msg||"获取文件列表失败")}catch(u){b(u,"获取文件列表失败")}finally{s.value=!1}},x=u=>{u.raw&&(a.value=u.raw,D.value=u.raw.name)},V=async()=>{if(!a.value){r.warning("请选择要上传的文件");return}const u=a.value;if(!u.name.toLowerCase().endsWith(".pdf")){r.error("只支持 PDF 文件");return}try{s.value=!0;const o=await fa(u);o.code===0?(r.success("文件上传成功"),a.value=null,D.value="",await M()):r.error(o.msg||"文件上传失败")}catch(o){b(o,"文件上传失败")}finally{s.value=!1}},h=async u=>{if(!u.uploaded){r.warning("请先上传文件");return}if(!u._decrypting&&!(u.has_unlocked&&!await K.confirm("已解密的文件已存在，是否重新解密？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>!1)))try{u._decrypting=!0;const o={filename:u.uploaded.name};u._password!==void 0&&u._password!==null&&(o.password=u._password);const _=await pa(o.filename,o.password);_.code===0?(r.success("文件解密成功"),u._password="",await M()):_.msg&&_.msg.includes("密码")?r.error(_.msg||"密码错误，请重试"):r.error(_.msg||"文件解密失败")}catch(o){b(o,"文件解密失败")}finally{u._decrypting=!1}},I=async(u,o)=>{const _=u[o];if(!_){r.warning("文件不存在");return}try{const P=va(_.name,o);window.open(P,"_blank")}catch(P){b(P,"下载文件失败")}},Y=async u=>{if(!u.uploaded){r.warning("请先上传文件");return}if(await K.confirm("确定要删除该文件吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>!1))try{s.value=!0;const _=await _a(u.uploaded.name,"both");_.code===0?(r.success("文件删除成功"),await M()):r.error(_.msg||"文件删除失败")}catch(_){b(_,"删除文件失败")}finally{s.value=!1}},O=be,W=u=>u?new Date(u*1e3).toLocaleString():"-";return he(()=>{M()}),(u,o)=>{const _=we,P=sa,J=Te,k=oa,G=ke,Z=ia,H=ra,X=la,ee=na;return c(),m("div",ma,[o[9]||(o[9]=n("h2",{class:"text-xl font-semibold mb-4"},"PDF 解密工具",-1)),n("div",ga,[n("div",ya,[n("div",null,[i(_,{type:"success",size:"small",onClick:V,loading:s.value,disabled:!a.value},{default:d(()=>[...o[0]||(o[0]=[C(" 上传 ",-1)])]),_:1},8,["loading","disabled"])]),i(P,{"auto-upload":!1,"on-change":x,"show-file-list":!1,accept:".pdf"},{trigger:d(()=>[i(_,{type:"primary",size:"small",class:"!m-0"},{default:d(()=>[...o[1]||(o[1]=[C("选择文件",-1)])]),_:1})]),_:1}),a.value?(c(),m("div",ha,[n("div",{class:"text-sm text-gray-600 truncate",title:D.value||a.value.name},w(D.value||a.value.name),9,xa)])):R("",!0)])]),i(X,{class:"flex-1 flex flex-col overflow-hidden",shadow:"hover"},{header:d(()=>[n("div",ba,[o[3]||(o[3]=n("span",null,"文件列表",-1)),i(_,{type:"info",size:"small",plain:"",onClick:M,loading:s.value},{default:d(()=>[s.value?R("",!0):(c(),B(J,{key:0},{default:d(()=>[i($(xe))]),_:1})),o[2]||(o[2]=C(" 刷新 ",-1))]),_:1},8,["loading"])])]),default:d(()=>[n("div",wa,[Ke((c(),B(H,{data:g.value,stripe:"",class:"w-full"},{empty:d(()=>[...o[8]||(o[8]=[n("div",{class:"text-center text-gray-400 py-8"},"暂无文件，请上传 PDF 文件",-1)])]),default:d(()=>[i(k,{prop:"uploaded.name",label:"文件名","min-width":"200"},{default:d(({row:p})=>[p.uploaded?(c(),m("span",{key:0,class:"text-blue-600 cursor-pointer hover:underline",onClick:A=>I(p,"uploaded")},w(p.uploaded.name),9,ka)):(c(),m("span",Ta,"-"))]),_:1}),i(k,{label:"上传文件","min-width":"150"},{default:d(({row:p})=>[p.uploaded?(c(),m("div",Ma,[n("span",Ca,w($(O)(p.uploaded.size)),1),n("span",Fa,w(W(p.uploaded.modified)),1)])):(c(),m("span",Da,"-"))]),_:1}),i(k,{label:"已解密文件","min-width":"150"},{default:d(({row:p})=>[p.unlocked?(c(),m("div",Pa,[n("span",$a,w($(O)(p.unlocked.size)),1),n("span",Sa,w(W(p.unlocked.modified)),1)])):(c(),m("span",Ba,"未解密"))]),_:1}),i(k,{label:"状态",width:"120",align:"center"},{default:d(({row:p})=>[n("div",La,[p.has_unlocked?(c(),B(G,{key:0,type:"success",size:"small"},{default:d(()=>[...o[4]||(o[4]=[C("已解密",-1)])]),_:1})):(c(),B(G,{key:1,type:"info",size:"small"},{default:d(()=>[...o[5]||(o[5]=[C("未解密",-1)])]),_:1})),p.unlocked?(c(),m("span",{key:2,class:"text-xs text-blue-600 cursor-pointer hover:underline",onClick:A=>I(p,"unlocked")}," 下载 ",8,Ua)):R("",!0)])]),_:1}),i(k,{label:"操作",width:"280",fixed:"right"},{default:d(({row:p})=>[n("div",Ea,[p.uploaded?(c(),B(Z,{key:0,modelValue:p._password,"onUpdate:modelValue":A=>p._password=A,type:"password",size:"small",placeholder:"密码（可选）","show-password":"",clearable:"",class:"w-30",disabled:p._decrypting,onKeyup:We(A=>h(p),["enter"])},null,8,["modelValue","onUpdate:modelValue","disabled","onKeyup"])):R("",!0),p.uploaded?(c(),B(_,{key:1,type:"primary",size:"small",onClick:A=>h(p),loading:p._decrypting,disabled:p._decrypting},{default:d(()=>[...o[6]||(o[6]=[C(" 解密 ",-1)])]),_:1},8,["onClick","loading","disabled"])):R("",!0),p.uploaded?(c(),B(_,{key:2,type:"danger",size:"small",plain:"",onClick:A=>Y(p)},{default:d(()=>[...o[7]||(o[7]=[C(" 删除 ",-1)])]),_:1},8,["onClick"])):R("",!0)])]),_:1})]),_:1},8,["data"])),[[ee,s.value]])])]),_:1})])}}}),za={viewBox:"0 0 512 512",width:"1.2em",height:"1.2em"};function Aa(f,s){return c(),m("svg",za,[...s[0]||(s[0]=[n("path",{fill:"none",stroke:"currentColor","stroke-linecap":"square","stroke-width":"48",d:"m136 208l120-104l120 104m-240 96l120 104l120-104"},null,-1)])])}const Va=Ge({name:"ion-chevron-expand-sharp",render:Aa}),ja=2e3;async function Na(){return(await T.get("/media/task/list")).data}async function Ia(){return(await T.post("/media/task/create",{})).data}async function Oa(f){return(await T.post("/media/task/get",{task_id:f})).data}async function Ya(f){return(await T.post("/media/task/delete",{task_id:f})).data}async function qa(f,s){return(await T.post("/media/task/addFileByPath",{task_id:f,file_path:s})).data}async function Ka(f,s){return(await T.post("/media/task/deleteFile",{task_id:f,file_index:s})).data}async function Wa(f){return(await T.post("/media/task/start",{task_id:f})).data}async function Ga(f,s){return(await T.post("/media/task/reorderFiles",{task_id:f,file_indices:s})).data}function Qa(f){return`${T.defaults.baseURL||""}/media/task/download?task_id=${f}`}async function Ja(f,s){return(await T.post("/media/task/save",{task_id:f,target_path:s})).data}const Za={class:"flex gap-4 h-full"},Ha={class:"w-64 border rounded p-3 flex flex-col"},Xa={class:"flex items-center justify-between mb-3"},et={class:"flex items-center gap-1"},at={key:0,class:"flex-1 overflow-y-auto space-y-2 pr-1 min-h-[400px]"},tt=["onClick"],st={class:"flex items-center justify-between gap-2"},lt={class:"text-sm font-medium truncate flex-1 min-w-0"},nt={class:"text-xs text-gray-500 whitespace-nowrap flex items-center gap-1 flex-shrink-0"},ot={class:"whitespace-nowrap w-5 flex items-center justify-center"},it={class:"flex items-center justify-between gap-2 min-h-[20px]"},rt={class:"flex items-center gap-1 flex-shrink-0"},dt={key:1,class:"flex-1 flex items-center justify-center text-sm text-gray-400"},ut={key:0,class:"flex-1 border rounded p-3 flex flex-col max-w-2xl"},ct={class:"flex items-center justify-between mb-3 flex-shrink-0"},ft={class:"text-base font-semibold"},pt={class:"text-sm text-gray-500"},vt={class:"flex-1 overflow-auto flex flex-col gap-3"},_t={class:"flex items-center justify-between gap-4 flex-shrink-0"},mt={class:"flex items-center gap-4"},gt={key:1,class:"text-red-500 text-xs"},yt={class:"flex items-center gap-2"},ht={class:"border rounded p-2 flex-1 flex flex-col overflow-hidden"},xt={class:"flex items-center justify-between mb-2 flex-shrink-0"},bt={class:"flex items-center gap-1 pr-1"},wt={class:"flex-1 overflow-auto"},kt={key:0},Tt=["draggable","onDragstart","onDrop"],Mt={class:"text-xs text-gray-500 w-8"},Ct=["title"],Ft={key:0,class:"text-xs text-gray-500 whitespace-nowrap w-20 text-right"},Dt={key:1,class:"w-20"},Pt={key:1,class:"text-sm text-gray-400 text-center py-1"},$t={key:1,class:"flex-1 border rounded p-3 flex flex-col max-w-2xl"},St=ne({__name:"MediaTool",setup(f){const s=S(!1),g=S([]),a=S(null),D=S(!1),M=S(!1),x=S(!1),V=S(null),h=aa({callbacks:{onPlay:()=>{r.success("开始播放")},onError:()=>{b(new Error("音频播放失败"),"播放失败"),j()},onEnded:()=>{j()}}}),I={size:"small",plain:!0,class:"!w-8 !h-6 !p-0"},Y={size:"small",plain:!0,class:"!h-5 !text-xs !px-2"},O={size:"small",plain:!0,class:"!h-7 !text-xs"},W=["bg-gray-100","border-t-2","border-b-2","border-blue-500"],u=e=>{e&&e.classList.remove(...W)},o=e=>{if(!e)return;e.querySelectorAll('[draggable="true"]').forEach(l=>u(l))},_=async e=>{if(a.value&&e.length!==0)try{s.value=!0;for(const t of e){const l=await qa(a.value.task_id,t);if(l.code!==0){r.error(`添加文件失败: ${l.msg||"未知错误"}`);break}}r.success(`成功添加 ${e.length} 个文件`),await k(a.value.task_id)}catch(t){b(t,"添加文件失败")}finally{s.value=!1}},P=async()=>{try{s.value=!0;const e=await Na();e.code===0?(g.value=e.data.tasks||[],g.value.length>0&&!a.value&&await k(g.value[0].task_id)):r.error(e.msg||"获取任务列表失败")}catch(e){b(e,"获取任务列表失败")}finally{s.value=!1}},J=async()=>{try{s.value=!0;const e=await Ia();e.code===0?(r.success("任务创建成功"),await P(),k(e.data.task_id)):r.error(e.msg||"创建任务失败")}catch(e){b(e,"创建任务失败")}finally{s.value=!1}},k=async e=>{a.value&&a.value.task_id!==e&&ae();try{s.value=!0;const t=await Oa(e);t.code===0?a.value=t.data:r.error(t.msg||"获取任务信息失败")}catch(t){b(t,"获取任务信息失败")}finally{s.value=!1}},G=async e=>{if(await K.confirm("确定要删除该任务吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>!1))try{s.value=!0;const l=await Ya(e);l.code===0?(r.success("任务删除成功"),await P(),a.value&&a.value.task_id===e&&(g.value&&g.value.length>0?await k(g.value[0].task_id):a.value=null)):r.error(l.msg||"删除任务失败")}catch(l){b(l,"删除任务失败")}finally{s.value=!1}},Z=()=>{if(!a.value){r.warning("请先创建或选择任务");return}D.value=!0},H=async e=>{if(!(!a.value||!await K.confirm("确定要删除该文件吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>!1)))try{s.value=!0;const l=await Ka(a.value.task_id,e);l.code===0?(h.playingFileIndex.value===e?ae():h.playingFileIndex.value!==null&&h.playingFileIndex.value>e&&(h.playingFileIndex.value=h.playingFileIndex.value-1),r.success("文件删除成功"),await k(a.value.task_id)):r.error(l.msg||"删除文件失败")}catch(l){b(l,"删除文件失败")}finally{s.value=!1}},X=async()=>{if(!(!a.value||!await K.confirm(`确定要开始合成吗？将合并 ${ce.value} 个音频文件。`,"确认合成",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>!1)))try{s.value=!0;const t=await Wa(a.value.task_id);t.code===0?(r.success("合成任务已启动"),await P(),await k(a.value.task_id),A()):r.error(t.msg||"启动任务失败")}catch(t){b(t,"启动任务失败")}finally{s.value=!1}},{start:ee,stop:p}=ta(async()=>{if(!a.value||a.value.status!=="processing"){p();return}await P(),await k(a.value.task_id)},ja,{immediate:!1}),A=()=>{ee()},oe=e=>{if(!e)return;const t=Qa(e);window.open(t,"_blank")},Me=()=>{a.value?.result_file&&oe(a.value.task_id)},Ce=e=>{e?.result_file&&oe(e.task_id)},j=()=>{h.clear()},ie=(e,t)=>{if(!e)return;const l=e?.path||e?.name||"";h.seekFile(l,t)},Fe=(e,t)=>{a.value?.result_file&&ie({path:a.value.result_file},t)},De=e=>{if(!a.value||!a.value.files||e<0||e>=a.value.files.length)return;const t=a.value.files[e],l=t.path||t.name||"";if(!l){r.warning("文件路径不存在");return}if(h.playingFilePath.value===l&&h.audio&&!h.audio.paused){j(),r.info("已停止播放");return}const y=ye(l);if(!y){r.error("无法生成媒体文件URL");return}h.load(y,{playingFilePath:l,playingFileIndex:e}),h.play().catch(L=>{b(L,"播放失败"),j()})},ae=()=>{j()},Pe=()=>{if(!a.value||!a.value.result_file){r.warning("结果文件不存在");return}const e=a.value.result_file;if(h.playingFilePath.value===e&&h.audio&&!h.audio.paused){j(),r.info("已停止播放");return}const t=ye(e);if(!t){r.error("无法生成媒体文件URL");return}h.load(t,{playingFilePath:e}),h.play().catch(l=>{b(l,"播放失败"),j()})},$e=()=>{if(!a.value||!a.value.result_file){r.warning("结果文件不存在");return}M.value=!0},Se=async e=>{if(!a.value||!a.value.result_file)return;if(e.length===0){r.warning("请选择转存目录");return}const t=e[0];try{s.value=!0;const l=await Ja(a.value.task_id,t);l.code===0?(r.success("转存成功"),M.value=!1):r.error(l.msg||"转存失败")}catch(l){b(l,"转存失败")}finally{s.value=!1}},Be=be,re={pending:{tag:"info",text:"等待中"},processing:{tag:"warning",text:"处理中"},success:{tag:"success",text:"成功"},failed:{tag:"danger",text:"失败"}},de=e=>re[e]?.tag||"info",ue=e=>re[e]?.text||"未知",Q=E(()=>a.value?.status==="processing"),te=E(()=>(a.value?.files||[]).length>0),ce=E(()=>(a.value?.files||[]).length),se=E(()=>a.value?.result_file),fe=E(()=>!se.value||a.value?.status!=="success"||x.value),Le=E(()=>!te.value||Q.value||x.value),le=E(()=>Q.value||x.value),Ue=E(()=>!a.value||!te.value||Q.value),Ee=E(()=>x.value?"点击退出拖拽排序模式":"点击进入拖拽排序模式"),Re=E(()=>({path:se.value||""})),ze=(e,t)=>!e||!t||e.length!==t.length?!0:e.some((l,y)=>{const L=l?.path||l?.name,q=t[y]?.path||t[y]?.name;return L!==q}),Ae=async()=>{if(x.value){if(a.value&&a.value.files&&a.value.files.length>0){if(ze(V.value||[],a.value.files))try{s.value=!0;const t=a.value.files.map((y,L)=>L),l=await Ga(a.value.task_id,t);l.code===0?(r.success("排序已保存"),await k(a.value.task_id)):r.error(l.msg||"保存排序失败")}catch(t){b(t,"保存排序失败")}finally{s.value=!1}V.value=null}}else a.value&&a.value.files&&a.value.files.length>0&&(V.value=[...a.value.files||[]]);x.value=!x.value},Ve=(e,t)=>{if(!x.value)return e.preventDefault(),!1;try{e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",t.toString()))}catch(l){console.error("拖拽开始失败:",l)}},je=e=>{e.currentTarget&&u(e.currentTarget)},Ne=e=>{e.currentTarget&&u(e.currentTarget)},Ie=e=>{if(x.value&&(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.currentTarget)){const t=e.currentTarget.getBoundingClientRect(),l=e.clientY,y=t.top+t.height/2;u(e.currentTarget),l<y?e.currentTarget.classList.add("border-t-2","border-blue-500"):e.currentTarget.classList.add("border-b-2","border-blue-500")}},Oe=(e,t)=>{if(!x.value||(e.preventDefault(),e.currentTarget&&(u(e.currentTarget),o(e.currentTarget.parentElement)),!e.dataTransfer))return;const l=parseInt(e.dataTransfer.getData("text/plain"),10);if(l===t||isNaN(l)||!a.value||!a.value.files||l<0||l>=a.value.files.length||t<0||t>=a.value.files.length)return;const y=e.currentTarget?.getBoundingClientRect(),L=e.clientY,q=y?y.top+y.height/2:0,v=L<q?t:t+1,F=[...a.value.files||[]],[U]=F.splice(l,1),qe=l<v?v-1:v;F.splice(qe,0,U),a.value={...a.value,files:F}},Ye=()=>{D.value=!1};return he(()=>{P()}),Qe(()=>{ae(),p()}),(e,t)=>{const l=Te,y=we,L=ke,q=Va;return c(),m("div",Za,[n("div",Ha,[n("div",Xa,[t[7]||(t[7]=n("h3",{class:"text-base font-semibold"},"任务列表",-1)),n("div",et,[i(y,z({type:"info"},I,{onClick:P,loading:s.value}),{default:d(()=>[s.value?R("",!0):(c(),B(l,{key:0},{default:d(()=>[i($(xe))]),_:1}))]),_:1},16,["loading"]),i(y,z({type:"success"},I,{onClick:J,loading:s.value}),{default:d(()=>[i(l,null,{default:d(()=>[i($(Je))]),_:1})]),_:1},16,["loading"])])]),g.value&&g.value.length>0?(c(),m("div",at,[(c(!0),m(pe,null,ve(g.value,v=>(c(),m("div",{key:v.task_id,class:_e(["border rounded px-3 py-2 cursor-pointer hover:bg-gray-50 group min-h-[60px] flex flex-col justify-between",{"border-blue-500 bg-blue-50":a.value&&v.task_id===a.value.task_id}]),onClick:F=>k(v.task_id)},[n("div",st,[n("div",lt,w(v.name),1),n("span",nt,[i(l,null,{default:d(()=>[i($(Ze),{class:"!w-3 !h-3"})]),_:1}),n("span",ot,w(v.files?v.files.length:0),1)])]),n("div",it,[i(L,{type:de(v.status),size:"small",class:"!h-5 !text-xs w-16 text-center"},{default:d(()=>[C(w(ue(v.status)),1)]),_:2},1032,["type"]),n("div",rt,[v.status==="success"&&v.result_file?(c(),B(y,z({key:0,type:"primary"},{ref_for:!0},Y,{onClick:N(F=>Ce(v),["stop"])}),{default:d(()=>[...t[8]||(t[8]=[C(" 下载 ",-1)])]),_:1},16,["onClick"])):R("",!0),i(y,z({type:"danger"},{ref_for:!0},Y,{onClick:N(F=>G(v.task_id),["stop"]),disabled:v.status==="processing"}),{default:d(()=>[i(l,null,{default:d(()=>[i($(He))]),_:1})]),_:1},16,["onClick","disabled"])])])],10,tt))),128))])):(c(),m("div",dt,' 暂无任务，请点击"新建"创建 '))]),a.value?(c(),m("div",ut,[n("div",ct,[n("h3",ft,"任务详情: "+w(a.value.name),1),n("span",pt," 共 "+w(ce.value)+" 个文件 ",1)]),n("div",vt,[n("div",_t,[n("div",mt,[i(L,{type:de(a.value.status),size:"small",class:"w-16 text-center"},{default:d(()=>[C(w(ue(a.value.status)),1)]),_:1},8,["type"]),se.value?(c(),B(me,{key:0,file:Re.value,player:$(h),disabled:x.value,onPlay:Pe,onSeek:Fe},null,8,["file","player","disabled"])):R("",!0),i(y,z({type:"primary"},O,{onClick:Me,disabled:fe.value}),{default:d(()=>[...t[9]||(t[9]=[C(" 下载 ",-1)])]),_:1},16,["disabled"]),i(y,z({type:"success"},O,{onClick:$e,disabled:fe.value}),{default:d(()=>[...t[10]||(t[10]=[C(" 转存 ",-1)])]),_:1},16,["disabled"]),a.value.error_message?(c(),m("span",gt," 错误: "+w(a.value.error_message),1)):R("",!0)]),n("div",yt,[i(y,z({type:"success"},O,{onClick:X,disabled:Le.value,loading:Q.value}),{default:d(()=>[...t[11]||(t[11]=[C(" 开始合成 ",-1)])]),_:1},16,["disabled","loading"])])]),n("div",ht,[n("div",xt,[t[13]||(t[13]=n("h4",{class:"text-sm font-semibold"},"文件列表",-1)),n("div",bt,[i(y,z({type:"primary"},Y,{disabled:le.value,onClick:Z}),{default:d(()=>[...t[12]||(t[12]=[C(" + ",-1)])]),_:1},16,["disabled"]),i(y,z({type:x.value?"success":"default"},I,{onClick:Ae,disabled:Ue.value,title:Ee.value}),{default:d(()=>[x.value?(c(),B(l,{key:0},{default:d(()=>[i($(Xe))]),_:1})):(c(),B(q,{key:1,class:"!w-3.5 !h-3.5"}))]),_:1},16,["type","disabled","title"])])]),n("div",wt,[te.value?(c(),m("div",kt,[(c(!0),m(pe,null,ve(a.value.files,(v,F)=>(c(),m("div",{key:F,class:_e(["flex items-center gap-2 p-1 hover:bg-gray-100 rounded",{"cursor-move":x.value,"cursor-default":!x.value,"select-none":!0}]),draggable:x.value,onDragstart:U=>Ve(U,Number(F)),onDragend:t[2]||(t[2]=U=>je(U)),onDragover:t[3]||(t[3]=N(U=>Ie(U),["prevent"])),onDragleave:Ne,onDrop:N(U=>Oe(U,Number(F)),["prevent"])},[n("span",Mt,w(Number(F)+1),1),n("span",{class:"flex-1 text-sm truncate",title:v.path||v.name},w(v.name),9,Ct),v.size?(c(),m("span",Ft,w($(Be)(v.size)),1)):(c(),m("div",Dt)),n("div",{class:"flex items-center gap-1 flex-shrink-0",onMousedown:t[0]||(t[0]=N(()=>{},["stop"])),onClick:t[1]||(t[1]=N(()=>{},["stop"]))},[i(me,{file:v,player:$(h),disabled:le.value,onPlay:()=>De(Number(F)),onSeek:ie},null,8,["file","player","disabled","onPlay"]),i(y,{type:"info",size:"small",plain:"",circle:"",onClick:N(U=>H(Number(F)),["stop"]),disabled:le.value,class:"!h-6 !text-xs"},{default:d(()=>[i(l,null,{default:d(()=>[i($(ea))]),_:1})]),_:1},8,["onClick","disabled"])],32)],42,Tt))),128))])):(c(),m("div",Pt,"文件列表为空"))])])])])):(c(),m("div",$t,[...t[14]||(t[14]=[n("div",{class:"flex items-center justify-between mb-3 flex-shrink-0"},[n("h3",{class:"text-base font-semibold"},"任务详情")],-1),n("div",{class:"flex-1 flex items-center justify-center text-sm text-gray-400"}," 请从左侧选择一个任务查看详情 ",-1)])])),i(ge,{visible:D.value,"onUpdate:visible":t[4]||(t[4]=v=>D.value=v),title:"选择文件添加到任务","confirm-button-text":"添加","confirm-loading":s.value,onConfirm:_,onClose:Ye},null,8,["visible","confirm-loading"]),i(ge,{visible:M.value,"onUpdate:visible":t[5]||(t[5]=v=>M.value=v),title:"选择转存目录","confirm-button-text":"转存",mode:"directory","confirm-loading":s.value,onConfirm:Se,onClose:t[6]||(t[6]=v=>M.value=!1)},null,8,["visible","confirm-loading"])])}}}),Bt={class:"p-1"},jt=ne({__name:"index",setup(f){const s=S("pdf_tool"),g=a=>{console.log("切换到页签:",a)};return(a,D)=>{const M=ua,x=da;return c(),m("div",Bt,[i(x,{modelValue:s.value,"onUpdate:modelValue":D[0]||(D[0]=V=>s.value=V),onTabChange:g,class:"flex-1 flex flex-col overflow-hidden h-[calc(100vh-150px)]"},{default:d(()=>[i(M,{label:"PDF 工具",name:"pdf_tool"},{default:d(()=>[i(Ra)]),_:1}),i(M,{label:"音频合成",name:"audio_merge"},{default:d(()=>[i(St)]),_:1})]),_:1},8,["modelValue"])])}}});export{jt as default};
