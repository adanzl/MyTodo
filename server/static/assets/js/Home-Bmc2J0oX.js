import{s as B,a as L}from"./user-DIbMp7Ki.js";import{u as D}from"./index-DBu4nike.js";import{v as N,q as I,r as M,s as P,b as T,t as W,m as $,d as q,E as c}from"./element-plus-BqLbxx0O.js";import{m as O,c as _,r as z,A as F,t as f,Z as H,a1 as t,o as Q,Q as o,q as p,ae as m,O as w,M as Z,W as b}from"./vue-vendor-DxceCm8D.js";import"./utils-C11zrYka.js";import"./date-SVbh1ddk.js";import"./vant-DyMlv9MZ.js";import"./vendor-DiwfJ622.js";const j={class:""},G={key:0},J={class:"flex mt-4"},se=O({__name:"Home",setup(K){const n=D(),g=_(()=>n.userList),V=_(()=>n.loading),a=z({visible:!1,data:null,value:0}),i=async()=>{await n.refreshUserList()},h=async r=>{try{const e={id:r.id,score:r.score};await B(e.id,e.score),console.log("update user",e),await i()}catch(e){console.error("更新用户失败:",e),c.error("更新用户失败")}},y=r=>{a.value.visible=!0,a.value.data=r},C=async()=>{if(!a.value.data){c.warning("请选择用户");return}try{await L(a.value.data.id,"pcAdmin",a.value.value,"管理后台变更"),await i(),a.value.visible=!1,a.value.value=0}catch(r){console.error("添加积分失败:",r),c.error("添加积分失败")}},k=()=>{a.value.visible=!1,a.value.value=0};return F(async()=>{await i()}),(r,e)=>{const s=P,U=T,x=W,v=$,d=q,E=I,S=M,A=N;return p(),f("div",j,[H((p(),Q(E,{data:g.value,stripe:"",class:"w-full"},{default:o(()=>[t(s,{prop:"id",label:"ID",width:"80"}),t(s,{label:"Icon",width:"100"},{default:o(l=>[t(U,{src:l.row.icon},null,8,["src"])]),_:1}),t(s,{prop:"name",label:"Name",width:"100"}),t(s,{prop:"admin",label:"Admin",width:"100",class:"items-center text-center"}),t(s,{label:"WProgress",width:"120",class:"items-center text-center"},{default:o(({row:l})=>[t(x,{"text-inside":!0,"stroke-width":26,percentage:l.wish_progress},null,8,["percentage"])]),_:1}),t(s,{prop:"wish_list",label:"WList",width:"100",class:"items-center text-center"}),t(s,{prop:"score",label:"Score",width:"100"},{default:o(({row:l})=>[t(v,{modelValue:l.score,"onUpdate:modelValue":u=>l.score=u,size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(s,{label:"Operations"},{default:o(({row:l})=>[t(d,{class:"w-16",onClick:u=>h(l),type:"primary"},{default:o(()=>[...e[3]||(e[3]=[m(" Update ",-1)])]),_:1},8,["onClick"]),t(d,{class:"w-16",onClick:u=>y(l)},{default:o(()=>[...e[4]||(e[4]=[m(" Score ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[A,V.value]]),t(S,{modelValue:a.value.visible,"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.visible=l),title:"Change Score",width:"600","before-close":k},{default:o(()=>[e[6]||(e[6]=w("span",null,"输入的积分会作用在当前积分上，输入负数则会减少积分",-1)),a.value.data?(p(),f("div",G,b(a.value.data.name)+" 当前积分: "+b(a.value.data.score),1)):Z("",!0),w("div",J,[t(v,{modelValue:a.value.value,"onUpdate:modelValue":e[0]||(e[0]=l=>a.value.value=l),style:{width:"240px"},placeholder:"Please input"},null,8,["modelValue"]),t(d,{onClick:e[1]||(e[1]=l=>C()),class:"ml-2 w-16",type:"primary"},{default:o(()=>[...e[5]||(e[5]=[m(" Submit ",-1)])]),_:1})])]),_:1},8,["modelValue"])])}}});export{se as default};
