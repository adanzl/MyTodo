import{j as Ve,r as w,t as je,L as tt,n as p,o as r,s,Q as n,G as o,$ as T,D as B,E as Ce,J as y,M as st,l as P,u as E,aa as Le,ai as at,c as I,y as Ge,q as O,F as Be,a6 as Ee,I as ae}from"./vue-vendor-C-hNZ0TW.js";import{c as Re,K as lt,D as qe,q as nt,z as ot,C as rt,a7 as Ne,u as Je,A as it,a0 as Oe,f as Ie,E as d,ak as oe,L as We,i as ut,a9 as He,al as Qe,a8 as Xe,ab as dt,J as ct,am as ft,ae as vt,an as pt,$ as gt,W as _t,B as mt,ao as xt,ap as yt,aj as ht,ah as kt}from"./element-plus-Bd8o4DEb.js";import{m as Ze,a as M,k as Ke}from"./utils-shared-7Fi3rJBK.js";import{n as bt,u as wt,o as Ct,q as Tt,r as $t,t as Mt,v as Dt,w as St,x as Ft,y as Pt,z as At,A as Bt,B as Et,C as Vt,D as zt,E as Lt,F as Ut,G as jt,H as Ae,I as Rt,J as Nt,K as Ot}from"./api-shared-viHtHHjv.js";import{u as It,b as et,M as Ye,_ as Ue}from"./useInterval-DM_5dcLl.js";import{c as Kt,C as Yt}from"./constants-shared-BwcKRbUv.js";import"./utils-BjcahYMR.js";import"./vendor-4xlYshH7.js";import"./types-shared-CGcc7HUC.js";import"./index-ojxu2eSA.js";import"./vant-7Cqjo8an.js";const Gt={class:"p-4 flex flex-col h-[calc(100vh-200px)]"},qt={class:"mb-4 flex-shrink-0 border rounded p-3 bg-gray-50"},Jt={class:"flex flex-col gap-3"},Wt={class:"flex items-center gap-3"},Ht={class:"flex-1 min-w-0"},Qt={class:"flex items-center gap-2"},Xt=["title"],Zt={key:0,class:"text-xs text-gray-500 flex-shrink-0"},es={class:"flex items-center gap-2"},ts={class:"flex items-center justify-between"},ss={class:"flex-1 overflow-auto"},as=["onClick"],ls={key:1,class:"text-gray-400"},ns={key:0,class:"flex flex-col gap-1"},os={class:"text-sm"},rs={class:"text-xs text-gray-500"},is={key:1,class:"text-gray-400"},us={key:0,class:"flex flex-col gap-1"},ds={class:"text-sm"},cs={class:"text-xs text-gray-500"},fs={key:1,class:"text-gray-400"},vs={class:"flex flex-col gap-1 items-center"},ps=["onClick"],gs=["title"],_s={class:"flex items-center gap-2"},ms=Ve({__name:"PdfTool",setup(Te){const u=w(!1),D=w([]),e=w(null),V=w(""),k=w(0),x=w(""),S=w(null),h=w(null);let $=null;const z=async()=>{try{u.value=!0;const f=await bt();if(f.code===0){const c=f.data||[];D.value=c.map(m=>({...m,_decrypting:m.status==="processing"||!1,_password:""}))}else d.error(f.msg||"获取任务列表失败")}catch(f){M(f,"获取任务列表失败")}finally{u.value=!1}},G=f=>{f.raw&&(e.value=f.raw,V.value=f.raw.name,k.value=0,x.value="",S.value&&ee())},q=f=>{if(f<60)return`${f}秒`;if(f<3600){const c=Math.floor(f/60),m=f%60;return`${c}分${m}秒`}else{const c=Math.floor(f/3600),m=Math.floor(f%3600/60),L=f%60;return`${c}小时${m}分${L}秒`}},Y=()=>{if(h.value!==null&&k.value>0&&k.value<100){const f=Math.floor((Date.now()-h.value)/1e3);x.value=q(f)}},ee=()=>{S.value&&u.value?(S.value.abort(),S.value=null,$&&(clearInterval($),$=null),k.value=0,x.value="",h.value=null,u.value=!1,d.info("上传已取消")):(e.value=null,V.value="",k.value=0,x.value="",h.value=null,d.info("已清除选中文件"))},pe=async()=>{if(!e.value){d.warning("请选择要上传的文件");return}const f=e.value;if(!f.name.toLowerCase().endsWith(".pdf")){d.error("只支持 PDF 文件");return}S.value&&ee();try{u.value=!0,k.value=0,x.value="",h.value=Date.now();const c=new AbortController;S.value=c,$=setInterval(()=>{Y()},1e3);const m=await wt(f,L=>{k.value=L,Y()},c.signal);$&&(clearInterval($),$=null),S.value=null,m.code===0?(k.value=100,Y(),d.success("文件上传成功"),setTimeout(()=>{e.value=null,V.value="",k.value=0,x.value="",h.value=null},500),await z()):(d.error(m.msg||"文件上传失败"),k.value=0,x.value="",h.value=null)}catch(c){if(c.name==="CanceledError"||c.code==="ECONNABORTED"||c.message?.includes("canceled")||c.message?.includes("aborted")){$&&(clearInterval($),$=null),S.value||(u.value=!1);return}const m=c.message||"文件上传失败",L=k.value;c.code==="ERR_NETWORK"||c.message?.includes("Network Error")?d.error(`网络错误：上传中断。当前进度：${L}%`):c.response?.status===413?(d.error("文件太大，超过服务器限制（最大 1000MB）"),k.value=0,x.value=""):d.error(`上传失败：${m}`),$&&(clearInterval($),$=null),S.value=null,h.value=null,u.value=!1}},U=async f=>{if(!f.uploaded_info){d.warning("请先上传文件");return}if(!(f._decrypting||f.status==="processing")&&!(f.status==="success"&&!await oe.confirm("已解密的文件已存在，是否重新解密？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>!1)))try{f._decrypting=!0;const c=f._password?.trim()||void 0,m=await Ct(f.task_id,c);m.code===0?(d.success(m.data?.message||"解密任务已提交，正在后台处理"),f._password="",await ge(f)):d.error(m.msg||"提交解密任务失败")}catch(c){M(c,"提交解密任务失败")}finally{f._decrypting=!1}},ge=async(f,c=30)=>{let m=0;const L=async()=>{if(m>=c){d.warning("任务处理超时，请手动刷新查看状态"),await z();return}try{const J=await Mt(f.task_id);if(J.code===0){const K=J.data;f.status=K.status,f.unlocked_info=K.unlocked_info,f.error_message=K.error_message,K.status==="success"?(d.success("文件解密成功"),f._decrypting=!1,await z()):K.status==="failed"?(d.error(K.error_message||"文件解密失败"),f._decrypting=!1):K.status==="processing"?(m++,setTimeout(L,1e3)):f._decrypting=!1}}catch(J){M(J,"查询任务状态失败"),f._decrypting=!1}};L()},j=async(f,c)=>{const m=c==="uploaded"?f.uploaded_info:f.unlocked_info;if(!m){d.warning("文件不存在");return}try{const L=Tt(m.name,c);window.open(L,"_blank")}catch(L){M(L,"下载文件失败")}},_e=async f=>{if(!f.uploaded_info){d.warning("请先上传文件");return}if(f.status==="processing"){d.warning("任务正在处理中，无法删除");return}if(await oe.confirm("确定要删除该任务吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>!1))try{u.value=!0;const m=await $t(f.task_id);m.code===0?(d.success(m.data?.message||"任务删除成功"),await z()):d.error(m.msg||"任务删除失败")}catch(m){M(m,"删除任务失败")}finally{u.value=!1}},le=Ze,R=f=>f?new Date(f*1e3).toLocaleString():"-";return je(()=>{z()}),tt(()=>{$&&(clearInterval($),$=null),S.value&&(S.value.abort(),S.value=null)}),(f,c)=>{const m=Re,L=lt,J=qe,K=Ie,te=rt,N=Ne,re=Je,me=it,ie=nt,ne=ot;return r(),p("div",Gt,[c[12]||(c[12]=s("h2",{class:"text-xl font-semibold mb-4"},"PDF 解密工具",-1)),s("div",qt,[s("div",Jt,[s("div",Wt,[s("div",null,[n(m,{type:"success",size:"small",onClick:pe,loading:u.value,disabled:!e.value},{default:o(()=>[...c[0]||(c[0]=[T(" 上传 ",-1)])]),_:1},8,["loading","disabled"])]),n(L,{"auto-upload":!1,"on-change":G,"show-file-list":!1,accept:".pdf"},{trigger:o(()=>[n(m,{type:"primary",size:"small",class:"!m-0"},{default:o(()=>[...c[1]||(c[1]=[T("选择文件",-1)])]),_:1})]),_:1}),s("div",Ht,[s("div",Qt,[s("div",{class:Ce(["text-sm truncate flex-1 min-w-0",e.value?"text-gray-600":"text-gray-400"]),title:V.value||e.value?.name},y(V.value||e.value?.name||"未选择文件"),11,Xt),x.value?(r(),p("div",Zt," 已用时间: "+y(x.value),1)):B("",!0)])])]),s("div",es,[n(J,{percentage:k.value,status:k.value===100?"success":void 0,class:"flex-1"},null,8,["percentage","status"]),n(m,{type:"danger",size:"small",plain:"",onClick:ee,disabled:!e.value},{default:o(()=>[...c[2]||(c[2]=[T(" 取消 ",-1)])]),_:1},8,["disabled"])])])]),n(ie,{class:"flex-1 flex flex-col overflow-hidden",shadow:"hover"},{header:o(()=>[s("div",ts,[c[4]||(c[4]=s("span",null,"文件列表",-1)),n(m,{type:"info",size:"small",plain:"",onClick:z,loading:u.value},{default:o(()=>[u.value?B("",!0):(r(),P(K,{key:0},{default:o(()=>[n(E(Oe))]),_:1})),c[3]||(c[3]=T(" 刷新 ",-1))]),_:1},8,["loading"])])]),default:o(()=>[s("div",ss,[st((r(),P(me,{data:D.value,stripe:"",class:"w-full"},{empty:o(()=>[...c[11]||(c[11]=[s("div",{class:"text-center text-gray-400 py-8"},"暂无文件，请上传 PDF 文件",-1)])]),default:o(()=>[n(te,{prop:"filename",label:"文件名","min-width":"200"},{default:o(({row:_})=>[_.uploaded_info?(r(),p("span",{key:0,class:"text-blue-600 cursor-pointer hover:underline",onClick:W=>j(_,"uploaded")},y(_.filename),9,as)):(r(),p("span",ls,"-"))]),_:1}),n(te,{label:"上传文件","min-width":"150"},{default:o(({row:_})=>[_.uploaded_info?(r(),p("div",ns,[s("span",os,y(E(le)(_.uploaded_info.size)),1),s("span",rs,y(R(_.uploaded_info.modified)),1)])):(r(),p("span",is,"-"))]),_:1}),n(te,{label:"已解密文件","min-width":"150"},{default:o(({row:_})=>[_.unlocked_info?(r(),p("div",us,[s("span",ds,y(E(le)(_.unlocked_info.size)),1),s("span",cs,y(R(_.unlocked_info.modified)),1)])):(r(),p("span",fs,"未解密"))]),_:1}),n(te,{label:"状态",width:"140",align:"center"},{default:o(({row:_})=>[s("div",vs,[_.status==="success"?(r(),P(N,{key:0,type:"success",size:"small"},{default:o(()=>[...c[5]||(c[5]=[T("已解密",-1)])]),_:1})):_.status==="processing"?(r(),P(N,{key:1,type:"warning",size:"small"},{default:o(()=>[...c[6]||(c[6]=[T("处理中",-1)])]),_:1})):_.status==="pending"?(r(),P(N,{key:2,type:"info",size:"small"},{default:o(()=>[...c[7]||(c[7]=[T("等待中",-1)])]),_:1})):_.status==="failed"?(r(),P(N,{key:3,type:"danger",size:"small"},{default:o(()=>[...c[8]||(c[8]=[T("失败",-1)])]),_:1})):(r(),P(N,{key:4,type:"info",size:"small"},{default:o(()=>[...c[9]||(c[9]=[T("已上传",-1)])]),_:1})),_.unlocked_info?(r(),p("span",{key:5,class:"text-xs text-blue-600 cursor-pointer hover:underline",onClick:W=>j(_,"unlocked")}," 下载 ",8,ps)):B("",!0),_.error_message?(r(),p("span",{key:6,class:"text-xs text-red-500",title:_.error_message}," 错误 ",8,gs)):B("",!0)])]),_:1}),n(te,{label:"操作",width:"280",fixed:"right"},{default:o(({row:_})=>[s("div",_s,[_.uploaded_info?(r(),P(re,{key:0,modelValue:_._password,"onUpdate:modelValue":W=>_._password=W,type:"password",size:"small",placeholder:"密码（可选）","show-password":"",clearable:"",class:"w-30",disabled:_._decrypting||_.status==="processing",onKeyup:Le(W=>U(_),["enter"])},null,8,["modelValue","onUpdate:modelValue","disabled","onKeyup"])):B("",!0),_.uploaded_info&&_.status!=="processing"?(r(),P(m,{key:1,type:"primary",size:"small",onClick:W=>U(_),loading:_._decrypting,disabled:_._decrypting||_.status==="processing"},{default:o(()=>[T(y(_.status==="success"?"重新解密":"解密"),1)]),_:2},1032,["onClick","loading","disabled"])):B("",!0),_.uploaded_info?(r(),P(m,{key:2,type:"danger",size:"small",plain:"",onClick:W=>_e(_),disabled:_.status==="processing"},{default:o(()=>[...c[10]||(c[10]=[T(" 删除 ",-1)])]),_:1},8,["onClick","disabled"])):B("",!0)])]),_:1})]),_:1},8,["data"])),[[ne,u.value]])])]),_:1})])}}}),xs={viewBox:"0 0 512 512",width:"1.2em",height:"1.2em"};function ys(Te,u){return r(),p("svg",xs,[...u[0]||(u[0]=[s("path",{fill:"none",stroke:"currentColor","stroke-linecap":"square","stroke-width":"48",d:"m136 208l120-104l120 104m-240 96l120 104l120-104"},null,-1)])])}const hs=at({name:"ion-chevron-expand-sharp",render:ys}),ks={class:"flex gap-4 h-[calc(100vh-220px)]"},bs={class:"w-64 border rounded p-3 flex flex-col"},ws={class:"flex items-center justify-between mb-3"},Cs={class:"flex items-center gap-1"},Ts={key:0,class:"flex-1 overflow-y-auto space-y-2 pr-1 min-h-[400px]"},$s=["onClick"],Ms={class:"flex items-center justify-between gap-2"},Ds={class:"text-sm font-medium truncate flex-1 min-w-0"},Ss={class:"text-xs text-gray-500 whitespace-nowrap flex items-center gap-1 flex-shrink-0"},Fs={class:"whitespace-nowrap w-5 flex items-center justify-center"},Ps={class:"flex items-center justify-between gap-2 min-h-[20px]"},As={class:"flex items-center gap-1 flex-shrink-0"},Bs={key:1,class:"flex-1 flex items-center justify-center text-sm text-gray-400"},Es={key:0,class:"flex-1 border rounded p-3 flex flex-col max-w-2xl"},Vs={class:"flex items-center justify-between mb-3 flex-shrink-0"},zs={class:"text-base font-semibold"},Ls={class:"text-sm text-gray-500"},Us={class:"flex-1 overflow-auto flex flex-col gap-3"},js={class:"flex items-center justify-between gap-4 flex-shrink-0"},Rs={class:"flex items-center gap-4"},Ns={class:"text-red-500 text-xs truncate max-w-xs inline-block cursor-help"},Os={class:"flex items-center gap-2"},Is={class:"border rounded p-2 flex-1 flex flex-col overflow-hidden"},Ks={class:"flex items-center justify-between mb-2 flex-shrink-0"},Ys={class:"flex items-center gap-1 pr-1"},Gs={class:"flex-1 overflow-auto"},qs={key:0},Js=["draggable","onDragstart","onDrop"],Ws={class:"text-xs text-gray-500 w-8"},Hs=["title"],Qs={key:0,class:"text-xs text-gray-500 whitespace-nowrap w-20 text-right"},Xs={key:1,class:"w-20"},Zs={key:1,class:"text-sm text-gray-400 text-center py-1"},ea={key:1,class:"flex-1 border rounded p-3 flex flex-col max-w-2xl"},ta=Ve({__name:"AudioMerge",setup(Te){const u=w(!1),D=w([]),e=w(null),V=w(!1),k=w(!1),x=w(!1),S=w(null),h=It({callbacks:{onPlay:()=>{d.success("开始播放")},onError:()=>{M(new Error("音频播放失败"),"播放失败"),N()},onEnded:()=>{N()}}}),$={size:"small",plain:!0,class:"!w-8 !h-6 !p-0"},z={size:"small",plain:!0,class:"!h-5 !text-xs !px-2"},G={size:"small",plain:!0,class:"!h-7 !text-xs"},q=["bg-gray-100","border-t-2","border-b-2","border-blue-500"],Y=t=>{t&&t.classList.remove(...q)},ee=t=>{if(!t)return;t.querySelectorAll('[draggable="true"]').forEach(v=>Y(v))},pe=async t=>{if(e.value&&t.length!==0)try{u.value=!0;for(const l of t){const v=await Dt(e.value.task_id,l);if(v.code!==0){d.error(`添加文件失败: ${v.msg||"未知错误"}`);break}}d.success(`成功添加 ${t.length} 个文件`),await j(e.value.task_id)}catch(l){M(l,"添加文件失败")}finally{u.value=!1}},U=async()=>{try{u.value=!0;const t=await St();t.code===0?(D.value=t.data.tasks||[],D.value.length>0&&!e.value&&await j(D.value[0].task_id)):d.error(t.msg||"获取任务列表失败")}catch(t){M(t,"获取任务列表失败")}finally{u.value=!1}},ge=async()=>{try{u.value=!0;const t=await Ft();t.code===0?(d.success("任务创建成功"),await U(),j(t.data.task_id)):d.error(t.msg||"创建任务失败")}catch(t){M(t,"创建任务失败")}finally{u.value=!1}},j=async t=>{e.value&&e.value.task_id!==t&&ne();try{u.value=!0;const l=await Pt(t);l.code===0?e.value=l.data:d.error(l.msg||"获取任务信息失败")}catch(l){M(l,"获取任务信息失败")}finally{u.value=!1}},_e=async t=>{if(await oe.confirm("确定要删除该任务吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>!1))try{u.value=!0;const v=await Vt(t);v.code===0?(d.success("任务删除成功"),await U(),e.value&&e.value.task_id===t&&(D.value&&D.value.length>0?await j(D.value[0].task_id):e.value=null)):d.error(v.msg||"删除任务失败")}catch(v){M(v,"删除任务失败")}finally{u.value=!1}},le=()=>{if(!e.value){d.warning("请先创建或选择任务");return}V.value=!0},R=async t=>{if(!(!e.value||!await oe.confirm("确定要删除该文件吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>!1)))try{u.value=!0;const v=await zt(e.value.task_id,t);v.code===0?(h.playingFileIndex.value===t?ne():h.playingFileIndex.value!==null&&h.playingFileIndex.value>t&&(h.playingFileIndex.value=h.playingFileIndex.value-1),d.success("文件删除成功"),await j(e.value.task_id)):d.error(v.msg||"删除文件失败")}catch(v){M(v,"删除文件失败")}finally{u.value=!1}},f=async()=>{if(!(!e.value||!await oe.confirm(`确定要开始合成吗？将合并 ${ce.value} 个音频文件。`,"确认合成",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>!1)))try{u.value=!0;const l=await At(e.value.task_id);l.code===0?(d.success("合成任务已启动"),await U(),await j(e.value.task_id),L()):d.error(l.msg||"启动任务失败")}catch(l){M(l,"启动任务失败")}finally{u.value=!1}},{start:c,stop:m}=et(async()=>{if(!e.value||e.value.status!=="processing"){m();return}await U(),await j(e.value.task_id)},Kt,{immediate:!1}),L=()=>{c()},J=t=>{if(!t)return;const l=Lt(t);window.open(l,"_blank")},K=()=>{e.value?.result_file&&J(e.value.task_id)},te=t=>{t?.result_file&&J(t.task_id)},N=()=>{h.clear()},re=(t,l)=>{if(!t)return;const v=t?.path||t?.name||"";h.seekFile(v,l)},me=(t,l)=>{e.value?.result_file&&re({path:e.value.result_file},l)},ie=t=>{if(!e.value||!e.value.files||t<0||t>=e.value.files.length)return;const l=e.value.files[t],v=l.path||l.name||"";if(!v){d.warning("文件路径不存在");return}if(h.playingFilePath.value===v&&h.audio&&!h.audio.paused){N(),d.info("已停止播放");return}const F=Ke(v);if(!F){d.error("无法生成媒体文件URL");return}h.load(F,{playingFilePath:v,playingFileIndex:t}),h.play().catch(X=>{M(X,"播放失败"),N()})},ne=()=>{N()},_=()=>{if(!e.value||!e.value.result_file){d.warning("结果文件不存在");return}const t=e.value.result_file;if(h.playingFilePath.value===t&&h.audio&&!h.audio.paused){N(),d.info("已停止播放");return}const l=Ke(t);if(!l){d.error("无法生成媒体文件URL");return}h.load(l,{playingFilePath:t}),h.play().catch(v=>{M(v,"播放失败"),N()})},W=()=>{if(!e.value||!e.value.result_file){d.warning("结果文件不存在");return}k.value=!0},$e=async t=>{if(!e.value||!e.value.result_file)return;if(t.length===0){d.warning("请选择转存目录");return}const l=t[0];try{u.value=!0;const v=await Bt(e.value.task_id,l);v.code===0?(d.success("转存成功"),k.value=!1):d.error(v.msg||"转存失败")}catch(v){M(v,"转存失败")}finally{u.value=!1}},xe=Ze,Me={pending:{tag:"info",text:"等待中"},processing:{tag:"warning",text:"处理中"},success:{tag:"success",text:"成功"},failed:{tag:"danger",text:"失败"}},se=t=>Me[t]?.tag||"info",ue=t=>Me[t]?.text||"未知",de=I(()=>e.value?.status==="processing"),H=I(()=>(e.value?.files||[]).length>0),ce=I(()=>(e.value?.files||[]).length),ye=I(()=>e.value?.result_file),De=I(()=>!ye.value||e.value?.status!=="success"||x.value),i=I(()=>!H.value||de.value||x.value),a=I(()=>de.value||x.value),C=I(()=>!e.value||!H.value||de.value),A=I(()=>x.value?"点击退出拖拽排序模式":"点击进入拖拽排序模式"),fe=I(()=>({path:ye.value||""})),ve=(t,l)=>!t||!l||t.length!==l.length?!0:t.some((v,F)=>{const X=v?.path||v?.name,be=l[F]?.path||l[F]?.name;return X!==be}),he=async()=>{if(x.value){if(e.value&&e.value.files&&e.value.files.length>0){if(ve(S.value||[],e.value.files))try{u.value=!0;const l=e.value.files.map((F,X)=>X),v=await Et(e.value.task_id,l);v.code===0?(d.success("排序已保存"),await j(e.value.task_id)):d.error(v.msg||"保存排序失败")}catch(l){M(l,"保存排序失败")}finally{u.value=!1}S.value=null}}else e.value&&e.value.files&&e.value.files.length>0&&(S.value=[...e.value.files||[]]);x.value=!x.value},ke=(t,l)=>{if(!x.value)return t.preventDefault(),!1;try{t.dataTransfer&&(t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",l.toString()))}catch(v){console.error("拖拽开始失败:",v)}},ze=t=>{t.currentTarget&&Y(t.currentTarget)},Se=t=>{t.currentTarget&&Y(t.currentTarget)},Fe=t=>{if(x.value&&(t.preventDefault(),t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.currentTarget)){const l=t.currentTarget.getBoundingClientRect(),v=t.clientY,F=l.top+l.height/2;Y(t.currentTarget),v<F?t.currentTarget.classList.add("border-t-2","border-blue-500"):t.currentTarget.classList.add("border-b-2","border-blue-500")}},Pe=(t,l)=>{if(!x.value||(t.preventDefault(),t.currentTarget&&(Y(t.currentTarget),ee(t.currentTarget.parentElement)),!t.dataTransfer))return;const v=parseInt(t.dataTransfer.getData("text/plain"),10);if(v===l||isNaN(v)||!e.value||!e.value.files||v<0||v>=e.value.files.length||l<0||l>=e.value.files.length)return;const F=t.currentTarget?.getBoundingClientRect(),X=t.clientY,be=F?F.top+F.height/2:0,we=X<be?l:l+1,b=[...e.value.files||[]],[Q]=b.splice(v,1),Z=v<we?we-1:we;b.splice(Z,0,Q),e.value={...e.value,files:b}},g=()=>{V.value=!1};return je(()=>{U()}),Ge(()=>{ne(),m()}),(t,l)=>{const v=Ie,F=Re,X=Ne,be=Qe,we=hs;return r(),p("div",ks,[s("div",bs,[s("div",ws,[l[7]||(l[7]=s("h3",{class:"text-base font-semibold"},"任务列表",-1)),s("div",Cs,[n(F,O({type:"info"},$,{onClick:U,loading:u.value}),{default:o(()=>[u.value?B("",!0):(r(),P(v,{key:0},{default:o(()=>[n(E(Oe))]),_:1}))]),_:1},16,["loading"]),n(F,O({type:"success"},$,{onClick:ge,loading:u.value}),{default:o(()=>[n(v,null,{default:o(()=>[n(E(We))]),_:1})]),_:1},16,["loading"])])]),D.value&&D.value.length>0?(r(),p("div",Ts,[(r(!0),p(Be,null,Ee(D.value,b=>(r(),p("div",{key:b.task_id,class:Ce(["border rounded px-3 py-2 cursor-pointer hover:bg-gray-50 group min-h-[60px] flex flex-col justify-between",{"border-blue-500 bg-blue-50":e.value&&b.task_id===e.value.task_id}]),onClick:Q=>j(b.task_id)},[s("div",Ms,[s("div",Ds,y(b.name),1),s("span",Ss,[n(v,null,{default:o(()=>[n(E(ut),{class:"!w-3 !h-3"})]),_:1}),s("span",Fs,y(b.files?b.files.length:0),1)])]),s("div",Ps,[n(X,{type:se(b.status),size:"small",class:"!h-5 !text-xs w-16 text-center"},{default:o(()=>[T(y(ue(b.status)),1)]),_:2},1032,["type"]),s("div",As,[b.status==="success"&&b.result_file?(r(),P(F,O({key:0,type:"primary"},{ref_for:!0},z,{onClick:ae(Q=>te(b),["stop"])}),{default:o(()=>[...l[8]||(l[8]=[T(" 下载 ",-1)])]),_:1},16,["onClick"])):B("",!0),n(F,O({type:"danger"},{ref_for:!0},z,{onClick:ae(Q=>_e(b.task_id),["stop"]),disabled:b.status==="processing"}),{default:o(()=>[n(v,null,{default:o(()=>[n(E(He))]),_:1})]),_:1},16,["onClick","disabled"])])])],10,$s))),128))])):(r(),p("div",Bs,' 暂无任务，请点击"新建"创建 '))]),e.value?(r(),p("div",Es,[s("div",Vs,[s("h3",zs,"任务详情: "+y(e.value.name),1),s("span",Ls," 共 "+y(ce.value)+" 个文件 ",1)]),s("div",Us,[s("div",js,[s("div",Rs,[n(X,{type:se(e.value.status),size:"small",class:"w-16 text-center"},{default:o(()=>[T(y(ue(e.value.status)),1)]),_:1},8,["type"]),ye.value?(r(),P(Ye,{key:0,file:fe.value,player:E(h),disabled:x.value,onPlay:_,onSeek:me},null,8,["file","player","disabled"])):B("",!0),n(F,O({type:"primary"},G,{onClick:K,disabled:De.value}),{default:o(()=>[...l[9]||(l[9]=[T(" 下载 ",-1)])]),_:1},16,["disabled"]),n(F,O({type:"success"},G,{onClick:W,disabled:De.value}),{default:o(()=>[...l[10]||(l[10]=[T(" 转存 ",-1)])]),_:1},16,["disabled"]),e.value.error_message?(r(),P(be,{key:1,content:`错误: ${e.value.error_message}`,placement:"top"},{default:o(()=>[s("span",Ns," 错误: "+y(e.value.error_message),1)]),_:1},8,["content"])):B("",!0)]),s("div",Os,[n(F,O({type:"success"},G,{onClick:f,disabled:i.value,loading:de.value}),{default:o(()=>[...l[11]||(l[11]=[T(" 开始合成 ",-1)])]),_:1},16,["disabled","loading"])])]),s("div",Is,[s("div",Ks,[l[13]||(l[13]=s("h4",{class:"text-sm font-semibold"},"文件列表",-1)),s("div",Ys,[n(F,O({type:"primary"},z,{disabled:a.value,onClick:le}),{default:o(()=>[...l[12]||(l[12]=[T(" + ",-1)])]),_:1},16,["disabled"]),n(F,O({type:x.value?"success":"default"},$,{onClick:he,disabled:C.value,title:A.value}),{default:o(()=>[x.value?(r(),P(v,{key:0},{default:o(()=>[n(E(Xe))]),_:1})):(r(),P(we,{key:1,class:"!w-3.5 !h-3.5"}))]),_:1},16,["type","disabled","title"])])]),s("div",Gs,[H.value?(r(),p("div",qs,[(r(!0),p(Be,null,Ee(e.value.files,(b,Q)=>(r(),p("div",{key:Q,class:Ce(["flex items-center gap-2 p-1 hover:bg-gray-100 rounded",{"cursor-move":x.value,"cursor-default":!x.value,"select-none":!0}]),draggable:x.value,onDragstart:Z=>ke(Z,Number(Q)),onDragend:l[2]||(l[2]=Z=>ze(Z)),onDragover:l[3]||(l[3]=ae(Z=>Fe(Z),["prevent"])),onDragleave:Se,onDrop:ae(Z=>Pe(Z,Number(Q)),["prevent"])},[s("span",Ws,y(Number(Q)+1),1),s("span",{class:"flex-1 text-sm truncate",title:b.path||b.name},y(b.name),9,Hs),b.size?(r(),p("span",Qs,y(E(xe)(b.size)),1)):(r(),p("div",Xs)),s("div",{class:"flex items-center gap-1 flex-shrink-0",onMousedown:l[0]||(l[0]=ae(()=>{},["stop"])),onClick:l[1]||(l[1]=ae(()=>{},["stop"]))},[n(Ye,{file:b,player:E(h),disabled:a.value,onPlay:()=>ie(Number(Q)),onSeek:re},null,8,["file","player","disabled","onPlay"]),n(F,{type:"info",size:"small",plain:"",circle:"",onClick:ae(Z=>R(Number(Q)),["stop"]),disabled:a.value,class:"!h-6 !text-xs"},{default:o(()=>[n(v,null,{default:o(()=>[n(E(dt))]),_:1})]),_:1},8,["onClick","disabled"])],32)],42,Js))),128))])):(r(),p("div",Zs,"文件列表为空"))])])])])):(r(),p("div",ea,[...l[14]||(l[14]=[s("div",{class:"flex items-center justify-between mb-3 flex-shrink-0"},[s("h3",{class:"text-base font-semibold"},"任务详情")],-1),s("div",{class:"flex-1 flex items-center justify-center text-sm text-gray-400"}," 请从左侧选择一个任务查看详情 ",-1)])])),n(Ue,{visible:V.value,"onUpdate:visible":l[4]||(l[4]=b=>V.value=b),title:"选择文件添加到任务","confirm-button-text":"添加","confirm-loading":u.value,onConfirm:pe,onClose:g},null,8,["visible","confirm-loading"]),n(Ue,{visible:k.value,"onUpdate:visible":l[5]||(l[5]=b=>k.value=b),title:"选择转存目录","confirm-button-text":"转存",mode:"directory","confirm-loading":u.value,onConfirm:$e,onClose:l[6]||(l[6]=b=>k.value=!1)},null,8,["visible","confirm-loading"])])}}}),sa={class:"flex gap-4 h-[calc(100vh-220px)]"},aa={class:"w-64 border rounded p-3 flex flex-col"},la={class:"flex items-center justify-between mb-3"},na={class:"flex items-center gap-1"},oa={key:0,class:"flex-1 overflow-y-auto space-y-2 pr-1 min-h-[400px]"},ra=["onClick"],ia={class:"flex items-center justify-between gap-2"},ua=["title"],da={class:"flex items-center justify-between gap-2 min-h-[20px]"},ca={class:"flex items-center gap-1 flex-shrink-0"},fa={key:1,class:"flex-1 flex items-center justify-center text-sm text-gray-400 min-h-[400px]"},va={key:0,class:"flex-1 border rounded p-3 flex flex-col min-h-0"},pa={class:"flex items-center justify-between mb-3 flex-shrink-0"},ga={class:"flex items-center gap-2 flex-1"},_a={class:"text-base font-semibold"},ma={class:"flex-1 flex flex-col gap-3 min-h-0"},xa={class:"flex items-center gap-4 flex-shrink-0"},ya={class:"text-red-500 text-xs truncate block max-w-md cursor-help"},ha={class:"border rounded p-3 flex flex-col gap-2"},ka={class:"flex items-center justify-between"},ba={class:"flex items-center gap-2"},wa={key:0,class:"text-xs text-gray-500"},Ca={key:0,class:"text-sm text-gray-600"},Ta=["title"],$a={key:1,class:"text-sm text-gray-400"},Ma={class:"border rounded p-3 flex flex-col gap-2 flex-1 min-h-0 overflow-hidden"},Da={key:0,class:"flex-1 overflow-y-scroll scrollbar-overlay space-y-1 min-h-0"},Sa={class:"flex-1 min-w-0 flex items-center gap-3 text-sm"},Fa=["title"],Pa={class:"flex items-center gap-2 text-xs text-gray-500 flex-shrink-0"},Aa={key:0},Ba={key:1},Ea=["title"],Va={key:1,class:"flex-1 flex items-center justify-center text-sm text-gray-400 min-h-0"},za={key:1,class:"flex-1 border rounded p-3 flex flex-col"},La={key:2,class:"w-80 border rounded p-3 flex flex-col"},Ua={class:"flex-1 overflow-auto flex flex-col gap-3"},ja={class:"border rounded p-3 flex flex-col gap-2"},Ra={class:"flex items-center gap-2"},Na={class:"border rounded p-3 flex flex-col gap-2"},Oa={class:"flex items-center gap-2"},Ia={class:"text-xs text-gray-400 flex items-center gap-1"},Ka={key:0,class:"border rounded p-3 flex flex-col gap-2"},Ya={key:0,class:"space-y-2"},Ga={class:"text-sm text-gray-600"},qa=["title"],Ja={key:1,class:"text-sm text-gray-400"},Wa={key:1,class:"border rounded p-3 flex flex-col gap-2"},Ha={class:"text-sm text-gray-600"},Qa={key:0,class:"mt-2"},Xa={key:3,class:"w-80 border rounded p-3 flex flex-col"},Za=Ve({__name:"AudioConvert",setup(Te){const u=w(!1),D=w([]),e=w(null),V=w(!1),k=w("mp3"),x=w(!1),S=w(!0),h=w(!1),$=w(!1),z=w(""),G=w(!1),q=w(""),Y={size:"small",plain:!0,class:"!w-8 !h-6 !p-0"},ee={size:"small",plain:!0,class:"!h-5 !text-xs !px-2"},pe={size:"small",plain:!0,class:"!h-7 !text-xs"},U=async()=>{try{u.value=!0;const i=await Ut();i.code===0?(D.value=i.data.tasks||[],D.value.length>0&&!e.value&&await R(D.value[0].task_id)):d.error(i.msg||"获取任务列表失败")}catch(i){M(i,"获取任务列表失败")}finally{u.value=!1}},ge=()=>{const i=new Date,a=i.getFullYear(),C=String(i.getMonth()+1).padStart(2,"0"),A=String(i.getDate()).padStart(2,"0"),fe=String(i.getHours()).padStart(2,"0"),ve=String(i.getMinutes()).padStart(2,"0"),he=String(i.getSeconds()).padStart(2,"0");z.value=`${a}-${C}-${A} ${fe}:${ve}:${he}`,$.value=!0},j=async()=>{if(!z.value.trim()){d.warning("请输入任务名称");return}try{u.value=!0;const i=await jt({name:z.value.trim()});i.code===0?(d.success("任务创建成功"),$.value=!1,z.value="",await U(),R(i.data.task_id)):d.error(i.msg||"创建任务失败")}catch(i){M(i,"创建任务失败")}finally{u.value=!1}},_e=()=>{e.value&&(q.value=e.value.name,G.value=!0)},le=async()=>{if(e.value){if(!q.value.trim()){d.warning("请输入任务名称");return}try{u.value=!0;const i=await Ae(e.value.task_id,{name:q.value.trim()});i.code===0?(d.success("任务名称修改成功"),G.value=!1,q.value="",await R(e.value.task_id)):d.error(i.msg||"修改任务名称失败")}catch(i){M(i,"修改任务名称失败")}finally{u.value=!1}}},R=async i=>{try{u.value=!0;const a=await Rt(i);a.code===0?(e.value=a.data,k.value=a.data.output_dir||"mp3",x.value=!1,S.value=a.data.overwrite!==!1,h.value=!1):d.error(a.msg||"获取任务信息失败")}catch(a){M(a,"获取任务信息失败")}finally{u.value=!1}},f=async i=>{if(await oe.confirm("确定要删除该任务吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>!1))try{u.value=!0;const C=await Ot(i);C.code===0?(d.success("任务删除成功"),await U(),e.value&&e.value.task_id===i&&(D.value&&D.value.length>0?await R(D.value[0].task_id):e.value=null)):d.error(C.msg||"删除任务失败")}catch(C){M(C,"删除任务失败")}finally{u.value=!1}},c=()=>{if(!e.value){d.warning("请先创建或选择任务");return}V.value=!0},m=async i=>{if(!e.value||i.length===0)return;const a=i[0];try{u.value=!0;const C=await Ae(e.value.task_id,{directory:a});C.code===0?(d.success("目录设置成功"),await R(e.value.task_id),V.value=!1):d.error(C.msg||"设置目录失败")}catch(C){M(C,"设置目录失败")}finally{u.value=!1}},L=()=>{V.value=!1},J=()=>{if(!e.value)return;const i=e.value.output_dir||"mp3";x.value=k.value!==i},K=async()=>{if(e.value){if(!k.value.trim()){d.error("输出目录名称不能为空");return}try{u.value=!0;const i=await Ae(e.value.task_id,{output_dir:k.value.trim()});i.code===0?(d.success("输出目录名称保存成功"),await R(e.value.task_id)):d.error(i.msg||"保存输出目录名称失败")}catch(i){M(i,"保存输出目录名称失败")}finally{u.value=!1}}},te=()=>{if(!e.value)return;const i=e.value.overwrite!==!1;h.value=S.value!==i,h.value&&N()},N=async()=>{if(e.value)try{u.value=!0;const i=await Ae(e.value.task_id,{overwrite:S.value});i.code===0?(d.success("覆盖选项保存成功"),await R(e.value.task_id)):d.error(i.msg||"保存覆盖选项失败")}catch(i){M(i,"保存覆盖选项失败")}finally{u.value=!1}},re=async()=>{if(!e.value)return;if(!e.value.directory){d.warning("请先选择转码目录");return}if(await oe.confirm(`确定要开始转码吗？将转换目录 "${e.value.name}" 下的所有音频文件为 MP3 格式。`,"确认转码",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>!1))try{u.value=!0;const a=await Nt(e.value.task_id);a.code===0?(d.success("转码任务已启动"),await U(),await R(e.value.task_id),ne()):d.error(a.msg||"启动任务失败")}catch(a){M(a,"启动任务失败")}finally{u.value=!1}},{start:me,stop:ie}=et(async()=>{if(!e.value||e.value.status!=="processing"){ie();return}await U(),await R(e.value.task_id)},Yt,{immediate:!1}),ne=()=>{me()},_={pending:{tag:"info",text:"等待中"},processing:{tag:"warning",text:"处理中"},success:{tag:"success",text:"成功"},failed:{tag:"danger",text:"失败"}},W=i=>_[i]?.tag||"info",$e=i=>_[i]?.text||"未知",xe=I(()=>e.value?.status==="processing"),Me=I(()=>!e.value?.directory||xe.value),se=I(()=>xe.value),ue=I(()=>e.value?.file_status?Object.keys(e.value.file_status).map(i=>{const a=e.value.file_status[i];return{path:i,status:a.status||"pending",error:a.error,size:a.size,duration:a.duration}}):[]),de=i=>i.path.split("/").pop()||i.path,H=i=>i.status,ce=i=>i.error,ye=i=>{if(!i)return"";const a=["B","KB","MB","GB"];let C=i,A=0;for(;C>=1024&&A<a.length-1;)C/=1024,A++;return`${C.toFixed(1)} ${a[A]}`},De=i=>{if(!i)return"";const a=Math.floor(i/3600),C=Math.floor(i%3600/60),A=i%60;return a>0?`${a}:${C.toString().padStart(2,"0")}:${A.toString().padStart(2,"0")}`:`${C}:${A.toString().padStart(2,"0")}`};return je(()=>{U()}),Ge(()=>{ie()}),(i,a)=>{const C=Ie,A=Re,fe=Ne,ve=Qe,he=gt,ke=Je,ze=qe,Se=yt,Fe=xt,Pe=mt;return r(),p("div",sa,[s("div",aa,[s("div",la,[a[11]||(a[11]=s("h3",{class:"text-base font-semibold"},"任务列表",-1)),s("div",na,[n(A,O({type:"info"},Y,{onClick:U,loading:u.value}),{default:o(()=>[u.value?B("",!0):(r(),P(C,{key:0},{default:o(()=>[n(E(Oe))]),_:1}))]),_:1},16,["loading"]),n(A,O({type:"success"},Y,{onClick:ge,loading:u.value}),{default:o(()=>[n(C,null,{default:o(()=>[n(E(We))]),_:1})]),_:1},16,["loading"])])]),D.value&&D.value.length>0?(r(),p("div",oa,[(r(!0),p(Be,null,Ee(D.value,g=>(r(),p("div",{key:g.task_id,class:Ce(["border rounded px-3 py-2 cursor-pointer hover:bg-gray-50 group min-h-[60px] flex flex-col justify-between",{"border-blue-500 bg-blue-50":e.value&&g.task_id===e.value.task_id}]),onClick:t=>R(g.task_id)},[s("div",ia,[s("div",{class:"text-sm font-medium truncate flex-1 min-w-0",title:g.name},y(g.name),9,ua)]),s("div",da,[n(fe,{type:W(g.status),size:"small",class:"!h-5 !text-xs w-16 text-center"},{default:o(()=>[T(y($e(g.status)),1)]),_:2},1032,["type"]),s("div",ca,[n(A,O({type:"danger"},{ref_for:!0},ee,{onClick:ae(t=>f(g.task_id),["stop"]),disabled:g.status==="processing"}),{default:o(()=>[n(C,null,{default:o(()=>[n(E(He))]),_:1})]),_:1},16,["onClick","disabled"])])])],10,ra))),128))])):(r(),p("div",fa,' 暂无任务，请点击"新建"创建 '))]),e.value?(r(),p("div",va,[s("div",pa,[s("div",ga,[s("h3",_a,"文件列表: "+y(e.value.name),1),n(A,{type:"default",size:"small",plain:"",circle:"",disabled:se.value,onClick:_e,title:"编辑名称"},{default:o(()=>[n(C,null,{default:o(()=>[n(E(ct))]),_:1})]),_:1},8,["disabled"])])]),s("div",ma,[s("div",xa,[n(fe,{type:W(e.value.status),size:"small",class:"w-16 text-center flex-shrink-0"},{default:o(()=>[T(y($e(e.value.status)),1)]),_:1},8,["type"]),e.value.error_message?(r(),P(ve,{key:0,content:`错误: ${e.value.error_message}`,placement:"top",class:"flex-1 min-w-0 max-w-md"},{default:o(()=>[s("span",ya," 错误: "+y(e.value.error_message),1)]),_:1},8,["content"])):B("",!0)]),s("div",ha,[s("div",ka,[s("div",ba,[a[12]||(a[12]=s("h4",{class:"text-sm font-semibold"},"转码目录",-1)),e.value.total_files!==null&&e.value.total_files!==void 0?(r(),p("span",wa," 可处理文件数: "+y(e.value.total_files),1)):B("",!0)]),n(A,O({type:"primary"},ee,{disabled:se.value,onClick:c}),{default:o(()=>[...a[13]||(a[13]=[T(" 选择目录 ",-1)])]),_:1},16,["disabled"])]),e.value.directory?(r(),p("div",Ca,[s("div",{class:"truncate",title:e.value.directory},y(e.value.directory),9,Ta)])):(r(),p("div",$a," 请选择一个目录，该目录下的所有媒体文件将被转换为 MP3 格式 "))]),s("div",Ma,[a[14]||(a[14]=s("h4",{class:"text-sm font-semibold flex-shrink-0"},"文件列表",-1)),ue.value&&ue.value.length>0?(r(),p("div",Da,[(r(!0),p(Be,null,Ee(ue.value,(g,t)=>(r(),p("div",{key:t,class:"flex items-center gap-2 p-2 rounded hover:bg-gray-50 border-b border-gray-100"},[n(C,{class:Ce(["flex-shrink-0",{"text-green-500":H(g)==="success","text-red-500":H(g)==="failed","text-yellow-500":H(g)==="processing","text-gray-400":H(g)==="pending"}])},{default:o(()=>[H(g)==="success"?(r(),P(E(Xe),{key:0})):H(g)==="failed"?(r(),P(E(ft),{key:1})):H(g)==="processing"?(r(),P(E(vt),{key:2})):(r(),P(E(pt),{key:3}))]),_:2},1032,["class"]),s("div",Sa,[s("div",{class:"flex-1 min-w-0 truncate",title:g.path},y(de(g)),9,Fa),s("div",Pa,[g.size?(r(),p("span",Aa,y(ye(g.size)),1)):B("",!0),g.duration?(r(),p("span",Ba,y(De(g.duration)),1)):B("",!0)]),ce(g)?(r(),p("div",{key:0,class:"text-xs text-red-500 truncate max-w-xs",title:ce(g)},y(ce(g)),9,Ea)):B("",!0)])]))),128))])):(r(),p("div",Va," 暂无文件，请先选择转码目录 "))])])])):(r(),p("div",za,[...a[15]||(a[15]=[s("div",{class:"flex items-center justify-between mb-3 flex-shrink-0"},[s("h3",{class:"text-base font-semibold"},"文件列表")],-1),s("div",{class:"flex-1 flex items-center justify-center text-sm text-gray-400"}," 请从左侧选择一个任务查看文件列表 ",-1)])])),e.value?(r(),p("div",La,[a[24]||(a[24]=s("div",{class:"flex items-center justify-between mb-3"},[s("h3",{class:"text-base font-semibold"},"输出信息")],-1)),s("div",Ua,[s("div",ja,[s("div",Ra,[a[16]||(a[16]=s("span",{class:"text-sm text-gray-600"},"覆盖同名文件",-1)),n(he,{modelValue:S.value,"onUpdate:modelValue":a[0]||(a[0]=g=>S.value=g),disabled:se.value,onChange:te},null,8,["modelValue","disabled"])]),n(A,O({type:"success"},pe,{onClick:re,disabled:Me.value,loading:xe.value,class:"w-full"}),{default:o(()=>[...a[17]||(a[17]=[T(" 开始转码 ",-1)])]),_:1},16,["disabled","loading"])]),s("div",Na,[a[20]||(a[20]=s("div",{class:"flex items-center justify-between"},[s("h4",{class:"text-sm font-semibold"},"输出目录名称")],-1)),s("div",Oa,[n(ke,{modelValue:k.value,"onUpdate:modelValue":a[1]||(a[1]=g=>k.value=g),placeholder:"输出目录名称",size:"small",disabled:se.value,onBlur:J},null,8,["modelValue","disabled"]),n(A,O({type:"primary"},ee,{disabled:se.value||!x.value,onClick:K}),{default:o(()=>[...a[18]||(a[18]=[T(" 保存 ",-1)])]),_:1},16,["disabled"])]),s("div",Ia,[a[19]||(a[19]=s("span",null,"文件将保存在转码目录下的此文件夹中",-1)),e.value?.directory&&e.value?.output_dir?(r(),P(ve,{key:0,content:`${e.value.directory}/${e.value.output_dir}`,placement:"top"},{default:o(()=>[n(C,{class:"cursor-help text-gray-400 hover:text-gray-600"},{default:o(()=>[n(E(_t))]),_:1})]),_:1},8,["content"])):B("",!0)])]),e.value.status==="processing"||e.value.progress?(r(),p("div",Ka,[a[21]||(a[21]=s("h4",{class:"text-sm font-semibold"},"转码进度",-1)),e.value.progress?(r(),p("div",Ya,[s("div",Ga," 已处理: "+y(e.value.progress.processed??0)+" / "+y(e.value.total_files??e.value.progress.total??0),1),n(ze,{percentage:(e.value.total_files??e.value.progress.total??0)>0?Math.round((e.value.progress.processed??0)/(e.value.total_files??e.value.progress.total??1)*100):0,status:e.value.status==="processing"?void 0:"success"},null,8,["percentage","status"]),e.value.progress.current_file?(r(),p("div",{key:0,class:"text-xs text-gray-500 truncate",title:e.value.progress.current_file}," 正在处理: "+y(e.value.progress.current_file),9,qa)):B("",!0)])):(r(),p("div",Ja,"等待开始转码..."))])):B("",!0),e.value.status==="success"?(r(),p("div",Wa,[a[23]||(a[23]=s("h4",{class:"text-sm font-semibold"},"转码结果",-1)),s("div",Ha,[a[22]||(a[22]=s("div",null,"转码完成！所有文件已保存到输出目录",-1)),e.value.progress?(r(),p("div",Qa," 共转换 "+y(e.value.total_files??e.value.progress.total??0)+" 个文件 ",1)):B("",!0)])])):B("",!0)])])):(r(),p("div",Xa,[...a[25]||(a[25]=[s("h3",{class:"text-base font-semibold mb-3"},"输出信息",-1),s("div",{class:"flex-1 flex items-center justify-center text-sm text-gray-400"}," 请从左侧选择一个任务查看输出信息 ",-1)])])),n(Ue,{visible:V.value,"onUpdate:visible":a[2]||(a[2]=g=>V.value=g),title:"选择转码目录","confirm-button-text":"确定",mode:"directory","default-path":e.value?.directory||void 0,"confirm-loading":u.value,onConfirm:m,onClose:L},null,8,["visible","default-path","confirm-loading"]),n(Pe,{modelValue:$.value,"onUpdate:modelValue":a[5]||(a[5]=g=>$.value=g),title:"创建转码任务",width:"400px",onClose:a[6]||(a[6]=g=>z.value="")},{footer:o(()=>[n(A,{onClick:a[4]||(a[4]=g=>$.value=!1)},{default:o(()=>[...a[26]||(a[26]=[T("取消",-1)])]),_:1}),n(A,{type:"primary",onClick:j,loading:u.value},{default:o(()=>[...a[27]||(a[27]=[T(" 确定 ",-1)])]),_:1},8,["loading"])]),default:o(()=>[n(Fe,null,{default:o(()=>[n(Se,{label:"任务名称"},{default:o(()=>[n(ke,{modelValue:z.value,"onUpdate:modelValue":a[3]||(a[3]=g=>z.value=g),placeholder:"请输入任务名称",onKeyup:Le(j,["enter"])},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),n(Pe,{modelValue:G.value,"onUpdate:modelValue":a[9]||(a[9]=g=>G.value=g),title:"重命名任务",width:"400px",onClose:a[10]||(a[10]=g=>q.value="")},{footer:o(()=>[n(A,{onClick:a[8]||(a[8]=g=>G.value=!1)},{default:o(()=>[...a[28]||(a[28]=[T("取消",-1)])]),_:1}),n(A,{type:"primary",onClick:le,loading:u.value},{default:o(()=>[...a[29]||(a[29]=[T(" 确定 ",-1)])]),_:1},8,["loading"])]),default:o(()=>[n(Fe,null,{default:o(()=>[n(Se,{label:"任务名称"},{default:o(()=>[n(ke,{modelValue:q.value,"onUpdate:modelValue":a[7]||(a[7]=g=>q.value=g),placeholder:"请输入任务名称",onKeyup:Le(le,["enter"])},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),el={class:"p-1"},fl=Ve({__name:"index",setup(Te){const u=w("pdf_tool"),D=e=>{console.log("切换到页签:",e)};return(e,V)=>{const k=kt,x=ht;return r(),p("div",el,[n(x,{modelValue:u.value,"onUpdate:modelValue":V[0]||(V[0]=S=>u.value=S),onTabChange:D,class:"flex-1 flex flex-col overflow-hidden h-[calc(100vh-150px)]"},{default:o(()=>[n(k,{label:"PDF 工具",name:"pdf_tool"},{default:o(()=>[n(ms)]),_:1}),n(k,{label:"音频合成",name:"audio_merge"},{default:o(()=>[n(ta)]),_:1}),n(k,{label:"音频转码",name:"audio_convert"},{default:o(()=>[n(Za)]),_:1})]),_:1},8,["modelValue"])])}}});export{fl as default};
