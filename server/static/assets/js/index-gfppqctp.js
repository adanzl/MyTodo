const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/Home-B-VovtB0.js","assets/js/shared-1TZFBAIg.js","assets/js/utils-B-B_-3AX.js","assets/js/element-plus-CEI_9LYZ.js","assets/js/vue-vendor-Bzw_s7xI.js","assets/js/vendor-B3rMqREe.js","assets/css/element-plus-KlHPlJt0.css","assets/js/vant-DC8oOVF3.js","assets/css/vant-DzKo5b93.css","assets/js/Lottery-D-3PLRp8.js","assets/js/Info-iAd9USUO.js","assets/js/Chat-4osknQsX.js","assets/js/socket-W85Wkm6P.js","assets/css/Chat-CFJ2rmy2.css","assets/js/Score-DxlOjK5e.js","assets/js/Timetable-nfBqpDzq.js","assets/js/index-LC-JGRBT.js","assets/js/useInterval-B8gEL0mK.js","assets/css/useInterval-BJh958RX.css","assets/js/index-faJWwnOa.js"])))=>i.map(i=>d[i]);
import{av as F,r as x,e as I,B as P,aw as H,ax as z,D as L,E as C,Q as e,Z as t,I as S,u as v,a3 as y,M as K,o as $,G as W,aa as G,U as N,O as Q,q as Y,a8 as Z,ay as J,az as X,as as ee,aA as te}from"./vue-vendor-Bzw_s7xI.js";import{E as U,a as oe,b as B,c as j,d as se,e as ne,f as q,h as le,g as ae,p as re,m as ie,i as ue,s as ce,j as de,k as _e,l as fe,n as me,o as pe,q as ve,r as ge,t as ye,u as he,v as we,w as Ee,x as V,y as be,z as Le}from"./element-plus-CEI_9LYZ.js";import{g as Se,l as xe,c as Ce,s as Ie,L as R,a as k,b as Ue,i as D}from"./shared-1TZFBAIg.js";import{s as Ae}from"./vant-DC8oOVF3.js";import"./vendor-B3rMqREe.js";import"./utils-B-B_-3AX.js";(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))u(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&u(a)}).observe(document,{childList:!0,subtree:!0});function r(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerPolicy&&(i.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?i.credentials="include":l.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function u(l){if(l.ep)return;l.ep=!0;const i=r(l);fetch(l.href,i)}})();const O=F("user",()=>{const p=x([]),c=x(!1),r=x(null),u=x({bLogin:!1,id:null,name:null,ico:null}),l=300*1e3,i="user_id",a=m=>p.value.find(g=>String(g.id)===String(m)),f=I(()=>r.value?Date.now()-r.value<l:!1),s=I(()=>u.value.bLogin),n=async(m=!1)=>{if(!(!m&&f.value&&p.value.length>0)){c.value=!0;try{const g=await Se();g&&g.data?(p.value=g.data.data||[],r.value=Date.now()):p.value=[]}catch(g){console.error("èŽ·å–ç”¨æˆ·åˆ—è¡¨å¤±è´¥:",g),U.error("èŽ·å–ç”¨æˆ·åˆ—è¡¨å¤±è´¥"),p.value=[]}finally{c.value=!1}}},o=()=>{r.value=null},d=m=>{u.value={bLogin:!0,id:m.id,name:m.name,ico:m.icon||null},localStorage.setItem(i,String(m.id))};return{userList:p,loading:c,lastFetchTime:r,curUser:u,getUserById:a,isDataFresh:f,isLoggedIn:s,refreshUserList:n,clearCache:o,setCurUser:d,clearCurUser:()=>{u.value={bLogin:!1,id:null,name:null,ico:null},localStorage.removeItem(i)},restoreCurUser:async()=>{const m=localStorage.getItem(i);if(m){p.value.length===0&&await n();const g=a(m);g&&d(g)}},getCurUserFullInfo:()=>u.value.id&&a(u.value.id)||null}}),Pe={class:"flex justify-between items-center p-5"},Oe=P({__name:"Sidebar",setup(p){const c=H(),r=z(),u=O(),l=x(!1),i=()=>{},a=()=>{u.clearCurUser(),c.push("/")};return(f,s)=>{const n=B,o=j,d=q,_=ne,E=ae,h=se,m=pe,g=oe;return L(),C(g,{width:"200px",class:"w-48"},{default:e(()=>[t(m,null,{default:e(()=>[S("div",Pe,[t(n,{src:v(u).curUser.ico},null,8,["src"]),v(u).curUser.bLogin?(L(),C(o,{key:0,onClick:a,size:"small"},{default:e(()=>[...s[0]||(s[0]=[y(" æ³¨é”€ ",-1)])]),_:1})):K("",!0)]),t(h,{"default-active":v(r).path,collapse:l.value,"unique-opened":"",router:""},{default:e(()=>[t(_,{index:"/home",onClick:i},{title:e(()=>[...s[1]||(s[1]=[y("Home",-1)])]),default:e(()=>[t(d,null,{default:e(()=>[t(v(le))]),_:1})]),_:1}),t(E,{index:"mytodo"},{title:e(()=>[t(d,null,{default:e(()=>[t(v(de))]),_:1}),s[2]||(s[2]=S("span",null,"MyTodo",-1))]),default:e(()=>[t(_,{index:"/lottery",onClick:i},{title:e(()=>[...s[3]||(s[3]=[y("æŠ½å¥–è®¾ç½®",-1)])]),default:e(()=>[t(d,null,{default:e(()=>[t(v(re))]),_:1})]),_:1}),t(_,{index:"/chat"},{title:e(()=>[...s[4]||(s[4]=[y("Chat",-1)])]),default:e(()=>[t(d,null,{default:e(()=>[t(v(ie))]),_:1})]),_:1}),t(_,{index:"/info"},{title:e(()=>[...s[5]||(s[5]=[y("Info",-1)])]),default:e(()=>[t(d,null,{default:e(()=>[t(v(ue))]),_:1})]),_:1}),t(_,{index:"/score"},{title:e(()=>[...s[6]||(s[6]=[y("Score",-1)])]),default:e(()=>[t(d,null,{default:e(()=>[t(v(ce))]),_:1})]),_:1})]),_:1}),t(_,{index:"/timetable"},{title:e(()=>[...s[7]||(s[7]=[y("è¯¾ç¨‹è¡¨",-1)])]),default:e(()=>[t(d,null,{default:e(()=>[t(v(_e))]),_:1})]),_:1}),t(_,{index:"/media"},{title:e(()=>[...s[8]||(s[8]=[y("åª’ä½“",-1)])]),default:e(()=>[t(d,null,{default:e(()=>[t(v(fe))]),_:1})]),_:1}),t(_,{index:"/tools"},{title:e(()=>[...s[9]||(s[9]=[y("å·¥å…·",-1)])]),default:e(()=>[t(d,null,{default:e(()=>[t(v(me))]),_:1})]),_:1})]),_:1},8,["default-active","collapse"])]),_:1})]),_:1})}}}),T=(p,c)=>{const r=p.__vccOpts||p;for(const[u,l]of c)r[u]=l;return r},Te=T(Oe,[["__scopeId","data-v-828d8ef1"]]),Ve={class:"flex flex-col gap-2 items-center"},Re={class:"flex items-center border-b-1 border-gray-200"},ke={class:"pl-4 text-base text-gray-500"},De=P({__name:"Login",emits:["login-success"],setup(p,{emit:c}){const r=c,u=O(),l=I(()=>u.userList),i=I(()=>u.loading),a=x({id:null,password:""}),f=async()=>{await u.refreshUserList(),l.value.length===0&&U.warning("ç”¨æˆ·åˆ—è¡¨ä¸ºç©ºï¼Œè¯·æ£€æŸ¥æ•°æ®åº“")},s=async()=>{if(!a.value.id)return;const n=l.value.find(o=>o.id===a.value.id);if(n)try{const o=await xe(n.name,a.value.password);if(o.code!==0){U.error(o.msg||"ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯");return}u.setCurUser({...n,icon:o.user.icon||n.icon}),r("login-success",{id:o.user.id,name:o.user.name,icon:o.user.icon||n.icon})}catch(o){U.error(o?.message||"ç™»å½•å¤±è´¥")}};return $(async()=>{await f()}),(n,o)=>{const d=B,_=ge,E=ye,h=he,m=j,g=ve;return L(),C(g,{class:"w-[480px]",shadow:"always"},{header:e(()=>[...o[2]||(o[2]=[y("ç”¨æˆ·ç™»å½•",-1)])]),default:e(()=>[S("div",Ve,[t(E,{modelValue:a.value.id,"onUpdate:modelValue":o[0]||(o[0]=w=>a.value.id=w),placeholder:"è¯·é€‰æ‹©ç”¨æˆ·",class:"!w-60",loading:i.value,"loading-text":"åŠ è½½ç”¨æˆ·åˆ—è¡¨ä¸­...",disabled:i.value},{default:e(()=>[(L(!0),W(Q,null,G(l.value,w=>(L(),C(_,{class:"!h-13",key:w.id,label:w.name,value:w.id},{default:e(()=>[S("div",Re,[t(d,{class:"!h-10 !w-10",src:w.icon},null,8,["src"]),S("div",ke,N(w.name),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","loading","disabled"]),t(h,{modelValue:a.value.password,"onUpdate:modelValue":o[1]||(o[1]=w=>a.value.password=w),style:{width:"240px"},type:"password",placeholder:"Password","show-password":""},null,8,["modelValue"]),t(m,{type:"primary",size:"large",class:"w-24 h-24 mt-4",disabled:!a.value.id,onClick:s},{default:e(()=>[...o[3]||(o[3]=[y(" Login ",-1)])]),_:1},8,["disabled"])])]),_:1})}}}),Me=T(De,[["__scopeId","data-v-860dbcd4"]]),$e={class:"flex items-center gap-2"},Ne={class:"flex items-center gap-2 text-sm"},Be=P({__name:"App",setup(p){const c=O(),r=x(null),u=async()=>{const s=await Ce(),n=D();if(s&&n!==!0){Ie();const o=D();r.value=o,console.log(o===!0?`[Server Switch] âœ… åˆ‡æ¢åˆ°æœ¬åœ°æœåŠ¡å™¨: ${R}:${k}`:"[Server Switch] âš ï¸ æ£€æµ‹åˆ°æœ¬åœ°æœåŠ¡å™¨å¯ç”¨ï¼Œä½†å› åè®®ä¸åŒ¹é…æ— æ³•åˆ‡æ¢")}else!s&&n!==!1?(Ue(),r.value=!1,console.log("[Server Switch] ðŸ”„ åˆ‡æ¢åˆ°è¿œç¨‹æœåŠ¡å™¨")):r.value=n},l=I(()=>r.value===!0?`æœ¬åœ° (${R}:${k})`:r.value===!1?"è¿œç¨‹":"æ£€æµ‹ä¸­..."),i=I(()=>r.value===!0?"success":r.value===!1?"warning":"info"),a=s=>{const n=c.getUserById(s.id);n?c.setCurUser(n):(console.warn("ç”¨æˆ·ä¿¡æ¯æœªæ‰¾åˆ°ï¼Œä½¿ç”¨ä¼ å…¥çš„ä¿¡æ¯"),c.setCurUser({id:s.id,name:s.name,icon:s.icon}))};let f=null;return $(async()=>{await c.refreshUserList(),await c.restoreCurUser(),await u(),f=setInterval(async()=>{await u()},5e3),console.log("[Server Monitor] æœåŠ¡å™¨ç›‘æŽ§å·²å¯åŠ¨ï¼Œæ¯ 5 ç§’æ£€æµ‹ä¸€æ¬¡")}),Y(()=>{f&&(clearInterval(f),console.log("[Server Monitor] æœåŠ¡å™¨ç›‘æŽ§å·²åœæ­¢"))}),(s,n)=>{const o=q,d=be,_=Ee,E=Z("router-view"),h=Le,m=we;return L(),C(m,{loading:v(c).loading,class:"h-screen"},{default:e(()=>[t(Te),v(c).curUser.bLogin?(L(),C(m,{key:0},{default:e(()=>[t(_,{class:"flex justify-between items-center bg-blue-50 px-6"},{default:e(()=>[S("div",$e,[t(o,null,{default:e(()=>[t(v(V))]),_:1}),n[0]||(n[0]=y(" å“ˆå“ˆå“ˆ ",-1)),t(o,null,{default:e(()=>[t(v(V))]),_:1})]),S("div",Ne,[n[1]||(n[1]=S("span",{class:"text-gray-500"},"æœåŠ¡å™¨:",-1)),t(d,{type:i.value,size:"small"},{default:e(()=>[y(N(l.value),1)]),_:1},8,["type"])])]),_:1}),t(h,null,{default:e(()=>[t(E)]),_:1})]),_:1})):(L(),C(m,{key:1},{default:e(()=>[t(h,{class:"bg-blue-100 !flex justify-center items-center"},{default:e(()=>[t(Me,{onLoginSuccess:a})]),_:1})]),_:1}))]),_:1},8,["loading"])}}}),je=T(Be,[["__scopeId","data-v-fd67697e"]]),qe="modulepreload",Fe=function(p){return"/"+p},M={},b=function(c,r,u){let l=Promise.resolve();if(r&&r.length>0){let s=function(n){return Promise.all(n.map(o=>Promise.resolve(o).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),f=a?.nonce||a?.getAttribute("nonce");l=s(r.map(n=>{if(n=Fe(n),n in M)return;M[n]=!0;const o=n.endsWith(".css"),d=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${d}`))return;const _=document.createElement("link");if(_.rel=o?"stylesheet":qe,o||(_.as="script"),_.crossOrigin="",_.href=n,f&&_.setAttribute("nonce",f),document.head.appendChild(_),o)return new Promise((E,h)=>{_.addEventListener("load",E),_.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${n}`)))})}))}function i(a){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=a,window.dispatchEvent(f),!f.defaultPrevented)throw a}return l.then(a=>{for(const f of a||[])f.status==="rejected"&&i(f.reason);return c().catch(i)})},He=[{path:"/",redirect:"/home"},{path:"/home",name:"Home",component:()=>b(()=>import("./Home-B-VovtB0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))},{path:"/lottery",name:"Lottery",component:()=>b(()=>import("./Lottery-D-3PLRp8.js"),__vite__mapDeps([9,3,4,5,2,6,1]))},{path:"/info",name:"Info",component:()=>b(()=>import("./Info-iAd9USUO.js"),__vite__mapDeps([10,1,2,3,4,5,6]))},{path:"/chat",name:"Chat",component:()=>b(()=>import("./Chat-4osknQsX.js"),__vite__mapDeps([11,4,3,5,2,6,12,1,7,8,13]))},{path:"/score",name:"Score",component:()=>b(()=>import("./Score-DxlOjK5e.js"),__vite__mapDeps([14,3,4,5,2,6,1,7,8]))},{path:"/timetable",name:"Timetable",component:()=>b(()=>import("./Timetable-nfBqpDzq.js"),__vite__mapDeps([15,4,3,5,2,6,1]))},{path:"/media",name:"Media",component:()=>b(()=>import("./index-LC-JGRBT.js"),__vite__mapDeps([16,4,1,2,3,5,6,17,18,7,8]))},{path:"/tools",name:"Tools",component:()=>b(()=>import("./index-faJWwnOa.js"),__vite__mapDeps([19,4,3,5,2,6,1,17,18,7,8]))}],ze=J({history:X(),routes:He}),A=ee(je),Ke=te();A.use(Ke);A.use(ze);A.use(Ae);A.mount("#app");export{T as _,O as u};
