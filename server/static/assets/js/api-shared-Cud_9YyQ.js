import{a as c}from"./utils-C3h80Bc3.js";import{U as p}from"./types-shared-D7b4dn-C.js";import{l as i,a as r}from"./utils-shared-CndaLcYB.js";const u={url:"https://leo-zhao.natapp4.cc/"},d=u.url,f=d.endsWith("/api")?d:d.endsWith("/")?`${d}api`:`${d}/api`;function y(){return d}const s=c.create({baseURL:f,timeout:3e4});s.interceptors.request.use(t=>(i.debug("API Request:",t.method?.toUpperCase(),t.url,t.params||t.data),t),t=>(i.error("API Request Error:",t),Promise.reject(t)));s.interceptors.response.use(t=>{if(t.data&&typeof t.data=="object"&&"code"in t.data&&t.data.code!==0){const a=new Error(t.data.msg||"请求失败");return a.response=t,Promise.reject(a)}return t},t=>{if(t.response){const a=t.response.status,n=t.response.data?.msg||`请求失败 (${a})`;a>=500?r(t,"服务器错误",{context:"API"}):a===404?r(t,"资源未找到",{context:"API"}):a===403?r(t,"无权限访问",{context:"API"}):a===401?r(t,"未授权，请重新登录",{context:"API"}):r(t,n,{context:"API"})}else t.request?r(t,"网络错误，请检查网络连接",{context:"API"}):r(t,"请求配置错误",{context:"API"});return Promise.reject(t)});async function k(t,a,e,n){const o={table:t};return a&&(o.conditions=JSON.stringify(a)),e&&(o.pageNum=e),n&&(o.pageSize=n),(await s.get("/getAll",{params:o})).data}async function R(t,a,e){const n={table:t,id:a};return(await s.get("/getData",{params:n})).data.data}async function h(t,a){return a.id===-1&&(a.id=null),(await s.post("/setData",{table:t,data:a})).data.data}async function D(t,a){return(await s.post("/delData",{table:t,id:a})).data.data}async function U(t){if(t===void 0)throw new Error("id is undefined");const a=await s.get("/getData",{params:{id:t,table:"t_schedule",fields:"data,user_id"}});if(a.data.code!==0)throw new Error(a.data.msg);const e=p.parseUserData(a.data.data.data);return e.userId=a.data.data.user_id,e}async function P(t,a){const e=await s.post("/setData",{table:"t_user",data:{id:t,score:a}});if(console.log("setUserInfo",e.data),e.data.code!==0)throw new Error(e.data.msg);return e.data.data}async function _(t){const a=await s.get("/getData",{params:{table:"t_user",id:t,fields:"id,score"}});if(a.data.code!==0)throw new Error(a.data.msg);return a.data.data}async function A(t,a,e,n){const o=await s.post("/addScore",{user:t,action:a,value:e,msg:n});if(console.log("addScore",o.data),o.data.code!==0)throw new Error(o.data.msg);return o.data.data}async function E(t,a,e){const n=await s.get("/getRdsList",{params:{key:t,pageSize:e,startId:a}});if(n.data.code!==0)throw new Error(n.data.msg);return n.data.data}async function I(t,a){const e=await s.get("/getRdsData",{params:{table:t,id:a}});if(e.data.code!==0)throw new Error(e.data.msg);return e.data.data}async function T(t,a,e){const n=await s.post("/setRdsData",{table:t,data:{id:a,value:e}});if(console.log("setRdsData",n.data),n.data.code!==0)throw new Error(n.data.msg);return n.data.data}async function b(t,a,e){let n;const o="bluetooth";return a==="GET"?n=await s.get(`/${o}/${t}`,{params:e}):n=await s.post(`/${o}/${t}`,e),n.data}async function $(t,a,e={}){let n;return a==="GET"?n=await s.get(`/playlist/${t}`,{params:e}):n=await s.post(`/playlist/${t}`,e),n.data}async function L(){return(await s.get("/pdf/list")).data}async function x(t){const a=new FormData;return a.append("file",t),(await s.post("/pdf/upload",a,{headers:{"Content-Type":"multipart/form-data"}})).data}async function M(t,a){const e={task_id:t};return a!=null&&a!==""&&(e.password=a),(await s.post("/pdf/decrypt",e)).data}async function F(t){return(await s.get(`/pdf/task/${encodeURIComponent(t)}`)).data}function S(t,a){return`${s.defaults.baseURL||""}/pdf/download/${encodeURIComponent(t)}?type=${a}`}async function v(t){return(await s.post("/pdf/delete",{task_id:t})).data}async function j(){return(await s.get("/media/task/list")).data}async function q(){return(await s.post("/media/task/create",{})).data}async function C(t){return(await s.post("/media/task/get",{task_id:t})).data}async function B(t){return(await s.post("/media/task/delete",{task_id:t})).data}async function z(t,a){return(await s.post("/media/task/addFileByPath",{task_id:t,file_path:a})).data}async function G(t,a){return(await s.post("/media/task/deleteFile",{task_id:t,file_index:a})).data}async function N(t){return(await s.post("/media/task/start",{task_id:t})).data}async function O(t,a){return(await s.post("/media/task/reorderFiles",{task_id:t,file_indices:a})).data}function W(t){return`${s.defaults.baseURL||""}/media/task/download?task_id=${t}`}async function J(t,a){return(await s.post("/media/task/save",{task_id:t,target_path:a})).data}export{J as A,O as B,B as C,G as D,W as E,s as a,k as b,A as c,I as d,D as e,R as f,_ as g,h,T as i,U as j,E as k,y as l,b as m,L as n,M as o,$ as p,S as q,v as r,P as s,F as t,x as u,z as v,j as w,q as x,C as y,N as z};
